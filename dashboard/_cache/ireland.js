
var _cache_login = "admin";

var _cache_repository = {"Repository":[{"columns":["Country","BuildVersion","RepoVersionId","DataSource"],"data":[["IRELAND","2.0.6113.26020","21","cbsw2358\\cbdsd19"]]}],"Translation":[{"columns":["ID","Culture"],"data":[[2,"en-IE"],[1,"fr-FR"]]},{"columns":["NAME","CultureId","VALUE"],"data":[["_BI_SYNCHRO_DURATION_SERVER",2,"Server process duration"],["_BI_USER_PASSWORD",2,"Password"],["_BI_USER_PASSWORD_CHANGE",1,"Modifier le mot de passe"],["_BI_USER_PASSWORD_CHANGE",2,"Change password"],["_BI_USER_PASSWORD_CHANGE_SUCCESS",1,"Votre mot de passe a bien été modifié."],["_BI_USER_PASSWORD_CHANGE_SUCCESS",2,"Your password has been successfully changed."],["_BI_USER_PASSWORD_NEW",1,"Nouveau mot de passe"],["_BI_USER_PASSWORD_NEW",2,"New password"],["_BI_USER_PASSWORD_NEW_CONFIRM",1,"Confirmer le mot de passe"],["_BI_USER_PASSWORD_NEW_CONFIRM",2,"Confirm password"],["_BI_USER_PASSWORD_NEW_CONFIRM_NOT_MATCH",1,"Le nouveau mot de passe n'est pas confirmé"],["_BI_USER_PASSWORD_NEW_CONFIRM_NOT_MATCH",2,"New password confirmation not matching"],["_BI_USER_PASSWORD_NEW_MISSING",1,"Renseigner le nouveau mot de passe"],["_BI_USER_PASSWORD_NEW_MISSING",2,"New password is missing"],["_BI_USER_PASSWORD_OLD",1,"Ancien mot de passe"],["_BI_USER_PASSWORD_OLD",2,"Old password"],["_BI_APPLICATION_NAME",1,"BI SELL"],["_BI_APPLICATION_NAME",2,"BI SELL"],["_BI_FILTER_BOOKMARK_ERROR",1,"Une erreur est survenue !"],["_BI_FILTER_BOOKMARK_ERROR",2,"An error occured!"],["_BI_FILTER_BOOKMARK_FORM",1,"Ajouter un signet :"],["_BI_FILTER_BOOKMARK_FORM",2,"Add bookmark:"],["_BI_FILTER_BOOKMARK_LIST",1,"Vos signets :"],["_BI_FILTER_BOOKMARK_LIST",2,"Your bookmarks:"],["_BI_FILTER_BOOKMARK_NEW_FILTERS",1,"Filtres disponibles :"],["_BI_FILTER_BOOKMARK_NEW_FILTERS",2,"Available filters:"],["_BI_FILTER_BOOKMARK_NEW_FILTERS_MISSING",1,"Sélectionner au moins un filtre"],["_BI_FILTER_BOOKMARK_NEW_FILTERS_MISSING",2,"Select at least one filter"],["_BI_FILTER_BOOKMARK_NEW_NAME",1,"Nom"],["_BI_FILTER_BOOKMARK_NEW_NAME",2,"Name"],["_BI_FILTER_BOOKMARK_NEW_NAME_MISSING",1,"Donner un nom au signet"],["_BI_FILTER_BOOKMARK_NEW_NAME_MISSING",2,"Bookmark name is missing"],["_BI_FILTER_BOOKMARK_NEW_SUBMIT",1,"Sauvegarder"],["_BI_FILTER_BOOKMARK_NEW_SUBMIT",2,"Save"],["_BI_FILTER_BOOKMARK_NO_FILTER",1,"Aucun filtre disponible pour ce Dashboard"],["_BI_FILTER_BOOKMARK_NO_FILTER",2,"No filter available for this Dashboard"],["_BI_FILTER_BOOKMARK_TITLE",1,"Signets de filtres"],["_BI_FILTER_BOOKMARK_TITLE",2,"Filters bookmarks"],["_BI_FILTERS_SUBMIT",1,"Appliquer les filtres"],["_BI_FILTERS_SUBMIT",2,"Apply filters"],["_BI_INTERNET_CONNECTION_LOST",1,"Connexion internet perdue"],["_BI_INTERNET_CONNECTION_LOST",2,"Internet connection lost"],["_BI_INTERNET_CONNECTION_UNAVAILABLE",1,"Connexion internet non disponible"],["_BI_INTERNET_CONNECTION_UNAVAILABLE",2,"Internet connection unavailable"],["_BI_LANGUAGE",1,"Langue"],["_BI_LANGUAGE",2,"Language"],["_BI_MODE",1,"Mode"],["_BI_MODE",2,"Mode"],["_BI_MODE_GO_OFFLINE",1,"Voir hors ligne"],["_BI_MODE_GO_OFFLINE",2,"Go offline"],["_BI_MODE_GO_OFFLINE_ERROR",1,"Vous devez synchroniser les données avant de passer hors ligne."],["_BI_MODE_GO_OFFLINE_ERROR",2,"You must synchronize before switching to offline mode."],["_BI_MODE_GO_ONLINE",1,"Voir en ligne"],["_BI_MODE_GO_ONLINE",2,"Go online"],["_BI_MODE_GO_ONLINE_ERROR",1,"Pas de connexion internet disponible pour passer en ligne."],["_BI_MODE_GO_ONLINE_ERROR",2,"No internet connection is available to switch online."],["_BI_MODE_OFFLINE",1,"Hors ligne"],["_BI_MODE_OFFLINE",2,"Offline"],["_BI_MODE_ONLINE",1,"En ligne"],["_BI_MODE_ONLINE",2,"Online"],["_BI_NO_DATA",1,"Aucune données"],["_BI_NO_DATA",2,"No data"],["_BI_REDIRECTION_IN",1,"Redirection dans"],["_BI_REDIRECTION_IN",2,"Redirection in"],["_BI_RESTORE_DEFAULT_VALUES",1,"Restaurer les valeurs par défaut"],["_BI_RESTORE_DEFAULT_VALUES",2,"Restore default values"],["_BI_SERVER_LOCAL",1,"client local"],["_BI_SERVER_LOCAL",2,"local client"],["_BI_SERVER_REMOTE",1,"serveur distant"],["_BI_SERVER_REMOTE",2,"remote server"],["_BI_SIGN_IN",1,"Se connecter"],["_BI_SIGN_IN",2,"Sign in"],["_BI_SIGN_OUT",1,"Se déconnecter"],["_BI_SIGN_OUT",2,"Sign out"],["_BI_SIGNED_OUT",1,"Déconnecté"],["_BI_SIGNED_OUT",2,"Signed out"],["_BI_SIGNED_OUT_FROM",1,"Vous êtes déconnecté du"],["_BI_SIGNED_OUT_FROM",2,"You are now signed out from the"],["_BI_SYNCHRO",1,"Synchronisation"],["_BI_SYNCHRO",2,"Synchronization"],["_BI_SYNCHRO_CANCEL",1,"Annuler la synchronisation"],["_BI_SYNCHRO_CANCEL",2,"Cancel synchronization"],["_BI_SYNCHRO_CLEANING_DATA",1,"Consolidation des données"],["_BI_SYNCHRO_CLEANING_DATA",2,"Cleaning data"],["_BI_SYNCHRO_CREATING_TEMPORARY_TABLES",1,"Création des tables temporaires"],["_BI_SYNCHRO_CREATING_TEMPORARY_TABLES",2,"Creating temporary tables"],["_BI_SYNCHRO_DURATION_CLIENT",1,"Durée du processus client"],["_BI_SYNCHRO_DURATION_CLIENT",2,"Client process duration"],["_BI_SYNCHRO_DURATION_SERVER",1,"Durée du processus serveur"],["_BI_SYNCHRO_GETTING_REMOTE_DATA",1,"Récupération des données depuis le serveur"],["_BI_SYNCHRO_GETTING_REMOTE_DATA",2,"Getting data from remote server"],["_BI_SYNCHRO_LAST_DATE",1,"Date de dernière synchronisation :"],["_BI_SYNCHRO_LAST_DATE",2,"Last synchronization date:"],["_BI_SYNCHRO_LAUNCH",1,"Démarrer la synchronisation"],["_BI_SYNCHRO_LAUNCH",2,"Launch synchronization"],["_BI_SYNCHRO_NEVER",1,"Jamais synchronisé"],["_BI_SYNCHRO_NEVER",2,"Never synchronized"],["_BI_SYNCHRO_REPLACING_TABLES",1,"Remplacement des tables existantes"],["_BI_SYNCHRO_REPLACING_TABLES",2,"Replacing previous tables"],["_BI_SYNCHRO_RETRY",1,"Recommencer"],["_BI_SYNCHRO_RETRY",2,"Retry"],["_BI_SYNCHRO_SUCCESS",1,"La synchronisation a réussi. Vos données sont à jour !"],["_BI_SYNCHRO_SUCCESS",2,"The synchronization was successful. Your data is up to date!"],["_BI_SYNCHRO_VIEW_SYNCHRONIZED_DATA",1,"Voir les données synchronisées"],["_BI_SYNCHRO_VIEW_SYNCHRONIZED_DATA",2,"View synchronized data"],["_BI_TOGGLE_SIDEBAR_BEHAVIOR",1,"Modifier le comportement du volet latéral"],["_BI_TOGGLE_SIDEBAR_BEHAVIOR",2,"Change the sidebar behavior"],["_BI_USER_INVALID_CREDENTIALS",1,"Les identifiants sont invalides"],["_BI_USER_INVALID_CREDENTIALS",2,"Invalid credentials"],["_BI_USER_LOGIN",1,"Identifiant"],["_BI_USER_LOGIN",2,"Login"],["_BI_USER_PASSWORD",1,"Mot de passe"]]}],"User":[{"columns":["ConfigValue"],"data":[["1"]]},{"columns":["EnableAutoLogin"],"data":[["0"]]}],"Context":[{"columns":["ID","NAME","DefaultDashboardId"],"data":[[1,"GROUPREP",1]]},{"columns":["PARAM","VALUE"],"data":[["Dashboard.SidebarMenu","0"],["Dashboard.SidebarOverlay","1"],["Menu.BookmarkFormButton","1"],["Menu.DatabaseModeSwitch","1"],["Menu.LinkToLogoutPage","1"],["Menu.SubmitFiltersButton","1"]]},{"columns":["ID","NAME","QUERY","DbName"],"data":[[1,"MAX_SALES_DATE_ID","select value from BIInfo where info ='Max sales date'","olapIreland"],[3,"MONTH_LAST_SALES_MONTH","select  value DateMonthName  from BIInfo where info='MONTH LAST SALES MONTH'\r\n\r\n\r\n","olapIreland"],[2,"YEAR_LAST_SALES_MONTH","select value DateYear  from BIINfo where info='YEAR LAST SALES MONTH'\r\n\r\n\r\n\r\n","olapIreland"]]},{"columns":["TableName","QUERY"],"data":[["DimBrick","inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin=':USER'"],["DimCustomer","inner join VisCustomer on VisCustomer.CustomerId=DimCustomer.CustomerId and VisCustomer .UserLogin=':USER'"],["DimNational","inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin=':USER'"],["DimProduct","inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin=':USER'"],["DimRegion","inner join VisRegion on VisRegion.RegionId=DimRegion.RegionId and VisRegion.UserLogin=':USER'"],["DimTerritory","inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin=':USER'"],["FactSalesNational","inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin=':USER'"],["FactSalesRegion","inner join VisRegion on VisRegion.RegionId=FactSalesRegion.RegionId and VisRegion.UserLogin=':USER'"],["FactEvents","inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin=':USER'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin=':USER'\r\n\r\n\r\n"],["FactPOA","inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin=':USER'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin=':USER'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin=':USER'\r\n\r\n"],["FactQuotasTerritory","inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin=':USER'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin=':USER'\r\n"],["FactSalesBrick","inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin=':USER'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin=':USER'\r\n "],["FactSalesTerritory","inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin=':USER'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin=':USER'\r\n\r\n"],["VW_FactSalesTerritory","inner join DimTerritory as T on T.TerritoryId=VW_FactSalesTerritory.TerritoryId\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin=':USER'\r\n"]]}],"Dashboard":[{"columns":["ParentMenuId","MenuId","MenuOrder","DashboardId","isAvailableOffline","MenuCaptionKey","ImagePath"],"data":[[null,1,1,1,1,"","home"],[4,5,1,8,0,"Sales",null],[4,6,2,9,0,"Activity",null],[null,2,2,2,1,"Territory sales",null],[null,3,3,3,1,"Mini-Brick sales",null],[null,4,4,null,0,"Demo CRM2",null]]},{"columns":["ID","TITLE","ImmediateExecution"],"data":[[5,"A Doctors in mini-brick",null],[6,"A Doctors in territory",null],[4,"A Doctors seen/unseen in mini-brick",null],[7,"A Doctors seen/unseen in territory",null],[10,"Demo Bubbles",null],[9,"Demo CRM Activity",1],[8,"Demo CRM Sales",null],[11,"Demo Formatting",null],[1,"Home Page",null],[3,"Mini-Brick Sales",null],[2,"Territory Sales",null]]},{"columns":["ID","DashboardId","TITLE"],"data":[[1,1,"Sales x Activities"],[12,1,"Turnover Breakdown"],[3,2,"Servier Product sales"],[2,2,"Servier Products MS"],[4,2,"Competitors sales"],[5,2,"Competitors MS"],[7,3,"Servier Product sales"],[8,3,"Competitors products sales"],[6,3,"Mini-Brick Comparison"],[9,4," "],[11,5,"  "],[13,6," "],[14,7," "],[15,8," "],[16,9," "],[19,10,"StackChart"],[17,10,"Bubbles"],[18,10,"Format Number"],[20,11,"Page1"]]},{"columns":["ID","PageId","HEIGHT","WIDTH","CHILDSTART","CHILDEND","NEWROW"],"data":[[20,1,100,100,0,0,0],[24,1,10,100,1,0,0],[1,1,100,40,1,0,0],[63,1,100,60,0,1,0],[25,1,100,65,1,0,0],[64,1,100,35,0,1,0],[22,1,90,100,0,1,1],[26,1,60,100,1,0,0],[21,1,80,100,1,0,0],[27,1,20,100,0,1,1],[23,1,40,100,0,1,1],[54,2,100,100,0,0,0],[4,2,10,100,1,0,0],[55,2,90,100,0,1,1],[52,3,100,100,0,0,0],[16,3,10,100,1,0,0],[53,3,90,100,0,1,1],[56,4,100,100,0,0,0],[10,4,10,100,1,0,0],[57,4,90,100,0,1,1],[58,5,100,100,0,0,0],[11,5,10,100,1,0,0],[59,5,90,100,0,1,1],[50,6,100,100,0,0,0],[18,6,10,100,1,0,0],[51,6,90,100,0,1,1],[46,7,100,100,0,0,0],[13,7,10,100,1,0,0],[47,7,90,100,0,1,1],[48,8,100,100,0,0,0],[14,8,10,100,1,0,0],[49,8,90,100,0,1,1],[30,9,100,100,0,0,0],[28,9,50,100,1,0,0],[31,9,50,100,0,1,1],[32,11,100,100,0,0,0],[34,12,100,100,0,0,0],[36,12,100,50,1,0,0],[33,12,50,100,1,0,0],[37,12,50,100,0,1,1],[38,12,100,50,0,1,0],[40,12,65,100,1,0,0],[35,12,25,100,1,0,0],[41,12,75,100,0,1,1],[39,12,35,100,0,1,1],[42,13,100,100,0,0,0],[44,14,100,100,0,0,0],[43,14,50,100,1,0,0],[45,14,50,100,0,1,1],[66,15,100,100,0,0,0],[65,15,25,100,1,0,0],[67,15,75,100,0,1,1],[70,16,100,100,0,0,0],[71,17,100,100,0,0,0],[72,18,100,100,0,0,0],[73,19,100,100,0,0,0],[74,20,100,100,0,0,0]]}],"Filter":[{"columns":["ID","CAPTION","TYPE","Query","IsAll","IsHidden","DEFVALTYPE","DEFVAL","DbName"],"data":[[16,"Product","Single","select \r\n\tP.ProductId as value,\r\n\tP.ProductName as caption\t\r\nFROM DimProduct P\r\nwhere \r\n\tP.HomeProductFlag=1 \r\n\tAND P.VisHomeProductFlag=0\r\nOrder by case P.ProductName when 'PROCORALAN' then 'AAAAAA' else P.ProductName end",0,0,"First",null,"olapIreland"],[5,"Indicateur","Single","select  1 as value,'US' as caption \r\nUNION\r\nselect  2 as value,'MS' as caption ",0,0,"First",null,"olapIreland"],[14,"Mini-Brick Initial","Single","select B.BrickId as value,B.BrickName as caption FROM DimBrick as B Order by B.BrickName",0,0,"First",null,"olapIreland"],[13,"Region","Single","SELECT  [RegionId] as value\r\n      ,[RegionName] as caption\r\n        FROM  DimRegion",0,0,"First",null,"olapIreland"],[11,"Sales/Target Label","Edition",null,0,1,"QueryValue","SELECT \r\nCASE WHEN #7.Caption# ='Srv. QTR' \r\nTHEN  ' - Sales/Target (%): '\r\n ELSE ' '\r\nEND\r\n as value","olapIreland"],[3,"Territory","Single","select T.TerritoryId as value,T.TerritoryName as caption FROM DimTerritory as T Order by T.TerritoryName",0,0,"First",null,"olapIreland"],[1,"Mini-Brick","Multi","SELECT\r\n BrickId AS value\r\n,BrickName AS caption\r\nFROM\r\n(SELECT\r\n B.BrickId\r\n,B.BrickName\r\n,FSB.MATMarketSalesUnitLastMonth\r\nFROM\r\n           DimBrick       B\r\nINNER JOIN FactSalesBrick FSB ON B.BrickId=FSB.BrickId\r\n--INNER JOIN DimDate        D   ON D.DateId =FSB.DateId\r\nWHERE\r\n   -- D.MATStartDateId=(SELECT MAX(MATStartDateId) FROM DimDate)\r\n FSB.ProductId=#2.Value#\r\n) T\r\nORDER BY\r\nMATMarketSalesUnitLastMonth DESC",0,0,"First","\r\n","olapIreland"],[7,"Period","Single","select value,Caption\r\nfrom\r\n(select  'QTR' as value,'Srv. QTR' as caption,'1' as tri  \r\nUNION\r\nselect 'MQT' as value,'MQT' as caption, '2' as tri  \r\nUNION\r\nselect  'YTD' as value,'YTD' as caption,'3' as tri  \r\nUNION\r\nselect  'MAT' as value,'MAT' as caption, '4' as tri \r\nUNION\r\nselect  '' as value,'Month' as caption, '5' as tri  \r\n) t\r\norder by tri\r\n",0,0,"First",null,"olapIreland"],[15,"PeriodMessage","Edition",null,0,1,"QueryValue","SELECT \r\nCASE WHEN #7.Caption# ='MQT' \r\nTHEN  'Growth vs 3 previous month'\r\n ELSE \r\nCASE WHEN #7.Caption# ='Month' \r\nTHEN  'Growth vs previous month'\r\nELSE 'Growth vs previous year'\r\nEND END\r\n as value\r\n","olapIreland"],[2,"Product","Single"," select P.ProductId as value,P.ProductName as caption FROM DimProduct P\r\nwhere P.HomeProductFlag=1 AND P.VisHomeProductFlag=0\r\nOrder by P.ProductName",0,0,"First",null,"olapIreland"],[10,"Sales/Target","Edition",null,0,1,"QueryValue","SELECT \r\nCASE WHEN #7.Caption# ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM DimProduct P \r\nINNER JOIN FactQuotasTerritory FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId ={MAX_SALES_DATE_ID}\r\nINNER JOIN DimTerritory T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId=#2.Value#","olapIreland"]]},{"columns":["ID","MASTERID","SLAVEID"],"data":[[1,2,10],[2,7,10],[3,2,11],[4,7,11],[5,2,1],[6,7,15]]},{"columns":["ID","LayoutType","LayoutId","FilterId","IsDeferred","DisplayType","IsHidden","FilterVariable","CAPTION_OVERRIDE"],"data":[[10,"Container",1,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[28,"Container",4,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[29,"Container",10,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[30,"Container",11,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[4,"Container",13,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[26,"Container",14,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[1,"Container",16,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[27,"Container",18,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[11,"Container",25,7,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[32,"Container",65,16,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,"\"Product\""],[16,"Dashboard",1,10,0,"Input",0,null,null],[17,"Dashboard",1,11,0,"Input",0,null,null],[18,"Dashboard",1,13,0,"Select",1,null,null],[19,"Dashboard",1,3,0,"Select",1,null,null],[31,"Dashboard",1,15,0,"Input",0,null,null],[9,"Dashboard",3,1,1,"ButtonGroup; type=checkbox; vertical=1; uncheckRadio=0;",0,null,null],[14,"Dashboard",4,2,0,"Select",0,null,null],[12,"Dashboard",4,7,0,"Select",0,null,null],[20,"Dashboard",4,14,0,"Select",0,null,"\"Mini-Brick\""],[22,"Dashboard",5,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[21,"Dashboard",5,14,0,"Select",0,null,"\"Mini-Brick\""],[23,"Dashboard",6,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[24,"Dashboard",7,2,0,"ButtonGroup; mode=radio; orientation=horizontal",0,null,null],[25,"Dashboard",7,7,0,"Select",0,null,null]]},{"columns":["ID","MASTERID","SLAVEID","BypassPreviousSelection"],"data":[[1,10,16,1],[2,11,16,1],[3,10,17,1],[4,11,17,1],[5,4,9,0],[6,11,31,1]]},{"columns":["ID","FilterGroupId","FILTERID"],"data":[[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[2,1,26],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1],[1,1,27],[2,1,26],[3,1,4],[4,2,30],[5,2,29],[6,2,28],[7,2,1]]},{"columns":["ID","GroupId","FILTERID","isHidden"],"data":[]}],"Analysis":[{"columns":["ID","TITLE","PATH"],"data":[[1,"Test","/IRELAND/DEFAULT/"],[29,"Bubbles1","/IRELAND/Demo Bubbles/"],[31,"Test spark bar","/IRELAND/Demo Bubbles/"],[30,"ThousandSeparator","/IRELAND/Demo Bubbles/"],[28,"CoverageBySegmentation","/IRELAND/Demo CRM/"],[32,"DemoFormatting_1","/IRELAND/Demo CRM/"],[27,"TerrCompSales","/IRELAND/Demo CRM/"],[10,"Activity","/IRELAND/IMS SALES/"],[25,"Activity_1","/IRELAND/IMS SALES/"],[4,"BrickCompSales","/IRELAND/IMS SALES/"],[18,"BrickCompSales_1","/IRELAND/IMS SALES/"],[9,"BrickMultiGraph","/IRELAND/IMS SALES/"],[23,"BrickMultiGraph_1","/IRELAND/IMS SALES/"],[2,"BrickServierSales","/IRELAND/IMS SALES/"],[17,"BrickServierSales_1","/IRELAND/IMS SALES/"],[13,"NationalTOYTD","/IRELAND/IMS SALES/"],[21,"NationalTOYTD_1","/IRELAND/IMS SALES/"],[16,"RegionTOYTD","/IRELAND/IMS SALES/"],[19,"RegionTOYTD_1","/IRELAND/IMS SALES/"],[7,"TerrCompSales","/IRELAND/IMS SALES/"],[26,"TerrCompSales_1","/IRELAND/IMS SALES/"],[15,"TerritoryTOYTD","/IRELAND/IMS SALES/"],[20,"TerritoryTOYTD_1","/IRELAND/IMS SALES/"],[5,"TerrServierSales","/IRELAND/IMS SALES/"],[22,"TerrServierSales_1","/IRELAND/IMS SALES/"],[12,"ActivityTotal","/IRELAND/Sales and Activity/"],[24,"ActivityTotal_1","/IRELAND/Sales and Activity/"]]},{"columns":["ID","AnalysisId","NAME","DbName"],"data":[[1,1,"Default","olapIreland"],[2,2,"DSIMSSALES","olapIreland"],[4,4,"DSIMSSALES","olapIreland"],[5,5,"DSIMSSALES","olapIreland"],[7,7,"DSIMSSALES","olapIreland"],[9,9,"DSIMSSALES","olapIreland"],[14,10,"DSCustomerNotSeen","olapIreland"],[12,10,"DSCustomerSeen","olapIreland"],[13,10,"DSCustomerTotal","olapIreland"],[10,10,"DSIMSSALES","olapIreland"],[11,12,"DSIMSSALES","olapIreland"],[15,13,"DSIMSSALES","olapIreland"],[17,15,"DSIMSSALES","olapIreland"],[18,16,"DSIMSSALES","olapIreland"],[19,17,"DSIMSSALES","olapIreland"],[20,18,"DSIMSSALES","olapIreland"],[21,19,"DSIMSSALES","olapIreland"],[22,20,"DSIMSSALES","olapIreland"],[23,21,"DSIMSSALES","olapIreland"],[24,22,"DSIMSSALES","olapIreland"],[25,23,"DSIMSSALES","olapIreland"],[26,24,"DSIMSSALES","olapIreland"],[27,25,"DSCustomerNotSeen","olapIreland"],[28,25,"DSCustomerSeen","olapIreland"],[29,25,"DSCustomerTotal","olapIreland"],[30,25,"DSIMSSALES","olapIreland"],[31,26,"DSIMSSALES","olapIreland"],[32,27,"DSIMSSALES","olapIreland"],[33,28,"Default","olapIreland"],[34,29,"Default","olapIreland"],[35,30,"Default","olap"],[36,31,"Default","olapIreland"],[37,32,"Default","olapIreland"]]},{"columns":["ID","DatasetId","Query"],"data":[[23,22,"SELECT FsT.YTDSalesTO,P.ProductName\r\nFROM VW_FactSalesTerritory FsT\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsT.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 and Fst.dateid={MAX_SALES_DATE_ID} \r\nOrder by P.ProductNAme"],[8,7,"SELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId #72# then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM FactSalesTerritory Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 #24#\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId #72# then 'AAAAA' ELSE P.ProductName end "],[24,23,"SELECT DISTINCT FsN.YTDSalesTO,P.ProductNAme\r\nFROM FactSalesNationalBis FsN\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsN.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 and FsN.dateId={MAX_SALES_DATE_ID}\r\nOrder by P.ProductNAme"],[25,24,"SELECT  \r\nD.MonthChar\r\n,D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] \r\n      ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n\r\n      \r\n  FROM FactSalesTerritory Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId\r\n  INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1   #49# #48#\r\n Group by \r\n\t   D.DATEID\r\n\t , D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n     ,Fs.MarketSalesUnit\r\n    ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n\r\n  "],[26,25,"SELECT  \r\n       Fs.[BrickId]\r\n      ,B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] \r\n      ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      ,FS.dateId\r\n      ,Fs.MATMarketSalesUnit\r\n  FROM FactSalesBrick Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\n  INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n  INNER JOIN DimBrick B on B.brickId=Fs.brickId\r\n\r\n  WHERE 1=1  #50# AND D.dateId IN\r\n  (\r\n  SELECT  max(FSB.dateId) \r\n  FROM \r\n  FactSalesBrick FSB\r\n  )\r\n  Group by  Fs.[BrickId],B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.MarketSalesUnit\r\n      ,Fs.DateId\r\n      ,Fs.MATMarketSalesUnit\r\nORDER BY Fs.MATMarketSalesUnit DESC"],[11,10,"Select DISTINCT \r\n'#26#'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.#26#marketSalesUnit marketSalesUnitT ,\r\nfsB.#26#MarketSalesUnit marketSalesUnitB,\r\nFsb.#26#SalesUnit SalesUnitB  ,\r\nFsb.#26#SalesUnitPY,\r\nFsT.#26#SalesUnit SalesUnitT,\r\n  --Fsb.#26#SalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.#26#marketSalesUnitLastMonth<>0 and fsT.#26#marketSalesUnitLastMonth is not null then (fsB.#26#MarketSalesUnitLastMonth /fsT.#26#marketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  FactSalesBrick FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From FactPOA POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From FactPOA POA \r\n\t\twhere 1=1 #41#\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1 #41#\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = {MAX_SALES_DATE_ID}\r\n  INNER JOIN FactSalesTerritory FsT on 1=1 #39# /*AND  FsT.DateId ={MAX_SALES_DATE_ID}*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN FactQuotasTerritory FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId ={MAX_SALES_DATE_ID}\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  FactEvents E\r\n  INNER JOIN FactPOA POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  FactEvents E\r\n\t\t\t  INNER JOIN FactPOA POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.#26#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #27#\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.#26#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #27#\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN DimBrick B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN DimTerritory T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN DimProduct P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 #25# --and FsB.DateId={MAX_SALES_DATE_ID} \r\n  ORDER BY QLMarket desc"],[31,30,"Select DISTINCT \r\n'#58#'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n  case when fsT.#58#marketSalesUnit<>0 and fsT.#58#marketSalesUnit is not null then (fsB.#58#MarketSalesUnit /fsT.#58#marketSalesUnit) else null end\r\nas QLMarket ,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\n  Fsb.#58#SalesUnit UnitSales,\r\ncase when Fsb.#58#SalesUnitPY<>0 and Fsb.#58#SalesUnitPY is not null then (Fsb.#58#SalesUnit-Fsb.#58#SalesUnitPY)/Fsb.#58#SalesUnitPY else NULL end Growth,\r\ncase when Fsb.#58#MarketSalesUnit <>0 and Fsb.#58#MarketSalesUnit  is not null then Fsb.#58#SalesUnit/Fsb.#58#MarketSalesUnit else NULL end MarketShare,\r\ncase when FsT.#58#SalesUnit<>0 and FsT.#58#SalesUnit is not null then Fsb.#58#SalesUnit/FsT.#58#SalesUnit else NULL end [QLProduct],\r\ncase when Fst.QTRSalesUnit<>0 and Fst.QTRSalesUnit is not null then FqT .QTRQuotaUnit/Fst.QTRSalesUnit else null end  QLTarget,B.BrickID\r\n  FROM \r\n  FactSalesBrick FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From FactPOA POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From FactPOA POA \r\n\t\twhere 1=1 #65#\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1 #65#\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId AND FsB.DateId = {MAX_SALES_DATE_ID}\r\n  INNER JOIN FactSalesTerritory FsT on 1=1 #69# AND  FsT.DateId ={MAX_SALES_DATE_ID} and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN FactQuotasTerritory FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId ={MAX_SALES_DATE_ID}\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  FactEvents E\r\n  INNER JOIN FactPOA POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  FactEvents E\r\n\t\t\t  INNER JOIN FactPOA POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.#58#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #62#\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.#58#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #62#\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN DimBrick B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN DimTerritory T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN DimProduct P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 #61# and FsB.DateId={MAX_SALES_DATE_ID} \r\n  ORDER BY QLMarket desc"],[10,9,"SELECT  \r\n       Fs.[BrickId]\r\n      ,B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,Fs.MarketSalesUnit\r\n     --,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      --,FS.dateId\r\n,MonthCode.value dateId\r\n     -- ,Fs.MATMarketSalesUnit\r\n  FROM FactSalesBrick Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n  INNER JOIN DimBrick B on B.brickId=Fs.brickId\r\n\r\n  WHERE 1=1  #23#   Group by  Fs.[BrickId],B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.MarketSalesUnit\r\n    --  ,Fs.DateId\r\n,MonthCode.value \r\n      ,Fs.MATMarketSalesUnitLastMonth\r\n ORDER BY Fs.MATMarketSalesUnitLastMonth DESC"],[13,12,"SELECT DISTINCT\r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen , TOTAL.NBDocs as TotalDocs, TOTAL.NBDocs -count(distinct E.[CustomerId]) as NbDocNotSeen,  POA.BrickId,POA.TerritoryId,\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName \r\n  From\r\n  FactEvents E\r\n  INNER JOIN FactPOA POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n  INNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\n  INNER JOIN DimDate D on 1=1\r\n\r\n  INNER JOIN \r\n (\r\n  SELECT count(distinct POA.CustomerId )NBDocs,POA.brickID,POA.TerritoryID FROM FactPOA POA\r\n Group by POA.brickId ,POA.TerritoryId\r\n) TOTAL\r\nON TOTAL.brickId=POA.brickId   AND Total.TerritoryId=POA.TerritoryId\r\n  \r\nwhere E.DateId between D.#34#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #33#\r\n#31#\r\n  Group by  POA.BrickId,POA.TerritoryId , C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName ,TOTAL.NBDocs\r\n"],[14,13,"\r\n  SELECT DISTINCT\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName \r\nFROM FactPOA POA\r\nINNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\nWHERE 1=1 #32# #43#\r\n Group by POA.TerritoryId ,\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName "],[15,14,"  SELECT DISTINCT\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName \r\nFROM FactPOA POA\r\nINNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nWHERE 1=1#35# #42#\r\nAND C.CustomerId not in \r\n\r\n(\r\n\r\nSELECT DISTINCT E.CustomerId\r\n  From\r\n  FactEvents E\r\n  INNER JOIN FactPOA POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId AND E.ProductId=POA.ProductId\r\n  INNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\n  INNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere E.DateId between D.#36#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #37# #35#\r\n)\r\n\r\n Group by POA.TerritoryId ,\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName "],[16,15,"SELECT DISTINCT FsN.YTDSalesTO,P.ProductNAme\r\nFROM FactSalesNational FsN\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsN.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 --and FsN.dateId={MAX_SALES_DATE_ID}\r\nOrder by P.ProductNAme"],[18,17,"SELECT FsT.YTDSalesTO,P.ProductName\r\nFROM VW_FactSalesTerritory FsT\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsT.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 --and Fst.dateid={MAX_SALES_DATE_ID} \r\nOrder by P.ProductNAme"],[19,18,"SELECT DISTINCT FsR.YTDSalesTO, P.ProductNAme\r\nFROM FactSalesRegion FsR\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsR.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1\r\nOrder by P.ProductNAme"],[20,19,"SELECT\r\n T.*\r\n,B.BrickName\r\nFROM (\r\nSELECT  \r\n D.MonthChar\r\n,D.DATEID\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n\r\nFROM FactSalesBrick Fs\r\nINNER JOIN DimProduct P on Fs.productId=P.ProductId \r\nINNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\nwhere 1=1  #45# #44#\r\n Group by D.DATEID,D.MonthChar,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end \r\n) AS T\r\nLEFT OUTER JOIN DimBrick AS B on B.BrickId=T.BrickId"],[21,20,"SELECT  \r\n      D.MonthChar\r\n     ,D.DATEID\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] as MarketUnitSales\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM FactSalesBrick Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\n  INNER JOIN DImDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 #46#  #47#\r\n AND P.ProductId not in\r\n(\r\nSELECT P.ProductId FROM DimProduct P\r\nWHERE P.HomeProductFlag=1  AND P.VisHomeProductFlag=1 \r\n)\r\n\r\n Group by D.monthChar,\r\n      D.DATEID,\r\n      Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.SalesUnit\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n"],[22,21,"SELECT DISTINCT FsR.YTDSalesTO,P.ProductNAme\r\nFROM FactSalesRegion FsR\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsR.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 and FsR.dateId={MAX_SALES_DATE_ID} \r\nOrder by P.ProductNAme"],[27,26,"select \r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\nFst.#51#SalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct,\r\ncase when FsT.#51#SalesUnitPY is not null and FsT.#51#SalesUnitPY<>0 then (FsT.#51#SalesUnit-FsT.#51#SalesUnitPY)/FsT.#51#SalesUnitPY else NULL end as TotalGrowth,\r\ncase when FsT.#51#MarketSalesUnit is not null and FsT.#51#MarketSalesUnit<>0 then FsT.#51#SalesUnit/FsT.#51#MarketSalesUnit else null end AS TotalMS,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\nfrom FactSalesTerritory FsT\r\n    INNER JOIN DimTerritory T on Fst.TerritoryId=T.TerritoryId\tand FsT.DateId={MAX_SALES_DATE_ID} #52#\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From FactPOA POA \r\nwhere 1=1  #54# \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From FactPOA POA \r\n\t\tinner join FactEvents E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n\twhere E.DateId between D.#51#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #53#\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n    "],[28,27,"  SELECT DISTINCT\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName \r\nFROM [FactPOA] POA\r\nINNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\nWHERE 1=1#57# #66#\r\nAND C.CustomerId not in \r\n\r\n(\r\n\r\nSELECT DISTINCT E.CustomerId\r\n  From\r\n  FactEvents E\r\n  INNER JOIN FactPOA POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId AND E.ProductId=POA.ProductId\r\n  INNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\n  INNER JOIN DimDate D on 1=1  \r\nwhere E.DateId between D.#60#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #64# #57#\r\n)\r\n\r\n Group by POA.TerritoryId ,\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName "],[29,28,"SELECT DISTINCT\r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen , TOTAL.NBDocs as TotalDocs, TOTAL.NBDocs -count(distinct E.[CustomerId]) as NbDocNotSeen,  POA.BrickId,POA.TerritoryId,\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName \r\n  From\r\n  FactEvents E\r\n  INNER JOIN FactPOA POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n  INNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\n  INNER JOIN DimDate D on 1=1\r\n\r\n  INNER JOIN \r\n (\r\n  SELECT count(distinct POA.CustomerId )NBDocs,POA.brickID,POA.TerritoryID FROM FactPOA POA\r\n Group by POA.brickId ,POA.TerritoryId\r\n) TOTAL\r\nON TOTAL.brickId=POA.brickId   AND Total.TerritoryId=POA.TerritoryId\r\n  \r\nwhere E.DateId between D.#59#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #63#\r\n#55#\r\n  Group by  POA.BrickId,POA.TerritoryId , C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName ,TOTAL.NBDocs\r\n"],[30,29,"\r\n  SELECT DISTINCT\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName \r\nFROM [FactPOA] POA\r\nINNER JOIN DimCustomer C ON C.CustomerId=POA.CustomerId\r\nWHERE 1=1 #56# #67#\r\n Group by POA.TerritoryId ,\r\n   C.SpecialtyName,C.CustomerLastName,C.CustomerFirstName "],[12,11,"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'#28#' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.#28#SalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.#28#SalesUnitPY SalesUnitPY ,\r\nFsT.#28#SalesUnit SalesUnit,\r\nFsT.#28#MarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom FactSalesTerritory FsT\r\n    INNER JOIN DimTerritory T on Fst.TerritoryId=T.TerritoryId  #29#\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From FactPOA POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1  #40# \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From FactPOA POA \r\n\t\tinner join FactEvents E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.#28#StartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} #30#\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'#28#' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.#28#SalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.#28#SalesUnitPY SalesUnitPY ,\r\nFsT.#28#SalesUnit SalesUnit,\r\nFsT.#28#MarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom FactSalesNational FsT\r\n    INNER JOIN DimNational T on Fst.NationalId=T.NationalId  #29#\r\n) REQ order by TypTerr desc\r\n    "],[34,33,"select \r\n\tpop.TargetName,\r\n\tpop.ProductName, \r\n\t--pop.Segmentation, \r\n\tpop.NbDoctors,\r\n\tcase when seen.ProductName is null then 0 else seen.NbDocSeen end NbSeen\r\nfrom\r\n(\r\n\tselect \r\n\t\ttar.TargetName ,\r\n\t\tprd.ProductName, \r\n\t\t--prd.ProductName + '-'+  tar.TargetName Segmentation,\r\n\t\tCOUNT(distinct CustomerId) NbDoctors\r\n\tfrom \r\n\t\tFactPOA poa\r\n\t\tinner join DimTarget tar on tar.TargetId=poa.TargetId\r\n\t\tinner join DimProduct prd on prd.ProductId=poa.ProductId\r\n\tgroup by\r\n\t\tprd.ProductName,\r\n\t\ttar.TargetName\r\n) pop\r\nleft outer join \r\n(\r\n\tselect\r\n\t\t--prd.ProductName + '-'+  tar.TargetName Segmentation,\r\n\t\tprd.ProductName ,\r\n\t\ttar.TargetName ,\r\n\t\tCOUNT(distinct ev.CustomerId)  NbDocSeen\r\n\tfrom \r\n\t\tFactEvents ev\r\n\t\tinner join FactPOA poa on poa.ProductId=ev.ProductId and poa.TerritoryId=ev.TerritoryId and poa.CustomerId=ev.CustomerId\r\n\t\tinner join DimTarget tar on tar.TargetId=poa.TargetId\r\n\t\tinner join DimProduct prd on prd.ProductId=poa.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n\twhere ev.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= {MAX_SALES_DATE_ID} \r\n\tgroup by\r\n\t\tprd.ProductName,\r\n\t\ttar.TargetName\r\n) seen on seen.ProductName=pop.ProductName and seen.TargetName=pop.TargetName\r\norder by \r\n\tpop.ProductName, pop.TargetName"],[32,31,"SELECT  \r\n     D.MonthChar\r\n     ,D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n        ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM FactSalesTerritory Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\n  INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 #70#\r\n AND P.ProductId not in\r\n(\r\nSELECT P.ProductId FROM DimProduct P\r\nWHERE P.HomeProductFlag=1  AND P.VisHomeProductFlag=1 \r\n)\r\nGroup by \r\n\t   D.DATEID\r\n\t , D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end "],[33,32,"select  * from\r\n(\r\nSELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId #75# then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM FactSalesTerritory Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 #74#\r\nand P.ProductName in ('PROCORALAN','IKOREL','INSPRA','RANEXA','VASTAREL','ACERYCAL','ALL OTHER C9B','AMLODIPINE','CO DIOVAN','COVERDINE','COVERSYL', 'COVERSYL ARGI PLUS', 'VALDOXAN','CYMBALTA', 'TOTAL FLUOXETINE', 'TOTAL PAROXATINE','TOTAL SERTRALINE','TOTAL VENLAFAXINE' )\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId #75# then 'AAAAA' ELSE P.ProductName end \r\n) t\r\norder by SRT"],[1,1,"select\r\n\tBrickName,\r\n\tfsb.SalesUnit,\r\n\tfsb.SalesUnitPY,\r\n\tfsb.MarketSalesUnit\r\nfrom\r\n\tDimBrick db \r\n\tinner join FactSalesBrickBis fsb on fsb.BrickId=db.BrickId\r\nwhere fsb.ProductId=355\t"],[2,1,""],[3,2,"SELECT\r\n T.*\r\n,B.BrickName\r\nFROM (\r\nSELECT  \r\n     MonthLabel.Value MonthChar ,\r\n     MonthCode.value DateId\r\n      ,Fs.[BrickId]  \r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\nFROM FactSalesBrick Fs\r\nINNER JOIN DimProduct P on Fs.productId=P.ProductId \r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\nwhere 1=1  #15# #16#\r\n Group by [BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n,MonthLabel.value, MonthCode.value\r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end \r\n) AS T\r\nLEFT OUTER JOIN DimBrick AS B on B.BrickId=T.BrickId"],[5,4,"SELECT  \r\n      MonthLabel.value MonthChar --   D.MonthChar\r\n    -- ,D.DATEID\r\n      ,MonthCode.value DateId\t\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] as MarketUnitSales\r\n     ,case when P.ProductId #73# then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM FactSalesBrick Fs\r\n INNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n INNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId \r\n  INNER JOIN DimProduct HP on P.Marketname=HP.Marketname\r\n--  INNER JOIN DImDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 #8#  #9#\r\n\r\n Group by MonthLabel.value ,-- D.monthChar,\r\n      MonthCode.value,\r\n      Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.SalesUnit\r\n      ,case when P.ProductId #73# then 'AAAAA' ELSE P.ProductName end \r\n"],[6,5,"SELECT  \r\nMonthLabel.value MonthChar--  D.MonthChar\r\n, MonthCode.value DateID--  D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,fs.MarketSalesUnit \r\n   --  ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM FactSalesTerritory Fs\r\n  INNER JOIN DimProduct P on Fs.productId=P.ProductId\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n where 1=1   #18# #17#\r\n Group by \r\n\t MonthLabel.value --  D.DATEID\r\n\t ,MonthCode.value -- D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n     ,Fs.MarketSalesUnit\r\n    ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n\r\n  "],[35,34,"select 'VALDOXAN' Product, 2016 Years, 0.12 X, 0.25 Y, 30 Z, '#0000FF' color, .9 alpha, 'triangleUp' marker, 0.33 XBase, 0.25 YBase\r\nunion\r\nselect 'VALDOXAN', 2015, -0.15, 1.6, 20, '#0000FF', .3, 'triangleDown', 0.33, 0.25\r\nunion\r\n\r\nselect 'PROCORALAN', 2016, 0.23 , -0.12 , 15, '#FF0000', .9, null, 0.33, 0.25\r\nunion\r\nselect 'PROCORALAN', 2015, 0.4, 0.02, 30, '#FF0000', .3, null, 0.33, 0.25\r\nunion\r\n\r\nselect 'STABLON', 2016, 0.05 , 0.31 , 21, '#00FF00', .9, 'square', 0.33, 0.25\r\nunion\r\nselect 'STABLON', 2015, 0.1, 0.28, 9, '#00FF00', .3, 'diamond', 0.33, 0.25\r\n\r\norder by Product desc, Years desc\r\n"],[36,35,"select 'PDT 01' Product, 1.123 Sales\r\nunion\r\nselect 'PDT 02' Product, -12.123 Sales\r\nunion\r\nselect 'PDT 03' Product, 123.123 Sales\r\nunion\r\nselect 'PDT 04' Product, -1234.123 Sales\r\nunion\r\nselect 'PDT 05' Product, 12345.123 Sales\r\nunion\r\nselect 'PDT 06' Product, -123456.123 Sales\r\nunion\r\nselect 'PDT 07' Product, 1234567.123 Sales\r\nunion\r\nselect 'PDT 08' Product, -12345678.123 Sales\r\nunion\r\nselect 'PDT 09' Product, 123456789.123 Sales\r\nunion\r\nselect 'PDT 10' Product, -1234567890.123 Sales\r\n"],[37,36,"select \r\n\t'A' Target,\r\n\t4 NotSeen,\r\n\t10 Seen\r\nunion all\r\nselect \r\n\t'AA' Target,\r\n\t1 NotSeen,\r\n\t7 Seen\r\nunion all\r\nselect \r\n\t'B' Target,\r\n\t6 NotSeen,\r\n\t3 Seen\r\n\r\nunion all\r\nselect \r\n\t'C' Target,\r\n\t9 NotSeen,\r\n\t1 Seen\r\n\r\n\r\n"],[38,37,"select 1.6 Col1, 2 Col2, 3 Col3\r\nunion\r\nselect 5.456 Col1, 5 Col2, 9 Col3\r\nunion\r\nselect 12.1159 Col1, 6 Col2, 5 Col3\r\nunion\r\nselect 3.167 Col1, 1 Col2, 4 Col3\r\nunion\r\nselect 7 Col1, 2 Col2, 8 Col3"]]},{"columns":["ID","DatasetId","LeftQueryId","RightQueryId","IsOuter","JoinClause"],"data":[]},{"columns":["ID","AnalysisId","TYPE","CAPTION"],"data":[[1,1,"Table","Toto"],[2,2,"Charts","SALES"],[4,4,"Charts","MarketSales"],[5,5,"Charts","SALES"],[15,5,"Charts","MarketShare"],[7,7,"Charts","MarketShares"],[14,7,"Charts","MarketSales"],[9,9,"Charts","Graph"],[10,9,"QueryResult","Query result"],[11,9,"MultipleOutput","Choose display"],[12,9,"Table","Table"],[16,10,"QueryResult","Activity"],[17,10,"Table","Act"],[18,10,"ColumnChart","ActCol"],[19,10,"Charts","chartAct"],[20,10,"Table","TabTotal"],[26,10,"Table","TableDocSeen"],[27,10,"Table","TableDocTotal"],[28,10,"Table","TableDocNotSeen"],[25,12,"Table","TabTotal"],[29,13,"PieChart","NationalYTD"],[31,15,"PieChart","TerritoryYTD"],[32,16,"PieChart","RegionYTD"],[33,17,"Charts","SALES"],[34,18,"Charts","MarketSales"],[35,19,"PieChart","RegionYTD"],[36,20,"PieChart","TerritoryYTD"],[37,21,"PieChart","NationalYTD"],[38,22,"Charts","SALES"],[39,22,"Charts","MarketShare"],[40,23,"Charts","Graph"],[41,23,"QueryResult","Query result"],[42,23,"MultipleOutput","Choose display"],[43,23,"Table","Table"],[44,24,"QueryResult","Activity"],[45,24,"Table","Act"],[46,24,"ColumnChart","ActCol"],[47,24,"Charts","chartAct"],[48,24,"Table","TabTotal"],[49,25,"QueryResult","Activity"],[50,25,"Table","Act"],[51,25,"ColumnChart","ActCol"],[52,25,"Charts","chartAct"],[53,25,"Table","TabTotal"],[54,25,"Table","TableDocSeen"],[55,25,"Table","TableDocTotal"],[56,25,"Table","TableDocNotSeen"],[57,26,"Charts","MarketShares"],[58,26,"Charts","MarketSales"],[59,27,"Charts","MarketShares"],[60,27,"Charts","MarketSales"],[61,28,"QueryResult","QueryResult"],[62,28,"Charts","StackedBar"],[63,29,"MultipleOutput","Multi"],[64,29,"QueryResult","Query"],[65,29,"BubbleChart","Bubbles"],[66,30,"Table","Table"],[67,31,"Table","Test spark"],[68,32,"Table","Format1"]]},{"columns":["ID","OutputId","NAME","VALUE"],"data":[[532,50,"ColumnTitle","\"Minibrick\";\"Minibrick Potential\";\"No of Target Drs (A)\";\"Drs Seen\";\"Coverage\";\"Freq\";\"Call %\";\"Sales\";\"Growth\";\"Market Share\";\"Sales %\";\""],[259,25,"ColumnFormat TotalQLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[524,48,"Dataset","DSIMSSALES"],[525,48,"ShowHeader","0"],[653,60,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[81,12,"ColumnTitle","\"Mini-Brick\";\"Market Share %\";\"Sales Unit\""],[169,19,"_AxisYFormat PivotColDefault","{ \"type\": \"column\", \"fillAlphas\": 0.5,  \"valueAxis\": \"AxeDefault\"}"],[395,35,"LegendValue","[[percents]]%"],[407,36,"LegendText","[[title]]"],[408,36,"Tooltip","[[title]]:<br><b style=\"font-size:1.4em\">[[percents]]%</b>"],[409,36,"AxisYTitle",""],[440,39,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[659,60,"RowSplitter","MonthChar; DateId; MarketSales; MarketSalesUnit;"],[660,60,"Zoom","1"],[661,60,"ValueAxis","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market sales\" }]"],[662,60,"LabelRotation","25"],[663,60,"AxisYTitle","Sales"],[664,60,"ShowCategoryAxis","<all>"],[441,39,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[442,39,"LabelRotation","45"],[443,39,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[444,39,"ShowCategoryAxis","<all>"],[310,29,"PivotIndicators","YTDSalesTON, sum"],[103,14,"Dataset","DSIMSSALES"],[104,14,"AxisX","MonthChar"],[105,14,"AxisXTitle","Date ID"],[106,14,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[108,14,"Legend","right"],[109,14,"Title","MARKET UNIT SALES IN TERRITORY"],[110,14,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[200,17,"ColumnHierarchy \"Doctors\", grp1","@3; @4; @5; @6;@7"],[201,17,"ColumnHierarchy \"Product Sales (Unit)\", grp2","@8; @9; @10; @11;"],[112,15,"AxisYTitle","Sales"],[113,15,"Dataset","DSIMSSALES"],[621,58,"ShowCategoryAxis","<all>"],[80,12,"Dataset","DSIMSSALES"],[565,53,"ColumnResize","11"],[114,15,"AxisX","MonthChar"],[480,44,"Dataset","DSIMSSALES"],[622,58,"ValueAxis","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market sales\" }]"],[483,45,"Dataset","DSIMSSALES"],[357,15,"Tooltip","\"@ProductName </br> <b>@PivotedMS</b> %\"\n"],[484,45,"ColumnTitle","\"Minibrick\";\"Minibrick Potential\";\"No of Target Drs (A)\";\"Drs Seen\";\"Coverage\";\"Freq\";\"Pres %\";\"Sales\";\"Growth\";\"Market Share\";\"Sales %\""],[485,45,"SelectionMode","singlerow"],[486,45,"ColumnOrder","Minibrick;QLMarket;No of Target Drs (A);No of Target Drs Seen;Coverage;Frequency;QLPres;UnitSales;Growth;MarketShare;QLProduct"],[545,52,"Legend","right"],[28,4,"Legend","right"],[467,40,"ValueAxes","[{ \"id\": \"VA1\", \"color\": \"#0094ff\", \"axisColor\": \"#0094ff\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Sales (units)\" }, { \"id\": \"VA2\", \"color\": \"#ff006e\", \"axisColor\": \"#ff006e\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"right\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[29,5,"AxisYTitle","Sales"],[384,34,"_AxisY","SalesUnit"],[385,34,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[252,25,"ColumnResize","11"],[253,25,"ColumnOrder","TerritoryName;TotalQLMarket;TotalMedPOA;TotalMedVus;TotalCoverage;TotalFrequency;TotalQLPres;TotalSalesTerr;TotalGrowth;TotalMS;TotalQLProduct"],[254,25,"SelectionMode","singlerow"],[256,25,"ColumnFormat TotalQLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[257,25,"ColumnFormat TotalQLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[465,40,"ShowCategoryAxis","<all>"],[466,40,"Title","Minibrick unit sales & Market share"],[609,57,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[718,25,"Zoom","0"],[322,31,"AxisY","YTDSalesTON"],[713,67,"ColumnExpression","STACK1 =\n\t\" @seen ¤ @notseen \";\n\nSTACK2 =\n\t\" @seen # @notseen \";"],[437,38,"AxisXTitle","Date ID"],[148,17,"ColumnFormat QLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[577,54,"ColumnResize","1"],[122,5,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Sales\"}]"],[375,33,"ShowCategoryAxis","<all>"],[543,50,"ColumnFormat Growth","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[415,37,"LegendText","[[title]]"],[416,37,"Tooltip","[[title]]:<br><b style=\"font-size:1.4em\">[[percents]]%</b>"],[417,37,"AxisX","ProductName"],[418,37,"AxisY","YTDSalesTO"],[419,37,"Legend","right"],[420,37,"AxisYTitle",""],[421,37,"PivotIndicators","YTDSalesTO, sum"],[422,37,"Dataset","DSIMSSALES"],[423,37,"Title","National YTD"],[424,29,"ColumnExpression","YTDSalesTON =\n\tfn.rowSplitterIndex('@YTDSalesTO', 24);"],[425,38,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[426,38,"PivotIndicators","SalesUnit,sum"],[427,38,"Legend","right"],[428,38,"LabelRotation","45"],[429,38,"AxisYTitle","Sales"],[430,38,"Dataset","DSIMSSALES"],[431,38,"AxisX","MonthChar"],[432,38,"ShowCategoryAxis","<all>"],[433,38,"Zoom","0"],[434,38,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[435,38,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\"}"],[671,62,"ValueAxes","[{ \"id\": \"VA3\", \"color\": \"#0094ff\", \"axisColor\": \"#0094ff\", \"axisAlpha\": 1, \"gridAlpha\": 0 , \"stackType\": \"regular\", \"position\": \"left\", \"offset\": 0, \"title\": \"Doctors seen/unseen\" }]"],[636,59,"Tooltip","\"@ProductName </br> <b>@PivotedMS</b> %\""],[637,59,"Title","Market share evolution per month"],[638,59,"LabelRotation","45"],[639,59,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[98,7,"LabelRotation","45"],[1,1,"Dataset","Default"],[31,5,"Dataset","DSIMSSALES"],[436,38,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Sales\"}]"],[548,52,"_AxisYFormat PivotCol1","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\"}"],[99,7,"AxisYFormat _PIVOT1_INDICATOR1 ","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[278,28,"ColumnTitle","\"Last Name\";\"First Name\";\"Specialty\";\""],[279,28,"ColumnResize","1"],[280,28,"ColumnOrder","CustomerLastName;CustomerFirstName;SpecialtyName"],[35,5,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[453,39,"Legend","right"],[454,39,"PivotIndicators","MarketSharePtc ,sum , PvtMS, PivotedMS"],[455,39,"AxisY","MarketSharePtc "],[502,47,"AxisY","QLMarket; QLPres;QLProduct"],[413,31,"ColumnExpression","YTDSalesTON =\n\tfn.rowSplitterIndex('@YTDSalesTO', 24);"],[414,37,"LegendValue","[[percents]]%"],[623,58,"LabelRotation","45"],[624,58,"AxisYTitle","Sales"],[625,7,"RowSplitter","MonthChar; DateId; MarketSales; MarketSalesUnit;"],[626,14,"RowSplitter","MonthChar; DateId; MarketSales; MarketSalesUnit;"],[627,25,"ColumnFormat TerritoryName","[{\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[514,48,"SelectionMode","singlerow"],[5,2,"AxisX","MonthChar"],[515,48,"ColumnFormat TotalQLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[459,40,"AxisX","BrickName"],[382,34,"AxisX","MonthChar"],[630,25,"ColumnFormat TotalSalesTerr","[{\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[519,48,"ColumnFormat TotalFrequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 2\n\t}\n}]"],[342,32,"Title","Region YTD"],[147,17,"ColumnFormat Growth","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[160,19,"AxisYTitle","\"Minibrick Potential\"; \"Call %\";\"Sales %\""],[161,19,"_AxisY","[{ \"col\": \"QLMarket\", \"sortType\": \"desc\" }, { \"col\": \"QLPres\" }]"],[573,53,"ColumnFormat Coverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[574,53,"ColumnFormat TotalFrequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 1\n\t}\n}]"],[575,54,"Dataset","DSCustomerSeen"],[6,2,"AxisXTitle","Date ID"],[33,5,"AxisXTitle","Date ID"],[34,5,"AxisY","SalesUnit"],[87,7,"Title","Market share evolution per month"],[88,5,"Title","Monthly Unit sales in territory"],[396,35,"LegendText","[[title]]"],[601,57,"ColumnExpression","MarketSharePtc =\n\tMath.round(1000 * @MarketShare) / 10;"],[162,19,"AxisX","Minibrick"],[107,14,"PivotIndicators","MarketSales,sum"],[250,25,"Dataset","DSIMSSALES"],[508,47,"AxisXTitle","UGA"],[696,65,"ColorField","@6"],[547,52,"_AxisYFormat PivotColDefault","{ \"type\": \"column\", \"fillAlphas\": 0.5,  \"valueAxis\": \"AxeDefault\"}"],[376,2,"RowSplitter","MonthChar; DateId; SalesUnit"],[264,25,"ColumnFormat TotalCoverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[361,1,"ColumnExpression","Sales =\n\t'24ème élément de @SALESUNIT';\n\nSalesPY =\n\t'24 élément de @SALESUNITPY';\n\nSalesPYBis =\n\t'12 élément de @SALESUNIT';"],[272,27,"Dataset","DSCustomerTotal"],[273,27,"ColumnTitle","\"Last Name\";\"First Name\";\"Specialty\";\""],[274,27,"ColumnResize","1"],[275,27,"ColumnOrder","CustomerLastName;CustomerFirstName;SpecialtyName"],[7,2,"AxisY","SalesUnit"],[8,2,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[9,2,"PivotIndicators","SalesUnit,sum"],[10,2,"Legend","right"],[20,4,"AxisYTitle","Sales"],[22,4,"Dataset","DSIMSSALES"],[23,4,"AxisX","MonthChar"],[24,4,"AxisXTitle","Date ID"],[25,4,"_AxisY","SalesUnit"],[26,4,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[27,4,"PivotIndicators","MarketUnitSales,sum"],[504,47,"AxisYTitle","\"Minibrick Potential\"; \"Pres %\";\"Sales %\""],[505,47,"_AxisY","[{ \"col\": \"QLMarket\", \"sortType\": \"desc\" }, { \"col\": \"QLPres\" }]"],[506,47,"AxisX","Minibrick"],[507,47,"Dataset","DSIMSSALES"],[509,47,"_PivotY","Minibrick"],[510,47,"_PivotIndicators","MarketUnitSales,sum"],[511,47,"Legend","right"],[494,45,"ColumnFormat Frequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 1\n\t}\n}]"],[126,15,"LabelRotation","45"],[127,15,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[551,52,"LabelRotation","45"],[552,52,"AxisY","QLMarketPtc; QLPresPtc;QLProductPtc"],[2,2,"AxisYTitle","Sales"],[4,2,"Dataset","DSIMSSALES"],[516,48,"ColumnFormat TotalQLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[68,9,"AxisYFormat MarketShare","{ \"type\": \"smoothedLine\", \"lineColor\": \"#ff006e\", \"lineAlpha\": 0, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"VA2\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[464,40,"AxisYFormat MarketShare","{ \"type\": \"smoothedLine\", \"lineColor\": \"#ff006e\", \"lineAlpha\": 0, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"VA2\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[323,31,"Legend","right"],[324,31,"LegendValue","[[percents]]%"],[325,31,"LegendText","[[title]]"],[326,31,"Tooltip","[[title]]:<br><b style=\"font-size:1.4em\">[[percents]]%</b>"],[327,31,"AxisYTitle",""],[328,31,"PivotIndicators","YTDSalesTON, sum"],[329,31,"Dataset","DSIMSSALES"],[330,29,"Title","National YTD"],[332,31,"Title","GP YTD"],[333,32,"AxisX","ProductName"],[334,32,"AxisY","YTDSalesTON"],[335,32,"Legend","right"],[336,32,"LegendValue","[[percents]]%"],[339,32,"AxisYTitle",""],[340,32,"PivotIndicators","YTDSalesTON, sum"],[695,65,"AxisZ","@5"],[102,14,"AxisYTitle","Sales"],[125,15,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[70,9,"ValueAxes","[{ \"id\": \"VA1\", \"color\": \"#0094ff\", \"axisColor\": \"#0094ff\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Sales (units)\" }, { \"id\": \"VA2\", \"color\": \"#ff006e\", \"axisColor\": \"#ff006e\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"right\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[311,29,"Dataset","DSIMSSALES"],[321,31,"AxisX","ProductName"],[115,15,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[116,15,"Title",""],[117,15,"Legend","right"],[118,15,"PivotIndicators","MarketSharePtc ,sum , PvtMS, PivotedMS"],[119,15,"AxisY","MarketSharePtc "],[120,5,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[121,5,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\"}"],[631,9,"Dataset","DSIMSSALES"],[75,12,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[130,4,"AxisYFormat _PIVOT1_INDICATOR1 ","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\"}"],[131,4,"LabelRotation","45"],[132,2,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Sales\" }]"],[133,2,"LabelRotation","45"],[134,2,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[546,52,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"%\"}]"],[36,5,"PivotIndicators","SalesUnit,sum"],[163,19,"Dataset","DSIMSSALES"],[164,19,"AxisXTitle","UGA"],[165,19,"_PivotY","Minibrick"],[166,19,"_PivotIndicators","MarketUnitSales,sum"],[175,19,"AxisYFormat QLProductPtc","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[128,4,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market Sales\" }]"],[521,48,"ColumnFormat TotalGrowth","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[535,50,"SelectionMode","singlerow"],[536,50,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[537,50,"ColumnFormat QLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[37,5,"Legend","right"],[478,12,"ColumnExpression","MarketSalesUnitN =\n\tfn.rowSplitterIndex('@MarketSalesUnit', 24);\n\nSalesUnitN =\n\tfn.rowSplitterIndex('@SalesUnit', 24);\n\nMarketShare =\n\t'@SalesUnitN' / '@MarketSalesUnitN';"],[479,9,"ColumnExpression","MarketSalesUnitN =\n\tfn.rowSplitterIndex('@MarketSalesUnit', 24);\n\nSalesUnitN =\n\tfn.rowSplitterIndex('@SalesUnit', 24);\n\nMarketShare =\n\t'@SalesUnitN' / '@MarketSalesUnitN';"],[353,5,"Zoom","0"],[354,15,"Zoom","0"],[355,7,"Zoom","0"],[47,7,"AxisYTitle","Sales"],[49,7,"Dataset","DSIMSSALES"],[50,7,"AxisX","MonthChar"],[51,7,"AxisXTitle","Date ID"],[52,7,"_AxisY","SalesUnit"],[593,17,"ColumnExpression","QLProduct =\n\tfn.rowSplitterIndex('@SalesUnitB', 24) / fn.rowSplitterIndex('@SalesUnitT', 24);\n\nMarketShare =\n\tfn.rowSplitterIndex('@SalesUnitB', 24) / fn.rowSplitterIndex('@MarketSalesUnitB', 24);\n\nQLTarget =\n\t@QTRQuotaUnit / fn.rowSplitterIndex('@QTRSalesUnitT', 24);\n\nUnitSales =\n\tfn.rowSplitterIndex('@SalesUnitB', 24);\n\nPreviousSales =\n\t'@Period'=='@MQT' ? fn.rowSplitterIndex('@SalesUnitB', 21) : '@Period'=='' ? fn.rowSplitterIndex('@SalesUnitB', 23) : fn.rowSplitterIndex('@SalesUnitB', 12);\n\nGrowth =\n\t@PreviousSales == 0 ? '' : fn.rowSplitterIndex('@SalesUnitB', 24) / @PreviousSales - 1;"],[526,25,"ColumnExpression","TotalMS =\n\tfn.rowSplitterIndex('@SalesUnit', 24) / fn.rowSplitterIndex('@MarketSalesUnit', 24);\n\nPreviousSales =\n\t'@Period'=='@MQT' ? fn.rowSplitterIndex('@SalesUnit', 21) : '@Period'=='' ? fn.rowSplitterIndex('@SalesUnit', 23) : fn.rowSplitterIndex('@SalesUnit', 12);\n\nTotalGrowth =\n\t@PreviousSales == 0 ? '' : fn.rowSplitterIndex('@SalesUnit', 24) / @PreviousSales - 1;\n\nTotalSalesTerr =\n\tfn.rowSplitterIndex('@SalesUnit', 24);"],[93,7,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[100,14,"ValueAxis","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market sales\" }]"],[101,14,"LabelRotation","45"],[530,50,"ColumnHierarchy %V, grp0","@2; "],[531,50,"Dataset","DSIMSSALES"],[352,19,"ColumnExpression","QLProduct =\n\tfn.rowSplitterIndex('@SalesUnitB', 24) / fn.rowSplitterIndex('@SalesUnitT', 24);\n\nMarketShare =\n\tfn.rowSplitterIndex('@SalesUnitB', 24) / fn.rowSplitterIndex('@MarketSalesUnitB', 24);\n\nQLTarget =\n\t@QTRQuotaUnit / fn.rowSplitterIndex('@QTRSalesUnitT', 24);\n\nUnitSales =\n\tfn.rowSplitterIndex('@SalesUnitB', 24);\n\nPreviousSales =\n\t'@Period'=='@MQT' ? fn.rowSplitterIndex('@SalesUnitPYB', 21) : '@Period'=='' ? fn.rowSplitterIndex('@SalesUnitPYB', 23) : fn.rowSplitterIndex('@SalesUnitPYB', 12);\n\nGrowth =\n\t@PreviousSales == 0 ? '' : fn.rowSplitterIndex('@SalesUnitB', 24) - @PreviousSales / @PreviousSales;\n\nGrowthpp =\n\t'@Period'=='@MQT' ? fn.rowSplitterIndex('@SalesUnitB', 24) - fn.rowSplitterIndex('@SalesUnitPYB', 21) / fn.rowSplitterIndex('@SalesUnitPYB', 21) : '@Period'=='@Month' ? fn.rowSplitterIndex('@SalesUnitB', 24) - fn.rowSplitterIndex('@SalesUnitPYB', 23) / fn.rowSplitterIndex('@SalesUnitPYB', 23) : fn.rowSplitterIndex('@SalesUnitB', 24) - fn.rowSplitterIndex('@SalesUnitPYB', 12) / fn.rowSplitterIndex('@SalesUnitPYB', 12);\n\nQLPresPtc =\n\tMath.round(1000 * (parseFloat('@QLPres') || 0)) / 10;\n\nQLMarketPtc =\n\tMath.round(1000 * (parseFloat('@QLMarket') || 0)) / 10;\n\nQLProductPtc =\n\tMath.round(1000 * (parseFloat('@QLProduct') || 0)) / 10;"],[307,29,"LegendText","[[title]]"],[262,25,"ColumnFormat TotalMS","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[309,29,"AxisYTitle",""],[457,15,"RowSplitter","MonthChar; DateId; SalesUnit; MarketSalesUnit"],[517,48,"ColumnFormat TotalQLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[500,47,"AxisYFormat QLPres","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[389,34,"ShowCategoryAxis","<all>"],[358,15,"ColumnExpression","MarketShare =\n\t'@SalesUnit' / '@MarketSalesUnit';\n\nMarketSharePtc =\n\tMath.round(1000 * @MarketShare) / 10;"],[359,7,"ColumnExpression","MarketShare =\n\t'@MarketSales' / '@MarketSalesUnit';\n\nMarketSharePtc =\n\tMath.round(1000 * @MarketShare) / 10;"],[360,7,"Tooltip","\"@ProductName </br> <b>@PivotedMS</b> %\""],[32,5,"AxisX","MonthChar"],[66,9,"AxisY","SalesUnitN;MarketShare"],[111,14,"AxisYFormat _PIVOT1_INDICATOR1 ","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\"}"],[348,15,"ShowCategoryAxis","<all>"],[349,4,"ShowCategoryAxis","<all>"],[350,2,"ShowCategoryAxis","<all>"],[351,11,"ShowCategoryAxis","<all>"],[363,33,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Sales\" }]"],[261,25,"ColumnFormat TotalFrequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 2\n\t}\n}]"],[55,7,"Legend","right"],[65,9,"AxisX","BrickName"],[456,5,"RowSplitter","MonthChar; DateId; SalesUnit; MarketSalesUnit"],[124,15,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[495,45,"ColumnHierarchy \"%V\", grp0","@2; "],[496,47,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"%\" }]"],[497,47,"_AxisYFormat PivotColDefault","{ \"type\": \"column\", \"fillAlphas\": 0.5,  \"valueAxis\": \"AxeDefault\" }"],[401,35,"Title","Region YTD"],[402,32,"ColumnExpression","YTDSalesTON =\n\tfn.rowSplitterIndex('@YTDSalesTO', 24);"],[403,36,"AxisX","ProductName"],[404,36,"AxisY","YTDSalesTO"],[405,36,"Legend","right"],[406,36,"LegendValue","[[percents]]%"],[469,42,"OutputId","40;43"],[470,42,"ShowCategoryAxis","<all>"],[471,43,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[472,43,"SelectionMode","singlerow"],[473,43,"Dataset","DSIMSSALES"],[474,43,"ColumnTitle","\"Mini-Brick\";\"Market Share %\";\"Sales Unit\""],[475,43,"ColumnResize","3"],[476,43,"ColumnOrder","BrickName;MarketShare;SalesUnit"],[477,43,"Title","minibrick unit sales & market share"],[610,57,"PivotIndicators","MarketSharePtc,sum, MSPtc, PivotedMS "],[611,58,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\"}"],[612,58,"Zoom","0"],[613,58,"Dataset","DSIMSSALES"],[614,58,"AxisX","MonthChar"],[615,58,"AxisXTitle","Date ID"],[616,58,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[617,58,"PivotIndicators","MarketSales,sum"],[347,5,"ShowCategoryAxis","<all>"],[341,32,"Dataset","DSIMSSALES"],[303,29,"AxisX","ProductName"],[304,29,"AxisY","YTDSalesTON"],[305,29,"Legend","right"],[85,4,"Title","Market Unit sales in mini-brick(s)"],[654,60,"PivotIndicators","MarketSales,sum"],[655,60,"Legend","right"],[656,60,"Title","MARKET UNIT SALES IN TERRITORY"],[657,60,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"bulletSize\": \"3\",  \"valueAxis\": \"AxeDefault\"}"],[658,60,"AxisYFormat _PIVOT1_INDICATOR1 ","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"round\" , \"bulletSize\": \"3\" , \"valueAxis\": \"AxeDefault\"}"],[308,29,"Tooltip","[[title]]:<br><b style=\"font-size:1.4em\">[[percents]]%</b>"],[167,19,"Legend","right"],[203,17,"ColumnFormat Coverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[204,17,"ColumnFormat Frequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 1\n\t}\n}]"],[205,17,"ColumnHierarchy \"%V\", grp0","@2; "],[206,20,"Dataset","DSIMSSALES"],[207,20,"ColumnTitle","\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\""],[208,20,"ColumnResize","11"],[209,20,"ColumnOrder","TerritoryName;TotalQLMarket;TotalMedPOA;TotalMedVus;;TotalFrequency;TotalQLPres;TotalSalesTerr;;;TotalQLProduct"],[210,20,"SelectionMode","singlerow"],[211,20,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[212,20,"ColumnFormat TotalQLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[213,20,"ColumnFormat TotalQLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[714,67,"ColumnFormat STACK1","[{\n\t\"type\": \"stackedChart\",\n\t\"data\": \"\",\n\t\"separator\": \"¤\",\n\t\"colors\": [\"#00ff00\", \"#ff0000\"],\n\t\"showValue\": true,\n\t\"unit\": \"\"\n}, {\n\t\"type\": \"dashboardFilter\",\n\t\"title\": \"Go to DashboardId 11\",\n\t\"dashboardId\": 11,\n\t\"data\": \" \"\n}]"],[214,20,"ColumnFormat Growth","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[215,20,"ColumnFormat TotalQLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[216,20,"ColumnFormat Coverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[217,20,"ColumnFormat TotalFrequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 1\n\t}\n}]"],[263,25,"ColumnFormat TotalGrowth","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}]"],[366,33,"AxisYTitle","Sales"],[367,33,"Dataset","DSIMSSALES"],[368,33,"AxisX","MonthChar"],[594,57,"Legend","right"],[595,57,"AxisYTitle","Sales"],[596,57,"Dataset","DSIMSSALES"],[597,57,"AxisX","MonthChar"],[598,57,"AxisXTitle","Date ID"],[599,57,"_AxisY","SalesUnit"],[719,68,"ColumnFormat Col2","[{\r\n    \"type\": \"link\", \"data\": \" 'http://google.fr/'  \", \"title\": \"Super test!!!\"\r\n}]"],[410,36,"PivotIndicators","YTDSalesTO, sum"],[710,65,"AxisXValue","{ \"unit\": \"%\", \"precision\": 3 }"],[711,65,"AxisYValue","{ \"precision\": 2 }"],[411,36,"Dataset","DSIMSSALES"],[412,36,"Title","GP YTD"],[170,19,"_AxisYFormat PivotCol1","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\"}"],[171,19,"AxisYFormat QLMarketPtc","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[172,19,"AxisYFormat QLPresPtc","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[549,52,"AxisYFormat QLMarketPtc","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[604,57,"ShowCategoryAxis","<all>"],[605,57,"LabelRotation","45"],[606,57,"Title","Market share evolution per month"],[607,57,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[251,25,"ShowHeader","0"],[96,7,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[53,7,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[54,7,"PivotIndicators","MarketSharePtc,sum, MSPtc, PivotedMS "],[377,34,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\"}"],[585,55,"ColumnOrder","CustomerLastName;CustomerFirstName;SpecialtyName"],[586,55,"Title","All Doctors"],[587,56,"Dataset","DSCustomerNotSeen"],[588,56,"ColumnTitle","\"Last Name\";\"First Name\";\"Specialty\";\""],[589,56,"ColumnResize","1"],[717,68,"ColumnFormat Col1","[{\r\n    \"type\": \"number\", \"options\": { \"precision\": 2 }\r\n}, {\r\n    \"type\": \"style\", \"data\": \" 'color:red' \"\r\n}, {\r\n    \"type\": \"style\", \"data\": \" 'font-style:italic' \"\r\n}, {\r\n    \"type\": \"icon\", \"data\": \" @Col1 < 5 ? 'minus-square ; red' :  'plus-square ; green' \", \"position\": \"left\"\r\n}, {\r\n    \"type\": \"css\", \"data\": \" @Col1 < 2 ? 'bg-blue' : 'bg-green' \"\r\n}, {\r\n    \"type\": \"image\", \"data\": \" @Col1 < 8 ? '16x16/arrow_down_red.png' : '16x16/arrow_up_green.png'  \"\r\n}]"],[590,56,"ColumnOrder","CustomerLastName;CustomerFirstName;SpecialtyName"],[591,56,"SelectionMode","singlerow"],[592,56,"Title","Doctors Not Seen"],[498,47,"_AxisYFormat PivotCol1","{ \"type\": \"column\", \"fillAlphas\": 0.5,  \"valueAxis\": \"AxeDefault\" }"],[512,48,"ColumnResize","11"],[499,47,"AxisYFormat QLMarket","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[542,50,"ColumnHierarchy Product Sales (Unit), grp2","@8; @9; @10; @11;"],[143,17,"SelectionMode","singlerow"],[144,17,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[145,17,"ColumnFormat QLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[697,65,"AlphaField","@7"],[698,65,"Tooltip","\"<b>@1 (@2)</b> <br /> @3, @4, @5\""],[699,65,"Tooltip STABLON","\"@1 @2 <br /> <b>@3 - @4 - @5</b>\""],[700,65,"BulletField","@8"],[701,65,"GuideX","{ \"value\": \"@9\", \"label\": \"Guide X value: [[value]]\", \"labelRotation\": 1 }"],[702,65,"GuideY","{ \"value\": \"@10\", \"label\": \"Guide Y value: [[value]]\" }"],[703,65,"AxisXPosition","top"],[704,65,"AxisYPosition","right"],[705,65,"MinBulletSize","20"],[706,65,"MaxBulletSize","150"],[707,66,"Dataset","Default"],[708,66,"ColumnExpression","SALES_FORMATTED =\n\t@2;"],[709,66,"ColumnFormat @3","[{\n\t\"type\": \"number\",\n\t\"data\": \"\",\n\t\"precision\": 2,\n\t\"thousand\": \" _t_ \",\n\t\"decimal\": \" _d_ \",\n\t\"plus\": \" _p_ \",\n\t\"minus\": \"_m_\"\n}]"],[646,59,"_AxisY","SalesUnit"],[364,33,"LabelRotation","45"],[383,34,"AxisXTitle","Date ID"],[550,52,"AxisYFormat QLPresPtc","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[267,26,"Dataset","DSCustomerSeen"],[268,26,"ColumnTitle","\"Last Name\";\"First Name\";\"Specialty\";\""],[269,26,"ColumnResize","1"],[270,26,"ColumnOrder","CustomerLastName;CustomerFirstName;SpecialtyName"],[271,26,"SelectionMode","singlerow"],[136,16,"Dataset","DSIMSSALES"],[137,17,"Dataset","DSIMSSALES"],[140,17,"ColumnTitle","Minibrick ; Minibrick Potential ; No of Target Drs (A) ; Drs Seen ; Coverage ; Freq ; Call % ; Sales ; Growth ; Market Share ; Sales %"],[168,19,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"%\"}]"],[390,34,"Title","Market Unit sales in mini-brick(s)"],[391,4,"RowSplitter","MonthChar; DateId; MarketUnitSales"],[392,35,"AxisX","ProductName"],[393,35,"AxisY","YTDSalesTO"],[394,35,"Legend","right"],[468,41,"Dataset","Default"],[632,59,"AxisYFormat _PIVOT1_INDICATOR1 ","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[503,47,"AxisYFormat QLProduct","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[554,52,"ShowCategoryAxis","<all>"],[555,52,"AxisYTitle","\"Minibrick Potential\"; \"Call %\";\"Sales %\""],[556,52,"_AxisY","[{ \"col\": \"QLMarket\", \"sortType\": \"desc\" }, { \"col\": \"QLPres\" }]"],[557,52,"AxisX","Minibrick"],[558,52,"Dataset","DSIMSSALES"],[559,52,"AxisXTitle","UGA"],[560,52,"_PivotY","Minibrick"],[561,52,"_PivotIndicators","MarketUnitSales,sum"],[562,52,"AxisYFormat QLProductPtc","{ \"type\": \"column\", \"fillAlphas\": 0.5, \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[563,53,"Dataset","DSIMSSALES"],[564,53,"ColumnTitle","\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\""],[527,49,"Dataset","DSIMSSALES"],[528,50,"ColumnFormat Coverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[576,54,"ColumnTitle","\"Last Name\";\"First Name\";\"Specialty\";\""],[578,54,"ColumnOrder","CustomerLastName;CustomerFirstName;SpecialtyName"],[579,54,"SelectionMode","singlerow"],[580,54,"Title","Doctors Seen"],[581,55,"SelectionMode","singlerow"],[582,55,"Dataset","DSCustomerTotal"],[583,55,"ColumnTitle","\"Last Name\";\"First Name\";\"Specialty\";\""],[397,35,"Tooltip","[[title]]:<br><b style=\"font-size:1.4em\">[[percents]]%</b>"],[398,35,"AxisYTitle",""],[399,35,"PivotIndicators","YTDSalesTO, sum"],[640,59,"ShowCategoryAxis","<all>"],[362,1,"ColumnOrder","BrickName ; SalesUnit ; SalesUnitPY ; MarketSalesUnit ; Sales ; SalesPY ; SalesPYBis \r\n"],[400,35,"Dataset","DSIMSSALES"],[493,45,"ColumnFormat Coverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[370,33,"AxisY","SalesUnit"],[371,33,"PivotY","[{ \"col\": \"BrickName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[372,33,"PivotIndicators","SalesUnit,sum"],[373,33,"Legend","right"],[374,33,"Title","Monthly Unit sales in mini-brick(s)"],[716,68,"Dataset","Default"],[570,53,"ColumnFormat TotalQLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[538,50,"ColumnFormat QLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[602,57,"Tooltip","\"@ProductName </br> <b>@PivotedMS</b> %\""],[281,28,"SelectionMode","singlerow"],[380,34,"AxisYTitle","Sales"],[501,47,"LabelRotation","45"],[482,45,"ColumnHierarchy \"Product Sales (Unit)\", grp2","@7; @8; @9; @10; @11;"],[460,40,"AxisY","SalesUnit;MarketShare"],[461,40,"AxisYFormat SalesUnit","{ \"type\": \"column\", \"lineColor\": \"#0094ff\", \"lineAlpha\": 0.3, \"fillAlphas\": 0.7, \"valueAxis\": \"VA1\", \"bi\": { \"unit\": \"units\" } }"],[387,34,"Legend","right"],[388,34,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[539,50,"TableWidthInPercentage","100"],[540,50,"ColumnWidth","130px; 120px; 120px; 70px; 70px; 70px; 70px; 70px; 70px; 100px; auto"],[541,50,"ColumnHierarchy Doctors, grp1","@3; @4; @5; @6;@7"],[90,9,"Title","Minibrick unit sales & Market share"],[518,48,"ColumnWidth","130px; 120px; 120px; 70px; 70px; 70px; 70px; 70px; 70px; 100px; auto"],[439,38,"Title","Monthly Unit sales in territory"],[608,57,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[356,14,"Zoom","0"],[277,28,"Dataset","DSCustomerNotSeen"],[337,32,"LegendText","[[title]]"],[378,34,"LabelRotation","45"],[642,59,"AxisYTitle","Sales"],[643,59,"Dataset","DSIMSSALES"],[644,59,"AxisX","MonthChar"],[645,59,"AxisXTitle","Date ID"],[282,26,"Title","Doctors Seen"],[283,28,"Title","Doctors Not Seen"],[284,27,"Title","All Doctors"],[300,17,"TableWidthInPercentage","100"],[301,17,"ColumnWidth","130px; 120px; 120px; 70px; 70px; 70px; 70px; 70px; 70px; 100px; auto"],[302,25,"ColumnWidth","130px; 120px; 120px; 70px; 70px; 70px; 70px; 70px; 70px; 100px; auto"],[487,45,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[488,45,"ColumnFormat QLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[489,45,"ColumnResize","11"],[490,45,"ColumnFormat QLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[491,45,"ColumnFormat Growth","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[492,45,"ColumnFormat QLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[682,63,"OutputId","64; 65"],[683,63,"Dataset","Default"],[684,64,"Dataset","Default"],[685,65,"Dataset","Default"],[686,65,"AxisX","@3"],[544,50,"ColumnFormat QLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[173,19,"LabelRotation","45"],[174,19,"AxisY","QLMarketPtc; QLPresPtc;QLProductPtc"],[276,27,"SelectionMode","singlerow"],[672,62,"AxisYFormat NbSeen","{ \n\t\"type\": \"column\", \n\t\"lineColor\": \"#A5D6A7\",\n\t\"lineAlpha\": 0.3, \n\t\"fillAlphas\": 0.99, \n\t\"valueAxis\": \"VA3\"\n}"],[673,62,"AxisYFormat NbUnSeen","{ \n\t\"type\": \"column\", \n\t\"lineColor\": \"#FF8A80\",\n\t\"lineAlpha\": 0.3, \n\t\"fillAlphas\": 0.99, \n\t\"valueAxis\": \"VA3\"\n}"],[674,62,"Tooltip NbSeen","\" <b>Doctors seen:</b> @Nbseen <br> Target: @TargetName <br> Product: @ProductName\""],[675,62,"Tooltip NbUnseen","\"<b>Doctors unseen:</b> @NbUnseen <br> Target: @TargetName <br> Product: @ProductName\""],[676,62,"ShowCategoryAxis","<first>"],[677,62,"LabelRotation","10"],[678,62,"Legend","right"],[679,62,"Title","Coverage"],[680,62,"Zoom","1"],[681,60,"RowSplitterLimit","13;24"],[74,11,"OutputId","9;12"],[618,58,"Legend","right"],[619,58,"Title","MARKET UNIT SALES IN TERRITORY"],[620,58,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[566,53,"ColumnOrder","TerritoryName;TotalQLMarket;TotalMedPOA;TotalMedVus;;TotalFrequency;TotalQLPres;TotalSalesTerr;;;TotalQLProduct"],[567,53,"SelectionMode","singlerow"],[568,53,"ColumnFormat MarketShare","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[569,53,"ColumnFormat TotalQLMarket","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[553,52,"ColumnExpression","QLPresPtc =\n\tMath.round(1000 * (parseFloat('@QLPres') || 0)) / 10;\n\nQLMarketPtc =\n\tMath.round(1000 * (parseFloat('@QLMarket') || 0)) / 10;\n\nQLProductPtc =\n\tMath.round(1000 * (parseFloat('@QLProduct') || 0)) / 10;"],[438,38,"AxisY","SalesUnit"],[533,50,"ColumnResize","1"],[534,50,"ColumnOrder","Minibrick;QLMarket;No of Target Drs (A);No of Target Drs Seen;Coverage;Frequency;QLPres;UnitSales;Growth;MarketShare;QLProduct"],[369,33,"AxisXTitle","Date ID"],[529,50,"ColumnFormat Frequency","[{\n\t\"type\": \"number\",\n\t\"options\": {\n\t\t\"precision\": 1\n\t}\n}]"],[481,45,"ColumnHierarchy \"Doctors\", grp1","@3; @4; @5; @6;"],[584,55,"ColumnResize","1"],[641,59,"Legend","right"],[306,29,"LegendValue","[[percents]]%"],[123,5,"LabelRotation","45"],[79,12,"SelectionMode","singlerow"],[635,59,"ColumnExpression","MarketShare =\n\t'@MarketSales' / '@MarketSalesUnit';\n\nMarketSharePtc =\n\tMath.round(1000 * @MarketShare) / 10;"],[603,57,"AxisYFormat PivotCol1","{ \"type\": \"line\", \"lineAlpha\": 1, \"lineThickness\": 3, \"fillAlphas\": 0.1, \"bullet\": \"triangleUp\", \"valueAxis\": \"AxeDefault\", \"bi\": { \"unit\": \"%\", \"format\": \"percent\", \"precision\": 2 } }"],[571,53,"ColumnFormat Growth","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[572,53,"ColumnFormat TotalQLProduct","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[82,12,"ColumnResize","3"],[83,12,"ColumnOrder","BrickName;MarketShare;SalesUnitN"],[84,2,"Title","Monthly Unit sales in mini-brick(s)"],[141,17,"ColumnResize","1"],[142,17,"ColumnOrder","Minibrick;QLMarket;No of Target Drs (A);No of Target Drs Seen;Coverage;Frequency;QLPres;UnitSales;Growth;MarketShare;QLProduct"],[522,48,"ColumnFormat TotalCoverage","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[600,57,"Zoom","0"],[523,48,"ColumnFormat QLTarget","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[715,67,"ColumnFormat STACK2","[{\n\t\"type\": \"stackedChart\",\n\t\"data\": \"\",\n\t\"separator\": \"#\"\n}]"],[445,39,"Zoom","0"],[381,34,"Dataset","DSIMSSALES"],[647,59,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market share (%)\" }]"],[648,59,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[649,59,"PivotIndicators","MarketSharePtc,sum, MSPtc, PivotedMS "],[650,60,"Dataset","DSIMSSALES"],[651,60,"AxisX","MonthChar"],[652,60,"AxisXTitle","Date ID"],[446,39,"Tooltip","\"@ProductName </br> <b>PivotedMS</b> %\"\n"],[447,39,"ColumnExpression","MarketSharePtc =\n\tMath.round(1000 * @MarketShare) / 10;"],[448,39,"AxisYTitle","Sales"],[449,39,"Dataset","DSIMSSALES"],[450,39,"AxisX","MonthChar"],[451,39,"PivotY","[{ \"col\": \"ProductName\", \"sortType\": \"asc\", \"sortKey\": \"srt\" }]"],[688,65,"Series","@1"],[692,65,"AxisXTitle","X Axis"],[693,65,"AxisYTitle","Y Axis"],[694,65,"Legend","right"],[67,9,"AxisYFormat SalesUnitN","{ \"type\": \"column\", \"lineColor\": \"#0094ff\", \"lineAlpha\": 0.3, \"fillAlphas\": 0.7, \"valueAxis\": \"VA1\", \"bi\": { \"unit\": \"units\" } }"],[452,39,"Title",""],[129,4,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[69,9,"LabelRotation","45"],[71,9,"AxisYTitle","Sales; Market share"],[73,10,"Dataset","Default"],[633,59,"RowSplitter","MonthChar; DateId; MarketSales; MarketSalesUnit;"],[634,59,"Zoom","0"],[379,34,"ValueAxes","[ { \"id\": \"AxeDefault\", \"color\": \"#000000\", \"axisColor\": \"#000000\", \"axisAlpha\": 1, \"gridAlpha\": 0, \"position\": \"left\", \"offset\": 0, \"title\": \"Market Sales\" }]"],[386,34,"PivotIndicators","MarketUnitSales,sum"],[146,17,"ColumnFormat QLPres","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[712,67,"Dataset","Default"],[338,32,"Tooltip","[[title]]:<br><b style=\"font-size:1.4em\">[[percents]]%</b>"],[513,48,"ColumnOrder","TerritoryName;TotalQLMarket;TotalMedPOA;TotalMedVus;TotalCoverage;TotalFrequency;TotalQLPres;TotalSalesTerr;TotalGrowth;TotalMS;TotalQLProduct"],[462,40,"LabelRotation","45"],[520,48,"ColumnFormat TotalMS","[{\n\t\"type\": \"percentage\",\n\t\"data\": 1,\n\t\"precision\": 2\n}]"],[463,40,"AxisYTitle","Sales; Market share"],[365,33,"AxisYFormat PivotColDefault","{ \"type\": \"line\", \"lineAlpha\": 1, \"fillAlphas\": 0, \"bullet\": \"square\", \"valueAxis\": \"AxeDefault\"}"],[343,9,"ShowCategoryAxis","<all>"],[344,19,"ShowCategoryAxis","<all>"],[345,7,"ShowCategoryAxis","<all>"],[346,14,"ShowCategoryAxis","<all>"],[665,61,"Dataset","Default"],[666,62,"Dataset","Default"],[667,62,"AxisX","Segmentation"],[668,62,"AxisY","NbSeen;NbUnseen"],[669,62,"ColumnExpression","NbUnSeen =\n\t'@NbDoctors - @NbSeen';\n\nSegmentation =\n\t'@ProductName @TargetName';"],[670,62,"AxisYTitle"," Seen ; Not seen"],[91,12,"Title","minibrick unit sales & market share"],[687,65,"AxisY","@4"],[458,5,"ColumnExpression_","MarketShare =\n\tfn.rowSplitterIndex('@SalesUnit', @IndexCol) / fn.rowSplitterIndex('@MarketSalesUnit', @IndexCol);"]]},{"columns":["ID","ContainerId","OutputId","AnalysisId"],"data":[[10,47,2,2],[18,49,4,4],[12,53,5,5],[17,55,15,5],[15,59,7,7],[16,57,14,7],[9,51,11,9],[19,21,17,10],[20,23,19,10],[22,28,26,10],[31,43,26,10],[25,32,27,10],[30,42,27,10],[24,31,28,10],[32,45,28,10],[21,27,25,12],[26,33,29,13],[28,41,31,15],[29,37,32,16],[33,67,60,27],[34,70,62,28],[35,71,65,29],[36,72,66,30],[37,73,67,31],[38,74,68,32]]},{"columns":["ID","OUTPUTINSTANCEID","OutputId","NAME","VALUE"],"data":[[41,21,25,"ColumnFormat TotalMedPOA","[{\r\n\t\"type\": \"dashboardFilter\",\r\n\t\"title\": \"See list\",\r\n\t\"dashboardId\": 6,\r\n\t\"data\": \" '23§20' \"\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[47,12,5,"Title","MARKET UNIT SALES IN TERRITORY- PRODUCT : {FID:1:Caption}  "],[48,33,60,"Title","Market unit sales in territory - Product : {FID:32:Caption}"],[49,33,60,"RowSplitterLimit","13;24"],[50,34,62,"Title","Coverage (MAT)"],[51,19,17,"ExportToCsv","{\r\n\"str\": \"\\\"\",\r\n\"col\": \";\",\r\n\"row\": \"\\r\\n\",\r\n\"titles\": [\"Minibrick\", \"QLMarket\", \"No of Target Drs (A)\", \"No of Target Drs Seen\", \"Coverage\", \"Frequency\", \"QLPres\", \"UnitSales\", \"Growth\", \"MarketShare\", \"QLProduct\"],\r\n\"includeCols\": [\r\n\t\"Minibrick\", \"QLMarket\", \"No of Target Drs (A)\", \"No of Target Drs Seen\", \"Coverage\", \"Frequency\", \"QLPres\", \"UnitSales\", \"Growth\", \"MarketShare\", \"QLProduct\"\r\n ],\r\n \"filename\": \"TableExport\"\r\n}"],[1,10,2,"Title","Monthly Unit sales in mini-brick(s) - Product : {FID:4:Caption}"],[6,15,7,"Title","Market share evolution per month - Product : {FID:1:Caption}  "],[7,9,9,"Title","Minibrick unit sales & Market share ({YEAR_LAST_SALES_MONTH} {MONTH_LAST_SALES_MONTH}) - Product : {FID:4:Caption}"],[8,9,12,"Title","Minibrick unit sales & market share ({YEAR_LAST_SALES_MONTH} {MONTH_LAST_SALES_MONTH}) - Product : {FID:4:Caption}"],[9,16,14,"Title","MARKET UNIT SALES IN TERRITORY- PRODUCT : {FID:1:Caption}  "],[10,17,15,"Title","PRODUCT MARKET SHARE EVOLUTION - PRODUCT : {FID:1:Caption}  "],[11,18,4,"Title","Market Unit sales in mini-brick(s) - Product : {FID:4:Caption}"],[12,19,17,"ColumnFormat No of Target Drs Seen","[{\n\t\"type\": \"dashboardFilter\",\n\t\"title\": \"See list\",\n\t\"dashboardId\": 4,\n\t\"data\": \" '20§[[[@BrickID]]]¤14§17¤12§18' \"\n}]"],[13,19,17,"ColumnFormat No of Target Drs (A)","[{\n\t\"type\": \"dashboardFilter\",\n\t\"title\": \"See list\",\n\t\"dashboardId\": 5,\n\t\"data\": \" '21§[[[@BrickID]]]¤22§17' \"\n}]"],[14,25,27,"Title","All Doctors ({OUTPUT_NUM_ROWS})-  Mini-brick : {FID:21:Caption} "],[15,22,26,"Title","Doctors Seen ({OUTPUT_NUM_ROWS}) -  Product : {FID:14:Caption} - Mini-Brick : {FID:20:Caption} -  Period : {FID:12:Caption} "],[16,24,28,"Title","Doctors Not Seen ({OUTPUT_NUM_ROWS}) - Mini-Brick : {FID:20:Caption} "],[17,19,17,"Title","{YEAR_LAST_SALES_MONTH} {MONTH_LAST_SALES_MONTH}: Sales & Activity {FID:17:Caption} {FID:16:Caption}"],[20,28,31,"Title","{FID:19:Caption}  YTD ({YEAR_LAST_SALES_MONTH} {MONTH_LAST_SALES_MONTH})"],[21,29,32,"Title","{FID:18:Caption}  YTD ({YEAR_LAST_SALES_MONTH} {MONTH_LAST_SALES_MONTH})"],[22,26,29,"Title","National YTD ({YEAR_LAST_SALES_MONTH} {MONTH_LAST_SALES_MONTH})"],[24,21,25,"ColumnFormat TotalMedVus","[{\r\n\t\"type\": \"dashboardFilter\",\r\n\t\"title\": \"See list\",\r\n\t\"dashboardId\": 7,\r\n\t\"data\": \" '25§19¤24§20' \"\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[25,30,27,"Title","All Doctors ({OUTPUT_NUM_ROWS})"],[26,31,26,"Title","Doctors Seen ({OUTPUT_NUM_ROWS})"],[27,32,28,"Title","Doctors Not Seen ({OUTPUT_NUM_ROWS})"],[31,29,32,"ColumnExpression","YTDSalesTOO =\n\tfn.rowSplitterIndex('@YTDSalesTO', 24);"],[32,29,32,"AxisY","YTDSalesTOO"],[33,29,32,"PivotIndicators","YTDSalesTOO, sum"],[34,21,25,"ColumnFormat TotalMS","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[35,21,25,"ColumnFormat TotalFrequency","[{\r\n\t\"type\": \"number\",\r\n\t\"options\": {\r\n\t\t\"precision\": 2\r\n\t}\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[36,21,25,"ColumnFormat TotalGrowth","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[37,21,25,"ColumnFormat TotalCoverage","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[38,21,25,"ColumnFormat TotalQLProduct","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[39,21,25,"ColumnFormat TotalQLPres","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[40,21,25,"ColumnFormat TotalQLMarket","[{\r\n\t\"type\": \"percentage\",\r\n\t\"data\": 1,\r\n\t\"precision\": 2\r\n}, {\r\n\t\"type\": \"css\",\r\n\t\"data\": \" '@TypTerr' == '@National' ? 'bg-red' : '' \"\r\n}]"],[46,12,5,"Zoom","1"]]},{"columns":["ID","AnalysisId","NAME"],"data":[[10,2,"Brick"],[2,4,"Brick"],[4,4,"Product"],[6,5,"Product"],[11,5,"Territory"],[12,7,"Product"],[13,7,"Territory"],[16,9,"Product"],[21,10,"Brick"],[18,10,"Period"],[17,10,"Product"],[22,10,"TableTitle"],[23,10,"Territory"],[19,12,"Period"],[20,12,"Product"],[24,17,"Brick"],[25,17,"Product"],[26,18,"Brick"],[27,18,"Product"],[28,22,"Product"],[29,22,"Territory"],[30,23,"Product"],[31,24,"Period"],[32,24,"Product"],[33,25,"Brick"],[34,25,"Period"],[35,25,"Product"],[36,25,"TableTitle"],[37,25,"Territory"],[38,26,"Product"],[39,26,"Territory"],[40,27,"Product"],[41,27,"Territory"],[42,28,"Period"],[3,2,"Product"]]},{"columns":["ID","ParameterId","QueryId","SYNTAX","SuffixExample"],"data":[[8,2,5,"and brickid ","=636"],[9,4,5,"and HP.ProductId","= 346"],[15,3,3,"and P.ProductId","=37"],[16,10,3,"and BrickId ","=637"],[17,6,6,"and P.ProductId","=37"],[18,11,6,"and TerritoryId","=6276"],[20,13,8,"and TerritoryId","=6276"],[23,16,10,"and P.ProductId","= 346"],[24,12,8,"and HP.productId","=346"],[25,17,11,"and FsB.ProductId","=346"],[26,18,11,"",""],[27,17,11," and E.ProductId","=346"],[28,19,12,"","YTD"],[29,20,12,"and FsT.ProductId","=346"],[30,20,12," and E.ProductId","=346"],[31,21,13,"And POA.BrickId","=637"],[32,21,14,"and POA.BrickID","=637"],[33,17,13,"and E.ProductId","=265"],[34,18,13,"","QTR"],[35,21,15," AND POA.BrickId","=637"],[36,18,15,"","QTR"],[37,17,15,"AND E.ProductId","=346"],[38,22,15,"","TITLE"],[39,23,11," and FsT.TerritoryId","=7458"],[40,20,12," and ProductId","=346"],[41,17,11," and ProductId","=346"],[42,17,15," and ProductId","=346"],[43,17,14," and ProductId","=346"],[44,24,20,"and BrickId ","=637"],[45,25,20,"and P.ProductId","=37"],[46,26,21,"and brickid ","=636"],[47,27,21,"and HP.ProductId","= 346"],[48,28,25,"and P.ProductId","=37"],[49,29,25,"and TerritoryId","=6276"],[50,30,26,"and P.ProductId","= 346"],[51,31,27,"","YTD"],[52,32,27,"and FsT.ProductId","=346"],[53,32,27," and E.ProductId","=346"],[54,32,27," and ProductId","=346"],[55,33,29,"And POA.BrickId","=637"],[56,33,30,"and POA.BrickID","=637"],[57,33,28," AND POA.BrickId","=637"],[58,34,31,"",""],[59,34,29,"","QTR"],[60,34,28,"","QTR"],[61,35,31,"and FsB.ProductId","=346"],[62,35,31," and E.ProductId","=346"],[63,35,29,"and E.ProductId","=265"],[64,35,28,"AND E.ProductId","=346"],[65,35,31," and ProductId","=346"],[66,35,28," and ProductId","=346"],[67,35,30," and ProductId","=346"],[68,36,28,"","TITLE"],[69,37,31," and FsT.TerritoryId","=7458"],[70,38,32,"and HP.productId","=346"],[71,39,32,"and TerritoryId","=6276"],[72,12,8,"","=346"],[73,4,5,"","=346"],[74,40,33,"and HP.productId","=346"],[75,40,33,"","=346"],[76,41,33,"and TerritoryId","=6276"],[77,42,34,"",""]]},{"columns":["ID","FILTERID","OUTPUTID","ParameterId","Suffix"],"data":[[16,4,9,16,"= Filter~Value~~~"],[17,4,10,3,"= Filter~Value~~~"],[19,1,12,6,"= Filter~Value~~~"],[22,1,15,12,"= Filter~Value~~~"],[23,9,10,10,"in (Filter~Value~~,~)"],[25,1,16,12,"= Filter~Value~~~"],[26,1,17,6,"= Filter~Value~~~"],[27,4,18,4,"= Filter~Value~~~"],[28,9,18,2,"in (Filter~Value~~,~)"],[29,10,19,17,"= Filter~Value~~~"],[30,11,19,18,"Filter~Value~~~"],[31,10,20,17,"= Filter~Value~~~"],[32,11,20,18,"Filter~Value~~~"],[33,10,21,20,"= Filter~Value~~~"],[34,11,21,19,"Filter~Value~~~"],[37,14,22,17,"= Filter~Value~~~"],[39,12,22,18,"Filter~Value~~~"],[42,14,24,17,"= Filter~Value~~~"],[43,12,24,18,"Filter~Value~~~"],[45,16,19,22,"Filter~Caption~~~"],[46,19,19,23,"= Filter~Value~~~"],[47,19,20,23,"= Filter~Value~~~"],[48,20,22,21,"= Filter~Value~~~"],[49,20,24,21,"= Filter~Value~~~"],[50,21,25,21,"= Filter~Value~~~"],[51,22,25,17,"= Filter~Value~~~"],[52,23,30,17,"= Filter~Value~~~"],[53,24,31,17,"= Filter~Value~~~"],[54,24,32,17,"= Filter~Value~~~"],[55,25,31,18,"Filter~Value~~~"],[56,25,32,18,"Filter~Value~~~"],[57,32,33,40,"= Filter~Value~~~"]]}],"Message":[{"columns":["ID","ContainerId","Title","Subtitle","Intro","Link","Main","Image","Type","LinkBehaviour"],"data":[[1,64,null,null,"<b>{FID:31:Value} </b> ",null,null,null,"Info","Info"]]}]};

var _cache_db = {"results":{"olapIreland":{"select value from BIInfo where info ='Max sales date'":{"columns":["VALUE"],"data":[["20150801"]]},"select  value DateMonthName  from BIInfo where info='MONTH LAST SALES MONTH'\r\n\r\n\r\n":{"columns":["DATEMONTHNAME"],"data":[["August"]]},"select value DateYear  from BIINfo where info='YEAR LAST SALES MONTH'\r\n\r\n\r\n\r\n":{"columns":["DATEYEAR"],"data":[["2015"]]}," select P.ProductId as value,P.ProductName as caption FROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P\r\nwhere P.HomeProductFlag=1 AND P.VisHomeProductFlag=0\r\nOrder by P.ProductName ":{"columns":["VALUE","CAPTION"],"data":[[355,"ACERYCAL"],[364,"COVERDINE"],[265,"PROCORALAN"],[346,"VALDOXAN"]]},"select value,Caption\r\nfrom\r\n(select  'QTR' as value,'Srv. QTR' as caption,'1' as tri  \r\nUNION\r\nselect 'MQT' as value,'MQT' as caption, '2' as tri  \r\nUNION\r\nselect  'YTD' as value,'YTD' as caption,'3' as tri  \r\nUNION\r\nselect  'MAT' as value,'MAT' as caption, '4' as tri \r\nUNION\r\nselect  '' as value,'Month' as caption, '5' as tri  \r\n) t\r\norder by tri\r\n ":{"columns":["VALUE","CAPTION"],"data":[["QTR","Srv. QTR"],["MQT","MQT"],["YTD","YTD"],["MAT","MAT"],["","Month"]]},"SELECT  [RegionId] as value\r\n      ,[RegionName] as caption\r\n        FROM  (SELECT DimRegion.* FROM DimRegion inner join VisRegion on VisRegion.RegionId=DimRegion.RegionId and VisRegion.UserLogin='admin') DimRegion ":{"columns":["VALUE","CAPTION"],"data":[[7853,"Region East"]]},"select T.TerritoryId as value,T.TerritoryName as caption FROM (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') as T Order by T.TerritoryName ":{"columns":["VALUE","CAPTION"],"data":[[7886,"H3"]]},"SELECT \r\nCASE WHEN 'Srv. QTR' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='355' ":{"columns":["VALUE"],"data":[["102.7"]]},"SELECT \r\nCASE WHEN 'Srv. QTR' ='Srv. QTR' \r\nTHEN  ' - Sales/Target (%): '\r\n ELSE ' '\r\nEND\r\n as value ":{"columns":["VALUE"],"data":[[" - Sales/Target (%): "]]},"SELECT \r\nCASE WHEN 'Srv. QTR' ='MQT' \r\nTHEN  'Growth vs 3 previous month'\r\n ELSE \r\nCASE WHEN 'Srv. QTR' ='Month' \r\nTHEN  'Growth vs previous month'\r\nELSE 'Growth vs previous year'\r\nEND END\r\n as value\r\n ":{"columns":["VALUE"],"data":[["Growth vs previous year"]]},"Select DISTINCT \r\n'QTR'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.QTRmarketSalesUnit marketSalesUnitT ,\r\nfsB.QTRMarketSalesUnit marketSalesUnitB,\r\nFsb.QTRSalesUnit SalesUnitB  ,\r\nFsb.QTRSalesUnitPY,\r\nFsT.QTRSalesUnit SalesUnitT,\r\n  --Fsb.QTRSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.QTRmarketSalesUnitLastMonth<>0 and fsT.QTRmarketSalesUnitLastMonth is not null then (fsB.QTRMarketSalesUnitLastMonth /fsT.QTRmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 355\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 355\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 355 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","QTRSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["QTR","0061 1 DUN LAOIRE",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","4527;4541;9079;13759;4940;9016;13328;4832;9360;13573;4550;8732;12877;4491;8477;12995;4171;7748;12073;4369;8637;12776;4399;8311","120;131;270;427;154;290;444;190;318;499;155;319;478;139;298;448;153;310;482;174;345;521;187;340","0;0;0;0;0;0;0;0;0;0;0;0;120;131;270;427;154;290;444;190;318;499;155;319","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,682,0.08869039996585137],["QTR","0030 2 WATERFD CTY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","5571;4036;8108;11418;6027;9733;13867;4628;8883;12748;4530;8240;12662;3380;6981;10355;4493;7828;11750;3468;7339;10902;3958;7670","1100;216;388;555;1209;1538;1824;360;705;1047;361;483;811;110;254;370;107;233;327;107;219;324;124;231","0;0;0;0;0;0;0;0;0;0;0;0;1100;216;388;555;1209;1538;1824;360;705;1047;361;483","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,709,0.0818500021342895],["QTR","0033 1 K/KENNY CO",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2499;2081;4313;6429;2861;4634;7126;2332;4666;6972;2777;5182;7758;2144;4274;6462;2602;4691;6912;2414;4609;7112;2456;4880","35;42;84;130;34;80;125;36;97;142;44;94;154;50;102;172;59;103;154;49;124;166;65;113","0;0;0;0;0;0;0;0;0;0;0;0;35;42;84;130;34;80;125;36;97;142;44;94","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,635,0.05207666367866137],["QTR","0029 1 REST S TIPP",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2285;3634;5946;8170;2500;4508;6735;2348;4501;6704;2381;4433;6675;2276;4426;6595;2287;4122;6555;2054;4324;6479;2399;4457","119;141;261;387;131;256;377;129;240;361;128;247;369;124;253;391;151;257;395;139;256;390;127;254","0;0;0;0;0;0;0;0;0;0;0;0;119;141;261;387;131;256;377;129;240;361;128;247","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,691,0.047562641396679047],["QTR","0030 1 RST WATERFD",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2107;2089;4184;6289;2502;4358;6256;1989;4261;6511;2004;3813;6304;1861;3782;5720;2105;3700;6035;1752;3506;5561;1983;3986","45;63;113;171;64;120;192;59;124;194;80;131;192;82;144;209;83;146;216;61;140;200;93;160","0;0;0;0;0;0;0;0;0;0;0;0;45;63;113;171;64;120;192;59;124;194;80;131","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,641,0.04253638963589021],["QTR","0035 1 RST WEXFORD",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2526;2245;4555;7135;2558;4659;6771;2021;4201;6144;2118;4182;6540;2013;3920;6104;1836;3524;5666;1868;3828;5735;2062;3880","95;121;233;357;107;229;342;120;248;364;135;260;404;142;263;400;132;260;390;128;253;387;141;266","0;0;0;0;0;0;0;0;0;0;0;0;95;121;233;357;107;229;342;120;248;364;135;260","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,759,0.041405216203525844],["QTR","0032 1 RST WICKLOW",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1888;3898;5748;7382;1869;3614;5315;2009;3787;5613;1989;3754;5649;1986;3810;5670;1927;3759;5919;1848;3780;5979;2084;3849","95;149;272;446;144;278;427;166;317;486;134;284;459;133;281;425;162;292;444;167;305;470;149;291","0;0;0;0;0;0;0;0;0;0;0;0;95;149;272;446;144;278;427;166;317;486;134;284","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,746,0.04107440133179664],["QTR","0033 2 K/KENNY TWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1954;1783;3847;5787;2584;4293;6599;1915;4115;5885;2216;4108;5983;1878;3811;5718;1717;3345;5239;1795;3610;5400;2055;3772","36;42;91;145;47;94;134;45;75;135;54;99;149;56;108;156;55;128;190;72;147;226;69;129","0;0;0;0;0;0;0;0;0;0;0;0;36;42;91;145;47;94;134;45;75;135;54;99","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,638,0.04025269987621121],["QTR","0034 1 CARLOW COUNTY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1674;1810;3704;5370;1841;3194;5120;1641;3391;5034;1782;3718;5472;1739;3256;5130;1683;3354;5217;1539;3249;5065;1758;3564","47;66;136;199;55;106;163;59;130;181;55;114;223;65;129;195;59;136;205;49;109;164;52;106","0;0;0;0;0;0;0;0;0;0;0;0;47;66;136;199;55;106;163;59;130;181;55;114","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,665,0.03803303880138302],["QTR","0035 2 WEXFORD TWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1928;2079;4071;6059;1933;3572;5503;1857;3842;5527;1776;3484;5218;1862;3459;5237;1739;3287;5043;1674;3398;4979;1715;3398","143;116;242;370;126;237;366;129;259;389;145;283;415;166;299;450;150;293;444;157;321;457;146;294","0;0;0;0;0;0;0;0;0;0;0;0;143;116;242;370;126;237;366;129;259;389;145;283","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,713,0.03626157852051052],["QTR","0035 3 ENNISCORTHY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1416;1546;3151;4677;1745;3285;4855;1613;3352;4781;1704;3496;5019;1540;2911;4396;1529;2995;4417;1533;3054;4546;1607;3279","97;99;199;302;124;211;329;120;272;408;117;246;407;136;273;423;127;276;402;144;286;441;148;279","0;0;0;0;0;0;0;0;0;0;0;0;97;99;199;302;124;211;329;120;272;408;117;246","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,656,0.03499167627096939],["QTR","0032 4 BRAY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1617;1573;3524;5249;1856;3662;5413;1736;3591;5364;1709;3076;4754;1561;3111;4699;1610;3063;4673;1485;2985;4617;1591;3108","69;58;130;219;80;144;224;91;161;244;75;158;254;94;174;260;120;212;299;98;187;282;79;184","0;0;0;0;0;0;0;0;0;0;0;0;69;58;130;219;80;144;224;91;161;244;75;158","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,676,0.03316685875272122],["QTR","0034 2 CARLOW TOWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1822;1658;3606;5214;1724;3550;5129;1479;3211;4736;1557;3267;4746;1626;3206;4739;1272;2641;3990;1468;2864;4259;1507;2868","23;22;37;63;26;55;77;24;51;80;23;44;74;31;87;111;31;59;89;40;76;101;36;70","0;0;0;0;0;0;0;0;0;0;0;0;23;22;37;63;26;55;77;24;51;80;23;44","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,742,0.03060571135868869],["QTR","0031 2 PORTLAOISE",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1528;1512;2977;4310;1696;2936;4401;1493;2884;4441;1502;2914;4694;1520;2861;4343;1457;2780;4312;1475;2904;4253;1444;2847","23;23;49;74;28;53;85;30;67;95;31;59;89;31;61;92;31;68;98;30;55;81;27;53","0;0;0;0;0;0;0;0;0;0;0;0;23;23;49;74;28;53;85;30;67;95;31;59","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,664,0.030381610961710846],["QTR","0031 1 REST LAOIS",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1333;1459;2845;4213;1477;2624;4111;1484;2701;4140;1357;2756;4000;1348;2566;3928;1432;2433;3779;1347;2647;3998;1395;2846","45;41;88;133;40;86;140;48;91;139;39;95;142;49;93;140;55;103;152;49;96;137;59;111","0;0;0;0;0;0;0;0;0;0;0;0;45;41;88;133;40;86;140;48;91;139;39;95","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,688,0.03037093951423571],["QTR","0029 3 CLONMEL",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1540;1556;3189;4698;1709;3220;4704;1472;3061;4581;1773;3222;4622;1622;3054;4592;1412;2685;4205;1379;2793;4250;1497;2795","81;77;162;237;79;157;240;80;158;238;84;163;253;92;169;263;111;178;263;84;175;257;97;163","0;0;0;0;0;0;0;0;0;0;0;0;81;77;162;237;79;157;240;80;158;238;84;163","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,692,0.0298266956930038],["QTR","0060 1 BLACKROCK",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1479;1661;3252;4880;1618;3026;4695;1388;2990;4380;1577;2972;4517;1450;2860;4381;1373;2581;3951;1331;2746;4051;1352;2638","72;88;164;260;83;159;246;80;158;232;67;149;238;80;165;249;85;171;248;75;156;253;88;161","0;0;0;0;0;0;0;0;0;0;0;0;72;88;164;260;83;159;246;80;158;232;67;149","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,721,0.028151278439407523],["QTR","0035 5 GOREY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1017;1159;2349;3462;1091;2395;3546;1272;2540;3640;1307;2756;4055;1183;2207;3363;1291;2400;3705;1226;2440;3713;1383;2511","22;19;53;90;27;48;64;29;59;82;31;63;105;20;43;67;25;55;80;35;64;105;38;80","0;0;0;0;0;0;0;0;0;0;0;0;22;19;53;90;27;48;64;29;59;82;31;63","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,697,0.02679600461006531],["QTR","0070 3 DUNDRUM",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","642;632;1260;1952;888;1684;2566;970;1860;2747;1121;2043;2828;803;1450;2393;703;1290;1951;594;1231;1916;840;2500","26;22;55;76;37;52;81;27;52;76;22;48;80;33;55;103;104;178;296;72;164;259;111;181","0;0;0;0;0;0;0;0;0;0;0;0;26;22;55;76;37;52;81;27;52;76;22;48","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,660,0.02667861868783882],["QTR","0068 1 DUBLIN 4",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1355;1409;2786;4230;1391;2674;3936;1371;2785;4144;1499;2582;3995;1303;2516;3922;1249;2454;3683;1264;2451;3731;1244;2429","95;74;149;253;87;159;245;79;159;240;82;155;254;86;167;261;62;137;194;73;140;224;73;144","0;0;0;0;0;0;0;0;0;0;0;0;95;74;149;253;87;159;245;79;159;240;82;155","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,666,0.025920945917104195],["QTR","0032 5 GREYSTONES",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1216;1312;2505;3832;1246;2341;3663;1193;2493;3737;1244;2229;3267;1025;1969;3073;986;1928;3018;1060;2090;3134;1093;2207","37;28;72;119;42;94;130;46;109;144;50;89;128;31;67;122;51;89;159;48;98;150;52;112","0;0;0;0;0;0;0;0;0;0;0;0;37;28;72;119;42;94;130;46;109;144;50;89","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,699,0.023551884577624107],["QTR","0032 3 ARKLOW",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","971;1041;2033;3072;979;1918;2944;1041;2098;3059;1064;2078;3094;1067;2056;3214;985;1945;3058;1127;2192;3210;1128;2197","61;53;102;165;57;100;146;53;107;155;61;109;153;66;129;206;57;114;182;70;136;215;68;145","0;0;0;0;0;0;0;0;0;0;0;0;61;53;102;165;57;100;146;53;107;155;61;109","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,640,0.023445170102872753],["QTR","0018 1 DUBLIN 2",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1045;1147;2119;3241;982;1955;2912;989;2103;3139;945;1912;3021;969;1794;2925;1437;2512;3588;1039;2034;3022;1158;2104","54;50;102;157;46;88;135;51;86;140;50;109;158;58;118;191;54;115;172;58;114;175;68;128","0;0;0;0;0;0;0;0;0;0;0;0;54;50;102;157;46;88;135;51;86;140;50;109","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,662,0.02245272548768515],["QTR","0035 4 NEW ROSS",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1071;1236;2449;3704;1341;2262;3372;1293;2422;3576;1208;2225;3551;1040;2043;3195;1090;1958;3092;923;1973;2937;899;1914","41;48;89;126;38;76;108;42;81;124;44;86;131;52;92;131;45;89;132;46;104;161;58;130","0;0;0;0;0;0;0;0;0;0;0;0;41;48;89;126;38;76;108;42;81;124;44;86","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,690,0.0204251504674094],["QTR","0032 2 WICKLOW TWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","908;845;1734;2422;1099;1771;2535;823;1666;2547;843;1610;2433;711;1546;2391;877;1730;2639;827;1718;2609;896;1725","25;30;59;86;30;67;108;49;103;148;60;114;168;52;92;125;41;87;127;36;80;125;44;86","0;0;0;0;0;0;0;0;0;0;0;0;25;30;59;86;30;67;108;49;103;148;60;114","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,647,0.018408246894608783],["QTR","0030 3 DUNGARVAN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","891;967;1913;2801;834;1553;2364;1081;1800;2584;752;1854;2859;878;1760;2657;745;1554;2370;799;1606;2499;862;1715","24;24;48;78;26;44;74;26;46;76;23;54;78;24;43;74;25;49;74;21;50;74;31;49","0;0;0;0;0;0;0;0;0;0;0;0;24;24;48;78;26;44;74;26;46;76;23;54","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,730,0.01830153241985743],["QTR","0060 2 STILLORGAN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","857;878;1718;2737;1058;1751;2701;844;1748;2573;896;1660;2563;812;1590;2471;697;1407;2273;790;1667;2508;887;1580","25;32;50;83;41;67;117;17;43;79;27;55;81;35;62;95;32;69;98;41;84;116;36;83","0;0;0;0;0;0;0;0;0;0;0;0;25;32;50;83;41;67;117;17;43;79;27;55","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,702,0.016860887010714132],["QTR","0029 2 TIPP TOWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","640;730;1423;2178;745;1288;1947;697;1393;2031;670;1412;2092;677;1277;1984;618;1213;1910;673;1355;2054;700;1334","40;36;72;109;37;66;103;40;77;108;41;85;119;32;69;122;52;82;125;36;81;120;44;79","0;0;0;0;0;0;0;0;0;0;0;0;40;36;72;109;37;66;103;40;77;108;41;85","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,745,0.014235710931830793],["QTR","0031 3 PTARLINGTON",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","738;643;1406;2265;786;1465;2330;650;1626;2311;681;1375;2287;750;1237;2078;722;1485;2352;971;1538;2195;688;1334","20;14;29;45;20;29;40;13;25;33;16;32;46;16;31;49;12;24;47;13;32;46;11;26","0;0;0;0;0;0;0;0;0;0;0;0;20;14;29;45;20;29;40;13;25;33;16;32","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,626,0.014235710931830793],["QTR","0070 1 REST DUB 14",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","718;607;1263;1988;678;1387;2037;701;1377;1935;665;1304;1991;524;1104;1681;607;1150;1780;633;1281;1859;595;1173","27;30;65;96;38;76;116;30;73;102;41;70;105;31;72;95;38;64;88;33;67;95;30;56","0;0;0;0;0;0;0;0;0;0;0;0;27;30;65;96;38;76;116;30;73;102;41;70","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,701,0.012517607888333972],["QTR","0029 4 CASHEL",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","572;374;709;1089;405;744;1087;395;775;1229;411;756;1139;377;764;1169;389;726;1104;400;791;1162;447;837","16;8;23;37;8;20;35;16;39;70;31;55;78;20;44;67;34;52;81;19;43;62;22;45","0;0;0;0;0;0;0;0;0;0;0;0;16;8;23;37;8;20;35;16;39;70;31;55","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,743,0.008932001536688435]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'QTR' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 355\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 355 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'QTR' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 355\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","QTR",null,null,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549","50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708",null],["National","QTR",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;10558;9973;20065;30700;11523;21594;33498;11050;22376;33586;11418;22492","10558;9973;20065;30700;11523;21594;33498;11050;22376;33586;11418;22492;34196;11773;22838;35139;11890;22812;34464;11931;23476;35275;11912;23570","214544;218846;437860;652380;228334;425226;641061;212070;435685;644877;221236;424953;656578;207148;405705;618617;208930;394276;609736;200830;404920;610942;215974;418986",null]]},"SELECT DISTINCT FsN.YTDSalesTO,P.ProductNAme\r\nFROM (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsN\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsN.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 --and FsN.dateId=20150801\r\nOrder by P.ProductNAme ":{"columns":["YTDSALESTO","PRODUCTNAME"],"data":[["240531;221977;450715;689193;948164;1174328;1440529;1688442;1941223;2192186;2447840;2695256;2956778;265092;514153;790178;1056599;1300862;1561336;1828145;2086759;2351064;2617184;2877762","ACERYCAL"],["0;0;0;0;0;0;0;0;0;0;0;0;0;2072;4005;8368;13900;21527;31771;41853;53810;65531;79336;92244","COVERDINE"],["260459;257532;512464;765884;1015964;1241159;1487339;1723397;1967233;2200942;2433532;2651162;2874555;227777;414906;626234;768384;907948;1058033;1203747;1350622;1502237;1657432;1801300","COVERSYL ARGI PLUS"],["597363;543694;1064911;1570021;2052229;2487926;2966129;3394430;3848838;4268271;4683277;5056371;5435643;419578;704002;994797;1112232;1228528;1348472;1465349;1581346;1698798;1824172;1941527","COVERSYL ARGININE"],["166264;167147;346196;534037;723103;898338;1143696;1327263;1524075;1708219;1901276;2081549;2264464;189368;365949;563815;744263;902207;1083073;1257781;1428734;1609531;1798187;1978269","PROCORALAN"],["261611;248898;517719;764861;1041145;1277008;1593586;1835948;2083793;2320184;2573429;2794196;3040769;240341;472083;727521;965049;1196877;1437689;1673069;1894884;2129171;2370782;2592026","VALDOXAN"]]},"SELECT DISTINCT FsR.YTDSalesTO, P.ProductNAme\r\nFROM (SELECT FactSalesRegion.* FROM FactSalesRegion inner join VisRegion on VisRegion.RegionId=FactSalesRegion.RegionId and VisRegion.UserLogin='admin') FsR\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsR.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1\r\nOrder by P.ProductNAme ":{"columns":["YTDSALESTO","PRODUCTNAME"],"data":[["111753;94019;190916;292990;415053;512993;642925;752437;862063;973493;1086947;1190070;1306427;112299;219815;336114;450629;555194;665648;780307;893125;1007158;1122849;1236034","ACERYCAL"],["0;0;0;0;0;0;0;0;0;0;0;0;0;1022;1800;3823;5859;8942;13363;17788;23368;28822;34788;41005","COVERDINE"],["123863;119239;235202;350881;468710;573722;694810;806919;920451;1030857;1139990;1240964;1346555;104960;196478;297512;366415;432162;505704;575398;646584;720412;794565;864866","COVERSYL ARGI PLUS"],["303608;268998;526490;764786;1009668;1224872;1474544;1687062;1910604;2118118;2322020;2501983;2691806;197519;339285;487850;546426;605677;666451;726287;784727;843992;907576;966997","COVERSYL ARGININE"],["103331;97592;202801;311877;426525;530976;699457;806491;916630;1022193;1131333;1233549;1338292;106503;208261;326019;426950;516858;621075;720425;818715;923335;1033350;1136615","PROCORALAN"],["133335;125703;260135;378680;522283;642497;825646;940420;1056902;1179095;1306507;1409474;1524070;113280;218136;335410;442501;542264;654046;763465;866557;979135;1091492;1195554","VALDOXAN"]]},"SELECT FsT.YTDSalesTO,P.ProductName\r\nFROM (SELECT VW_FactSalesTerritory.* FROM VW_FactSalesTerritory inner join DimTerritory as T on T.TerritoryId=VW_FactSalesTerritory.TerritoryId\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FsT\r\nINNER JOIN VW_ALLProduct P\r\nON P.ProductId=FsT.ProductId\r\nWHERE P.HOMEPRODUCTFlag=1 --and Fst.dateid=20150801 \r\nOrder by P.ProductNAme ":{"columns":["YTDSALESTO","PRODUCTNAME"],"data":[["63279;43833;87559;135006;204216;249384;297657;348898;398926;449780;501433;547046;601366;48007;95639;145148;196571;244069;293910;343750;394756;445626;498428;547172","ACERYCAL"],["0;0;0;0;0;0;0;0;0;0;0;0;0;587;1055;2357;3931;6183;8901;11406;15002;18052;21540;25581","COVERDINE"],["59940;56156;111919;168676;227474;277194;332440;388563;443460;496018;550237;598864;649663;48235;92609;139615;172851;204385;239767;272975;306785;341978;377032;410386","COVERSYL ARGI PLUS"],["142887;123751;240657;345701;453845;549239;651042;744904;847935;941394;1032469;1111647;1196463;81873;146207;213276;240430;267825;294901;321374;347008;373033;402290;430162","COVERSYL ARGININE"],["52193;43045;86679;132774;183793;230182;278091;323365;371866;416263;463470;507865;550267;45686;88445;131961;174128;210376;253541;296297;336765;376060;420515;462445","PROCORALAN"],["69111;59121;125086;189515;259560;322103;387848;448636;511180;571269;635040;689420;749285;56751;110386;170121;223887;276029;333522;389262;443946;503593;562580;617312","VALDOXAN"]]},"SELECT \r\nCASE WHEN 'MQT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='355' ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'MQT' ='Srv. QTR' \r\nTHEN  ' - Sales/Target (%): '\r\n ELSE ' '\r\nEND\r\n as value ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'MQT' ='MQT' \r\nTHEN  'Growth vs 3 previous month'\r\n ELSE \r\nCASE WHEN 'MQT' ='Month' \r\nTHEN  'Growth vs previous month'\r\nELSE 'Growth vs previous year'\r\nEND END\r\n as value\r\n ":{"columns":["VALUE"],"data":[["Growth vs 3 previous month"]]},"Select DISTINCT \r\n'MQT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MQTmarketSalesUnit marketSalesUnitT ,\r\nfsB.MQTMarketSalesUnit marketSalesUnitB,\r\nFsb.MQTSalesUnit SalesUnitB  ,\r\nFsb.MQTSalesUnitPY,\r\nFsT.MQTSalesUnit SalesUnitT,\r\n  --Fsb.MQTSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MQTmarketSalesUnitLastMonth<>0 and fsT.MQTmarketSalesUnitLastMonth is not null then (fsB.MQTMarketSalesUnitLastMonth /fsT.MQTmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 355\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 355\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 355 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MQTSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MQT","0061 1 DUN LAOIRE",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","4527;9068;13606;13759;14158;13696;13328;13220;13672;13573;13291;12945;12877;12818;12622;12995;12675;12266;12073;12271;12962;12776;12806;12450","120;251;390;427;450;447;444;480;472;499;464;500;478;462;457;448;462;460;482;503;517;521;534;516","0;0;0;0;0;0;0;0;0;0;0;0;120;251;390;427;450;447;444;480;472;499;464;500","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,682,0.0891967989454001],["MQT","0030 2 WATERFD CTY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","5571;9607;13679;11418;13409;13043;13867;12468;13017;12748;12650;12105;12662;11512;11403;10355;11468;11202;11750;10725;11261;10902;11392;11233","1100;1316;1488;555;1548;1705;1824;975;991;1047;1048;825;811;560;582;370;367;349;327;327;313;324;341;336","0;0;0;0;0;0;0;0;0;0;0;0;1100;1316;1488;555;1548;1705;1824;975;991;1047;1048;825","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,709,0.08047772229346821],["MQT","0033 1 K/KENNY CO",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2499;4580;6812;6429;7209;6750;7126;6597;7158;6972;7417;7488;7758;7125;6850;6462;6920;6879;6912;6724;6830;7112;7154;7383","35;77;119;130;122;126;125;127;142;142;150;139;154;160;162;172;181;173;154;144;175;166;182;155","0;0;0;0;0;0;0;0;0;0;0;0;35;77;119;130;122;126;125;127;142;142;150;139","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,635,0.052894776434850514],["MQT","0029 1 REST S TIPP",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2285;5919;8231;8170;7036;6732;6735;6583;6728;6704;6737;6636;6675;6570;6668;6595;6606;6291;6555;6322;6757;6479;6824;6612","119;260;380;387;377;382;377;375;361;361;360;368;369;365;375;391;418;395;395;383;394;390;378;388","0;0;0;0;0;0;0;0;0;0;0;0;119;260;380;387;377;382;377;375;361;361;360;368","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,691,0.04737102286160526],["MQT","0032 1 RST WICKLOW",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1888;5786;7636;7382;5353;5248;5315;5455;5488;5613;5593;5580;5649;5646;5705;5670;5611;5619;5919;5840;5940;5979;6215;6048","95;244;367;446;441;452;427;449;466;486;454;453;459;458;456;425;454;436;444;449;457;470;452;456","0;0;0;0;0;0;0;0;0;0;0;0;95;244;367;446;441;452;427;449;466;486;454;453","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,746,0.0433303004033558],["MQT","0030 1 RST WATERFD",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2107;4196;6291;6289;6702;6463;6256;5743;6159;6511;6526;6063;6304;6161;6273;5720;5964;5638;6035;5682;5841;5561;5792;6041","45;108;158;171;172;178;192;187;196;194;215;201;192;194;205;209;210;211;216;194;210;200;232;220","0;0;0;0;0;0;0;0;0;0;0;0;45;108;158;171;172;178;192;187;196;194;215;201","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,641,0.04328014959270377],["MQT","0035 1 RST WEXFORD",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2526;4771;7081;7135;7448;7239;6771;6234;6313;6144;6241;6125;6540;6435;6278;6104;5927;5708;5666;5698;5970;5735;5929;5787","95;216;328;357;343;353;342;355;361;364;379;376;404;411;407;400;390;397;390;386;383;387;400;400","0;0;0;0;0;0;0;0;0;0;0;0;95;216;328;357;343;353;342;355;361;364;379;376","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,759,0.041460391606187176],["MQT","0033 2 K/KENNY TWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1954;3737;5801;5787;6588;6233;6599;5930;6421;5885;6186;5878;5983;5645;5686;5718;5557;5252;5239;5317;5504;5400;5660;5562","36;78;127;145;150;148;134;132;115;135;144;159;149;151;158;156;155;176;190;207;209;226;223;208","0;0;0;0;0;0;0;0;0;0;0;0;36;78;127;145;150;148;134;132;115;135;144;159","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,638,0.03984840126380043],["MQT","0034 1 CARLOW COUNTY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1674;3484;5378;5370;5401;4860;5120;4920;5317;5034;5175;5361;5472;5429;5010;5130;5074;5228;5217;5073;5112;5065;5284;5380","47;113;183;199;188;169;163;167;187;181;177;165;223;233;238;195;189;202;205;195;178;164;167;161","0;0;0;0;0;0;0;0;0;0;0;0;47;113;183;199;188;169;163;167;187;181;177;165","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,665,0.03854448018684759],["MQT","0035 2 WEXFORD TWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1928;4007;5999;6059;5913;5560;5503;5427;5773;5527;5446;5169;5218;5304;5193;5237;5114;5065;5043;4978;5154;4979;5020;4979","143;259;385;370;380;365;366;369;388;389;405;413;415;436;431;450;434;444;444;451;472;457;446;430","0;0;0;0;0;0;0;0;0;0;0;0;143;259;385;370;380;365;366;369;388;389;405;413","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,713,0.035671555176638316],["MQT","0035 3 ENNISCORTHY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1416;2962;4567;4677;4876;4811;4855;4723;4922;4781;4872;4925;5019;4855;4434;4396;4385;4480;4417;4421;4476;4546;4620;4771","97;196;296;302;327;314;329;325;390;408;405;382;407;426;434;423;414;426;402;419;412;441;445;434","0;0;0;0;0;0;0;0;0;0;0;0;97;196;296;302;327;314;329;325;390;408;405;382","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,656,0.03418135966012079],["MQT","0032 4 BRAY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1617;3190;5141;5249;5532;5387;5413;5293;5342;5364;5337;4849;4754;4606;4789;4699;4748;4651;4673;4548;4595;4617;4723;4740","69;127;199;219;241;233;224;235;241;244;228;241;254;273;270;260;286;298;299;277;274;282;263;279","0;0;0;0;0;0;0;0;0;0;0;0;69;127;199;219;241;233;224;235;241;244;228;241","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,676,0.0339592632129475],["MQT","0034 2 CARLOW TOWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1822;3480;5428;5214;5280;5158;5129;4884;4790;4736;4814;4792;4746;4815;4685;4739;4385;4174;3990;4186;4213;4259;4298;4263","23;45;60;63;67;81;77;75;73;80;79;73;74;82;117;111;111;83;89;98;106;101;97;95","0;0;0;0;0;0;0;0;0;0;0;0;23;45;60;63;67;81;77;75;73;80;79;73","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,742,0.030541843687087598],["MQT","0029 3 CLONMEL",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1540;3096;4729;4698;4851;4729;4704;4467;4545;4581;4882;4742;4622;4471;4454;4592;4382;4223;4205;4172;4313;4250;4368;4252","81;158;243;237;239;232;240;241;241;238;242;243;253;261;259;263;282;272;263;236;260;257;270;245","0;0;0;0;0;0;0;0;0;0;0;0;81;158;243;237;239;232;240;241;241;238;242;243","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,692,0.03046303527034869],["MQT","0031 1 REST LAOIS",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1333;2792;4178;4213;4231;3992;4111;4118;4188;4140;4013;4195;4000;3991;3810;3928;4012;3795;3779;3694;3993;3998;4046;4197","45;86;133;133;132;131;140;148;145;139;130;143;142;152;140;140;146;150;152;146;145;137;147;152","0;0;0;0;0;0;0;0;0;0;0;0;45;86;133;133;132;131;140;148;145;139;130;143","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,688,0.030068993186654153],["MQT","0031 2 PORTLAOISE",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1528;3040;4505;4310;4494;4269;4401;4198;4349;4441;4450;4471;4694;4712;4641;4343;4280;4262;4312;4330;4436;4253;4222;4196","23;46;72;74;79;78;85;87;99;95;96;87;89;89;91;92;92;99;98;97;85;81;78;79","0;0;0;0;0;0;0;0;0;0;0;0;23;46;72;74;79;78;85;87;99;95;96;87","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,664,0.030061828785132434],["MQT","0060 1 BLACKROCK",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1479;3140;4731;4880;4837;4654;4695;4465;4659;4380;4569;4362;4517;4390;4405;4381;4304;4102;3951;3909;4116;4051;4072;3943","72;160;236;260;255;255;246;243;245;232;219;223;238;251;254;249;254;255;248;238;233;253;266;258","0;0;0;0;0;0;0;0;0;0;0;0;72;160;236;260;255;255;246;243;245;232;219;223","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,721,0.028249235200137557],["MQT","0035 5 GOREY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1017;2176;3366;3462;3394;3508;3546;3727;3691;3640;3675;3856;4055;3931;3506;3363;3471;3556;3705;3640;3745;3713;3870;3784","22;41;75;90;98;85;64;66;75;82;84;86;105;94;85;67;72;79;80;90;89;105;108;121","0;0;0;0;0;0;0;0;0;0;0;0;22;41;75;90;98;85;64;66;75;82;84;86","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,697,0.027110095358184254],["MQT","0068 1 DUBLIN 4",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1355;2764;4141;4230;4212;4118;3936;3916;4047;4144;4272;3941;3995;3799;3929;3922;3868;3860;3683;3698;3680;3731;3711;3709","95;169;244;253;266;263;245;237;245;240;243;236;254;258;266;261;237;231;194;205;197;224;224;228","0;0;0;0;0;0;0;0;0;0;0;0;95;169;244;253;266;263;245;237;245;240;243;236","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,666,0.026572765244055337],["MQT","0032 5 GREYSTONES",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1216;2528;3721;3832;3766;3668;3663;3610;3815;3737;3788;3473;3267;3048;3007;3073;3034;3032;3018;3092;3180;3134;3167;3251","37;65;109;119;133;141;130;134;145;144;148;124;128;109;106;122;142;144;159;156;168;150;154;164","0;0;0;0;0;0;0;0;0;0;0;0;37;65;109;119;133;141;130;134;145;144;148;124","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,699,0.023291469347108087],["MQT","0032 3 ARKLOW",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","971;2012;3004;3072;3010;2957;2944;3006;3124;3059;3082;3039;3094;3097;3072;3214;3132;3103;3058;3200;3305;3210;3211;3215","61;114;163;165;169;163;146;142;153;155;163;157;153;158;173;206;197;191;182;195;204;215;213;224","0;0;0;0;0;0;0;0;0;0;0;0;61;114;163;165;169;163;146;142;153;155;163;157","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,640,0.02303355089232621],["MQT","0070 3 DUNDRUM",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","642;1274;1902;1952;2208;2376;2566;2648;2742;2747;2898;2930;2828;2510;2235;2393;2293;2233;1951;1842;1892;1916;2162;3185","26;48;81;76;91;73;81;71;81;76;71;72;80;91;87;103;174;226;296;264;282;259;298;276","0;0;0;0;0;0;0;0;0;0;0;0;26;48;81;76;91;73;81;71;81;76;71;72","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,660,0.022818618846674642],["MQT","0018 1 DUBLIN 2",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1045;2192;3164;3241;3076;3077;2912;2919;3060;3139;3095;2948;3021;3045;2903;2925;3393;3643;3588;3190;3110;3022;3141;3092","54;104;156;157;153;143;135;140;133;140;139;163;158;166;167;191;187;188;172;176;171;175;185;189","0;0;0;0;0;0;0;0;0;0;0;0;54;104;156;157;153;143;135;140;133;140;139;163","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,662,0.022152329505154784],["MQT","0035 4 NEW ROSS",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1071;2307;3520;3704;3809;3517;3372;3324;3532;3576;3491;3379;3551;3383;3369;3195;3245;3110;3092;2925;3107;2937;2913;2878","41;89;130;126;116;113;108;112;113;124;126;129;131;139;137;131;124;128;132;133;147;161;173;187","0;0;0;0;0;0;0;0;0;0;0;0;41;89;130;126;116;113;108;112;113;124;126;129","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,690,0.020619147579506943],["MQT","0032 2 WICKLOW TWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","908;1753;2642;2422;2676;2459;2535;2259;2430;2547;2567;2491;2433;2301;2369;2391;2557;2575;2639;2589;2627;2609;2678;2616","25;55;84;86;86;94;108;127;144;148;159;159;168;160;146;125;114;120;127;122;120;125;133;131","0;0;0;0;0;0;0;0;0;0;0;0;25;55;84;86;86;94;108;127;144;148;159;159","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,647,0.018742074380816598],["MQT","0030 3 DUNGARVAN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","891;1858;2804;2801;2668;2441;2364;2611;2611;2584;2255;2638;2859;2985;2765;2657;2524;2451;2370;2424;2422;2499;2562;2608","24;48;72;78;80;74;74;74;76;76;73;84;78;79;67;74;75;80;74;70;75;74;84;73","0;0;0;0;0;0;0;0;0;0;0;0;24;48;72;78;80;74;74;74;76;76;73;84","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,730,0.01868475916864285],["MQT","0060 2 STILLORGAN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","857;1735;2575;2737;2917;2770;2701;2487;2698;2573;2625;2485;2563;2479;2493;2471;2356;2288;2273;2366;2533;2508;2605;2421","25;57;75;83;92;100;117;93;93;79;89;91;81;89;88;95;92;102;98;107;113;116;111;115","0;0;0;0;0;0;0;0;0;0;0;0;25;57;75;83;92;100;117;93;93;79;89;91","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,702,0.017345016084081417],["MQT","0029 2 TIPP TOWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","640;1370;2063;2178;2193;2043;1947;1899;2052;2031;2004;2050;2092;2099;1957;1984;1925;1920;1910;1965;2052;2054;2081;2033","40;76;112;109;110;103;103;106;114;108;109;116;119;110;103;122;142;135;125;109;124;120;128;118","0;0;0;0;0;0;0;0;0;0;0;0;40;76;112;109;110;103;103;106;114;108;109;116","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,745,0.014565228293654489],["MQT","0031 3 PTARLINGTON",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","738;1381;2144;2265;2408;2324;2330;2194;2491;2311;2342;2060;2287;2356;2149;2078;2050;2326;2352;2601;2405;2195;1912;1991","20;34;49;45;51;45;40;33;36;33;36;40;46;46;45;49;45;42;47;48;55;46;44;40","0;0;0;0;0;0;0;0;0;0;0;0;20;34;49;45;51;45;40;33;36;33;36;40","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,626,0.014264323429742296],["MQT","0070 1 REST DUB 14",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","718;1325;1981;1988;2059;2112;2037;2060;2027;1935;1899;1862;1991;1850;1791;1681;1764;1727;1780;1806;1911;1859;1821;1751","27;57;92;96;104;107;116;108;113;102;113;99;105;95;107;95;102;87;88;83;91;95;92;84","0;0;0;0;0;0;0;0;0;0;0;0;27;57;92;96;104;107;116;108;113;102;113;99","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,701,0.012544867064529765],["MQT","0029 4 CASHEL",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","572;946;1281;1089;1120;1124;1087;1077;1118;1229;1245;1210;1139;1105;1147;1169;1181;1131;1104;1115;1169;1162;1209;1208","16;24;39;37;37;34;35;43;54;70;85;86;78;67;67;67;81;75;81;66;72;62;65;64","0;0;0;0;0;0;0;0;0;0;0;0;16;24;39;37;37;34;35;43;54;70;85;86","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,743,0.00865459703823641]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MQT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 355\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 355 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MQT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 355\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MQT",null,null,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633","2758;4721;6645;5995;7097;7187;7237;6456;6688;6811;6833;6633;6795;6625;6680;6462;6629;6654;6653;6574;6731;6784;6933;6826","50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579",null],["National","MQT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;10558;20531;30623;30700;32250;32229;33498;33025;34280;33586;33954;33702","10558;20531;30623;30700;32250;32229;33498;33025;34280;33586;33954;33702;34196;34551;34542;35139;35256;35113;34464;34505;35128;35275;35256;35369","214544;433390;652404;652380;661868;639746;641061;624797;651520;644877;654043;634145;656578;642490;637330;618617;620399;607188;609736;601636;620380;610942;626086;625008",null]]},"SELECT \r\nCASE WHEN 'YTD' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='355' ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'YTD' ='Srv. QTR' \r\nTHEN  ' - Sales/Target (%): '\r\n ELSE ' '\r\nEND\r\n as value ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'YTD' ='MQT' \r\nTHEN  'Growth vs 3 previous month'\r\n ELSE \r\nCASE WHEN 'YTD' ='Month' \r\nTHEN  'Growth vs previous month'\r\nELSE 'Growth vs previous year'\r\nEND END\r\n as value\r\n ":{"columns":["VALUE"],"data":[["Growth vs previous year"]]},"Select DISTINCT \r\n'YTD'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.YTDmarketSalesUnit marketSalesUnitT ,\r\nfsB.YTDMarketSalesUnit marketSalesUnitB,\r\nFsb.YTDSalesUnit SalesUnitB  ,\r\nFsb.YTDSalesUnitPY,\r\nFsT.YTDSalesUnit SalesUnitT,\r\n  --Fsb.YTDSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.YTDmarketSalesUnitLastMonth<>0 and fsT.YTDmarketSalesUnitLastMonth is not null then (fsB.YTDMarketSalesUnitLastMonth /fsT.YTDmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 355\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 355\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 355 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","YTDSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["YTD","0061 1 DUN LAOIRE",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","4527;4541;9079;13759;18699;22775;27087;31919;36447;40660;45210;49392;53537;4491;8477;12995;17166;20743;25068;29437;33705;37844;42243;46155","120;131;270;427;581;717;871;1061;1189;1370;1525;1689;1848;139;298;448;601;758;930;1104;1275;1451;1638;1791","0;0;0;0;0;0;0;0;0;0;0;0;120;131;270;427;581;717;871;1061;1189;1370;1525;1689","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,682,0.09156684349816886],["YTD","0030 2 WATERFD CTY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","5571;4036;8108;11418;17445;21151;25285;29913;34168;38033;42563;46273;50695;3380;6981;10355;14848;18183;22105;25573;29444;33007;36965;40677","1100;216;388;555;1764;2093;2379;2739;3084;3426;3787;3909;4237;110;254;370;477;603;697;804;916;1021;1145;1252","0;0;0;0;0;0;0;0;0;0;0;0;1100;216;388;555;1764;2093;2379;2739;3084;3426;3787;3909","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,709,0.0806990465382952],["YTD","0033 1 K/KENNY CO",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2499;2081;4313;6429;9290;11063;13555;15887;18221;20527;23304;25709;28285;2144;4274;6462;9064;11153;13374;15788;17983;20486;22942;25366","35;42;84;130;164;210;255;291;352;397;441;491;551;50;102;172;231;275;326;375;450;492;557;605","0;0;0;0;0;0;0;0;0;0;0;0;35;42;84;130;164;210;255;291;352;397;441;491","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,635,0.05032357387443508],["YTD","0029 1 REST S TIPP",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2285;3634;5946;8170;10670;12678;14905;17253;19406;21609;23990;26042;28284;2276;4426;6595;8882;10717;13150;15204;17474;19629;22028;24086","119;141;261;387;518;643;764;893;1004;1125;1253;1372;1494;124;253;391;542;648;786;925;1042;1176;1303;1430","0;0;0;0;0;0;0;0;0;0;0;0;119;141;261;387;518;643;764;893;1004;1125;1253;1372","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,691,0.047784183566176905],["YTD","0032 1 RST WICKLOW",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1888;3898;5748;7382;9251;10996;12697;14706;16484;18310;20299;22064;23959;1986;3810;5670;7597;9429;11589;13437;15369;17568;19652;21417","95;149;272;446;590;724;873;1039;1190;1359;1493;1643;1818;133;281;425;587;717;869;1036;1174;1339;1488;1630","0;0;0;0;0;0;0;0;0;0;0;0;95;149;272;446;590;724;873;1039;1190;1359;1493;1643","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,746,0.042489157993722944],["YTD","0035 1 RST WEXFORD",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2526;2245;4555;7135;9693;11794;13906;15927;18107;20050;22168;24232;26590;2013;3920;6104;7940;9628;11770;13638;15598;17505;19567;21385","95;121;233;357;464;586;699;819;947;1063;1198;1323;1467;142;263;400;532;660;790;918;1043;1177;1318;1443","0;0;0;0;0;0;0;0;0;0;0;0;95;121;233;357;464;586;699;819;947;1063;1198;1323","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,759,0.04242567323601649],["YTD","0030 1 RST WATERFD",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2107;2089;4184;6289;8791;10647;12545;14534;16806;19056;21060;22869;25360;1861;3782;5720;7825;9420;11755;13507;15261;17316;19299;21302","45;63;113;171;235;291;363;422;487;557;637;688;749;82;144;209;292;355;425;486;565;625;718;785","0;0;0;0;0;0;0;0;0;0;0;0;45;63;113;171;235;291;363;422;487;557;637;688","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,641,0.04226100964571537],["YTD","0033 2 K/KENNY TWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1954;1783;3847;5787;8371;10080;12386;14301;16501;18271;20487;22379;24254;1878;3811;5718;7435;9063;10957;12752;14567;16357;18412;20129","36;42;91;145;192;239;279;324;354;414;468;513;563;56;108;156;211;284;346;418;493;572;641;701","0;0;0;0;0;0;0;0;0;0;0;0;36;42;91;145;192;239;279;324;354;414;468;513","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,638,0.03993389649603815],["YTD","0034 1 CARLOW COUNTY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1674;1810;3704;5370;7211;8564;10490;12131;13881;15524;17306;19242;20996;1739;3256;5130;6813;8484;10347;11886;13596;15412;17170;18976","47;66;136;199;254;305;362;421;492;543;598;657;766;65;129;195;254;331;400;449;509;564;616;670","0;0;0;0;0;0;0;0;0;0;0;0;47;66;136;199;254;305;362;421;492;543;598;657","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,665,0.037646461319927466],["YTD","0035 2 WEXFORD TWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1928;2079;4071;6059;7992;9631;11562;13419;15404;17089;18865;20573;22307;1862;3459;5237;6976;8524;10280;11954;13678;15259;16974;18657","143;116;242;370;496;607;736;865;995;1125;1270;1408;1540;166;299;450;600;743;894;1051;1215;1351;1497;1645","0;0;0;0;0;0;0;0;0;0;0;0;143;116;242;370;496;607;736;865;995;1125;1270;1408","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,713,0.03701359764154125],["YTD","0032 4 BRAY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1617;1573;3524;5249;7105;8911;10662;12398;14253;16026;17735;19102;20780;1561;3111;4699;6309;7762;9372;10857;12357;13989;15580;17097","69;58;130;219;299;363;443;534;604;687;762;845;941;94;174;260;380;472;559;657;746;841;920;1025","0;0;0;0;0;0;0;0;0;0;0;0;69;58;130;219;299;363;443;534;604;687;762;845","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,676,0.0339187157033516],["YTD","0035 3 ENNISCORTHY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1416;1546;3151;4677;6422;7962;9532;11145;12884;14313;16017;17809;19332;1540;2911;4396;5925;7391;8813;10346;11867;13359;14966;16638","97;99;199;302;426;513;631;751;903;1039;1156;1285;1446;136;273;423;550;699;825;969;1111;1266;1414;1545","0;0;0;0;0;0;0;0;0;0;0;0;97;99;199;302;426;513;631;751;903;1039;1156;1285","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,656,0.033008106209999645],["YTD","0034 2 CARLOW TOWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1822;1658;3606;5214;6938;8764;10343;11822;13554;15079;16636;18346;19825;1626;3206;4739;6011;7380;8729;10197;11593;12988;14495;15856","23;22;37;63;89;118;140;164;191;220;243;264;294;31;87;111;142;170;200;240;276;301;337;371","0;0;0;0;0;0;0;0;0;0;0;0;23;22;37;63;89;118;140;164;191;220;243;264","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,742,0.03145669744354816],["YTD","0029 3 CLONMEL",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1540;1556;3189;4698;6407;7918;9402;10874;12463;13983;15756;17205;18605;1622;3054;4592;6004;7277;8797;10176;11590;13047;14544;15842","81;77;162;237;316;394;477;557;635;715;799;878;968;92;169;263;374;441;526;610;701;783;880;946","0;0;0;0;0;0;0;0;0;0;0;0;81;77;162;237;316;394;477;557;635;715;799;878","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,692,0.03142892286205159],["YTD","0031 2 PORTLAOISE",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1528;1512;2977;4310;6006;7246;8711;10204;11595;13152;14654;16066;17846;1520;2861;4343;5800;7123;8655;10130;11559;12908;14352;15755","23;23;49;74;102;127;159;189;226;254;285;313;343;31;61;92;123;160;190;220;245;271;298;324","0;0;0;0;0;0;0;0;0;0;0;0;23;23;49;74;102;127;159;189;226;254;285;313","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,664,0.031256323677037165],["YTD","0060 1 BLACKROCK",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1479;1661;3252;4880;6498;7906;9575;10963;12565;13955;15532;16927;18472;1450;2860;4381;5754;6962;8332;9663;11078;12383;13735;15021","72;88;164;260;343;419;506;586;664;738;805;887;976;80;165;249;334;420;497;572;653;750;838;911","0;0;0;0;0;0;0;0;0;0;0;0;72;88;164;260;343;419;506;586;664;738;805;887","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,721,0.02980014204714537],["YTD","0031 1 REST LAOIS",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1333;1459;2845;4213;5690;6837;8324;9808;11025;12464;13821;15220;16464;1348;2566;3928;5360;6361;7707;9054;10354;11705;13100;14551","45;41;88;133;173;219;273;321;364;412;451;507;554;49;93;140;195;243;292;341;388;429;488;540","0;0;0;0;0;0;0;0;0;0;0;0;45;41;88;133;173;219;273;321;364;412;451;507","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,688,0.02886770966833182],["YTD","0068 1 DUBLIN 4",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1355;1409;2786;4230;5621;6904;8166;9537;10951;12310;13809;14892;16305;1303;2516;3922;5171;6376;7605;8869;10056;11336;12580;13765","95;74;149;253;340;412;498;577;657;738;820;893;992;86;167;261;323;398;455;528;595;679;752;823","0;0;0;0;0;0;0;0;0;0;0;0;95;74;149;253;340;412;498;577;657;738;820;893","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,666,0.027308365307167033],["YTD","0035 5 GOREY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1017;1159;2349;3462;4553;5857;7008;8280;9548;10648;11955;13404;14703;1183;2207;3363;4654;5763;7068;8294;9508;10781;12164;13292","22;19;53;90;117;138;154;183;213;236;267;299;341;20;43;67;92;122;147;182;211;252;290;332","0;0;0;0;0;0;0;0;0;0;0;0;22;19;53;90;117;138;154;183;213;236;267;299","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,697,0.026369981232318502],["YTD","0032 3 ARKLOW",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","971;1041;2033;3072;4051;4990;6016;7057;8114;9075;10139;11153;12169;1067;2056;3214;4199;5159;6272;7399;8464;9482;10610;11679","61;53;102;165;222;265;311;364;418;466;527;575;619;66;129;206;263;320;388;458;524;603;671;748","0;0;0;0;0;0;0;0;0;0;0;0;61;53;102;165;222;265;311;364;418;466;527;575","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,640,0.023169952664177536],["YTD","0018 1 DUBLIN 2",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1045;1147;2119;3241;4223;5196;6153;7142;8256;9292;10237;11204;12313;969;1794;2925;4362;5437;6513;7552;8547;9535;10693;11639","54;50;102;157;203;245;292;343;378;432;482;541;590;58;118;191;245;306;363;421;477;538;606;666","0;0;0;0;0;0;0;0;0;0;0;0;54;50;102;157;203;245;292;343;378;432;482;541","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,662,0.023090596717044467],["YTD","0032 5 GREYSTONES",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1216;1312;2505;3832;5078;6173;7495;8688;9988;11232;12476;13461;14499;1025;1969;3073;4059;5001;6091;7151;8181;9225;10318;11432","37;28;72;119;161;213;249;295;358;393;443;482;521;31;67;122;173;211;281;329;379;431;483;543","0;0;0;0;0;0;0;0;0;0;0;0;37;28;72;119;161;213;249;295;358;393;443;482","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,699,0.02267992969063084],["YTD","0035 4 NEW ROSS",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1071;1236;2449;3704;5045;5966;7076;8369;9498;10652;11860;12877;14203;1040;2043;3195;4285;5153;6287;7210;8260;9224;10123;11138","41;48;89;126;164;202;234;276;315;358;402;444;489;52;92;131;176;220;263;309;367;424;482;554","0;0;0;0;0;0;0;0;0;0;0;0;41;48;89;126;164;202;234;276;315;358;402;444","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,690,0.02209666347920279],["YTD","0032 2 WICKLOW TWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","908;845;1734;2422;3521;4193;4957;5780;6623;7504;8347;9114;9937;711;1546;2391;3268;4121;5030;5857;6748;7639;8535;9364","25;30;59;86;116;153;194;243;297;342;402;456;510;52;92;125;166;212;252;288;332;377;421;463","0;0;0;0;0;0;0;0;0;0;0;0;25;30;59;86;116;153;194;243;297;342;402;456","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,647,0.018577227223851224],["YTD","0030 3 DUNGARVAN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","891;967;1913;2801;3635;4354;5165;6246;6965;7749;8501;9603;10608;878;1760;2657;3402;4211;5027;5826;6633;7526;8388;9241","24;24;48;78;104;122;152;178;198;228;251;282;306;24;43;74;99;123;148;169;198;222;253;271","0;0;0;0;0;0;0;0;0;0;0;0;24;24;48;78;104;122;152;178;198;228;251;282","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,730,0.01833320768641704],["YTD","0060 2 STILLORGAN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","857;878;1718;2737;3795;4488;5438;6282;7186;8011;8907;9671;10574;812;1590;2471;3168;3878;4744;5534;6411;7252;8139;8832","25;32;50;83;124;150;200;217;243;279;306;334;360;35;62;95;127;164;193;234;277;309;345;392","0;0;0;0;0;0;0;0;0;0;0;0;25;32;50;83;124;150;200;217;243;279;306;334","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,702,0.01752179312698142],["YTD","0070 3 DUNDRUM",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","642;632;1260;1952;2840;3636;4518;5488;6378;7265;8386;9308;10093;803;1450;2393;3096;3683;4344;4938;5575;6260;7100;8760","26;22;55;76;113;128;157;184;209;233;255;281;313;33;55;103;207;281;399;471;563;658;769;839","0;0;0;0;0;0;0;0;0;0;0;0;26;22;55;76;113;128;157;184;209;233;255;281","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,660,0.017378952422141897],["YTD","0031 3 PTARLINGTON",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","738;643;1406;2265;3051;3730;4595;5245;6221;6906;7587;8281;9193;750;1237;2078;2800;3563;4430;5401;5968;6625;7313;7959","20;14;29;45;65;74;85;98;110;118;134;150;164;16;31;49;61;73;96;109;128;142;153;168","0;0;0;0;0;0;0;0;0;0;0;0;20;14;29;45;65;74;85;98;110;118;134;150","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,626,0.01578984958080221],["YTD","0029 2 TIPP TOWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","640;730;1423;2178;2923;3466;4125;4822;5518;6156;6826;7568;8248;677;1277;1984;2602;3197;3894;4567;5249;5948;6648;7282","40;36;72;109;146;175;212;252;289;320;361;405;439;32;69;122;174;204;247;283;328;367;411;446","0;0;0;0;0;0;0;0;0;0;0;0;40;36;72;109;146;175;212;252;289;320;361;405","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,745,0.014446750175575033],["YTD","0070 1 REST DUB 14",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","718;607;1263;1988;2666;3375;4025;4726;5402;5960;6625;7264;7951;524;1104;1681;2288;2831;3461;4094;4742;5320;5915;6493","27;30;65;96;134;172;212;242;285;314;355;384;419;31;72;95;133;159;183;216;250;278;308;334","0;0;0;0;0;0;0;0;0;0;0;0;27;30;65;96;134;172;212;242;285;314;355;384","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,701,0.012881454118375267],["YTD","0029 4 CASHEL",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","572;374;709;1089;1494;1833;2176;2571;2951;3405;3816;4161;4544;377;764;1169;1558;1895;2273;2673;3064;3435;3882;4272","16;8;23;37;45;57;72;88;111;142;173;197;220;20;44;67;101;119;148;167;191;210;232;255","0;0;0;0;0;0;0;0;0;0;0;0;16;8;23;37;45;57;72;88;111;142;173;197","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,743,0.008475215153811664]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'YTD' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 355\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 355 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'YTD' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 355\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","YTD",null,null,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395","2758;1963;3887;5995;9060;11074;13232;15516;17762;20043;22349;24395;26838;2136;4237;6462;8765;10891;13115;15339;17622;19899;22272;24448","50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058",null],["National","YTD",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;10558;9973;20065;30700;42223;52294;64198;75248;86574;97784;109202;120276","10558;9973;20065;30700;42223;52294;64198;75248;86574;97784;109202;120276;131980;11773;22838;35139;47029;57951;69603;81534;93079;104878;116790;128448","214544;218846;437860;652380;880714;1077606;1293441;1505511;1729126;1938318;2159554;2363271;2594896;207148;405705;618617;827547;1012893;1228353;1429183;1633273;1839295;2055269;2258281",null]]},"SELECT \r\nCASE WHEN 'MAT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='355' ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'MAT' ='Srv. QTR' \r\nTHEN  ' - Sales/Target (%): '\r\n ELSE ' '\r\nEND\r\n as value ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'MAT' ='MQT' \r\nTHEN  'Growth vs 3 previous month'\r\n ELSE \r\nCASE WHEN 'MAT' ='Month' \r\nTHEN  'Growth vs previous month'\r\nELSE 'Growth vs previous year'\r\nEND END\r\n as value\r\n ":{"columns":["VALUE"],"data":[["Growth vs previous year"]]},"Select DISTINCT \r\n'MAT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MATmarketSalesUnit marketSalesUnitT ,\r\nfsB.MATMarketSalesUnit marketSalesUnitB,\r\nFsb.MATSalesUnit SalesUnitB  ,\r\nFsb.MATSalesUnitPY,\r\nFsT.MATSalesUnit SalesUnitT,\r\n  --Fsb.MATSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MATmarketSalesUnitLastMonth<>0 and fsT.MATmarketSalesUnitLastMonth is not null then (fsB.MATMarketSalesUnitLastMonth /fsT.MATmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 355\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 355\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 355 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MATSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MAT","0061 1 DUN LAOIRE",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","4527;9068;13606;18286;23226;27302;31614;36446;40974;45187;49737;53919;53537;53487;52935;52773;52004;51505;51518;51055;50795;50721;50570;50300","120;251;390;547;701;837;991;1181;1309;1490;1645;1809;1848;1856;1876;1869;1868;1889;1907;1891;1934;1929;1961;1950","0;0;0;0;0;0;0;0;0;0;0;0;120;251;390;547;701;837;991;1181;1309;1490;1645;1809","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,682,0.09086343749209687],["MAT","0030 2 WATERFD CTY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","5571;9607;13679;16989;23016;26722;30856;35484;39739;43604;48134;51844;50695;50039;49568;49632;48098;47727;47515;46355;45971;45669;45097;45099","1100;1316;1488;1655;2864;3193;3479;3839;4184;4526;4887;5009;4237;4131;4103;4052;2950;2747;2555;2302;2069;1832;1595;1580","0;0;0;0;0;0;0;0;0;0;0;0;1100;1316;1488;1655;2864;3193;3479;3839;4184;4526;4887;5009","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,709,0.08146819418401743],["MAT","0033 1 K/KENNY CO",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2499;4580;6812;8928;11789;13562;16054;18386;20720;23026;25803;28208;28285;28348;28246;28318;28059;28375;28104;28186;28047;28244;27923;27942","35;77;119;165;199;245;290;326;387;432;476;526;551;559;569;593;618;616;622;635;649;646;667;665","0;0;0;0;0;0;0;0;0;0;0;0;35;77;119;165;199;245;290;326;387;432;476;526","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,635,0.0504752717774189],["MAT","0029 1 REST S TIPP",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2285;5919;8231;10455;12955;14963;17190;19538;21691;23894;26275;28327;28284;26926;26764;26709;26496;26323;26529;26235;26352;26304;26322;26328","119;260;380;506;637;762;883;1012;1123;1244;1372;1491;1494;1477;1486;1498;1518;1499;1516;1526;1532;1545;1544;1552","0;0;0;0;0;0;0;0;0;0;0;0;119;260;380;506;637;762;883;1012;1123;1244;1372;1491","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,691,0.04755969348492895],["MAT","0030 1 RST WATERFD",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2107;4196;6291;8396;10898;12754;14652;16641;18913;21163;23167;24976;25360;25132;24958;24791;24394;24133;24570;24333;23815;23620;23599;23793","45;108;158;216;280;336;408;467;532;602;682;733;749;768;780;787;806;813;811;813;827;817;830;846","0;0;0;0;0;0;0;0;0;0;0;0;45;108;158;216;280;336;408;467;532;602;682;733","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,641,0.04298039300694753],["MAT","0035 1 RST WEXFORD",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2526;4771;7081;9661;12219;14320;16432;18453;20633;22576;24694;26758;26590;26358;25955;25559;24837;24424;24454;24301;24081;24045;23989;23743","95;216;328;452;559;681;794;914;1042;1158;1293;1418;1467;1488;1497;1510;1535;1541;1558;1566;1563;1581;1587;1587","0;0;0;0;0;0;0;0;0;0;0;0;95;216;328;452;559;681;794;914;1042;1158;1293;1418","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,759,0.042890071498506085],["MAT","0032 1 RST WICKLOW",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1888;5786;7636;9270;11139;12884;14585;16594;18372;20198;22187;23952;23959;22047;22021;22247;22305;22392;22851;22690;22844;23217;23312;23312","95;244;367;541;685;819;968;1134;1285;1454;1588;1738;1818;1802;1827;1797;1815;1811;1814;1815;1802;1798;1813;1805","0;0;0;0;0;0;0;0;0;0;0;0;95;244;367;541;685;819;968;1134;1285;1454;1588;1738","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,746,0.0421115000957408],["MAT","0033 2 K/KENNY TWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1954;3737;5801;7741;10325;12034;14340;16255;18455;20225;22441;24333;24254;24349;24218;24185;23318;23237;22825;22705;22320;22340;22179;22004","36;78;127;181;228;275;315;360;390;450;504;549;563;577;580;574;582;608;630;657;702;721;736;751","0;0;0;0;0;0;0;0;0;0;0;0;36;78;127;181;228;275;315;360;390;450;504;549","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,638,0.03974868943491251],["MAT","0034 1 CARLOW COUNTY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1674;3484;5378;7044;8885;10238;12164;13805;15555;17198;18980;20916;20996;20925;20548;20756;20598;20916;20853;20751;20711;20884;20860;20730","47;113;183;246;301;352;409;468;539;590;645;704;766;765;759;762;766;792;804;794;783;787;784;779","0;0;0;0;0;0;0;0;0;0;0;0;47;113;183;246;301;352;409;468;539;590;645;704","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,665,0.037447297399824414],["MAT","0035 2 WEXFORD TWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1928;4007;5999;7987;9920;11559;13490;15347;17332;19017;20793;22501;22307;22090;21695;21485;21291;21200;21025;20842;20581;20477;20416;20391","143;259;385;513;639;750;879;1008;1138;1268;1413;1551;1540;1590;1597;1620;1644;1676;1698;1726;1760;1766;1767;1777","0;0;0;0;0;0;0;0;0;0;0;0;143;259;385;513;639;750;879;1008;1138;1268;1413;1551","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,713,0.03683491757259139],["MAT","0032 4 BRAY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1617;3190;5141;6866;8722;10528;12279;14015;15870;17643;19352;20719;20780;20768;20367;20230;19984;19631;19490;19239;18884;18743;18625;18775","69;127;199;288;368;432;512;603;673;756;831;914;941;977;985;982;1022;1050;1057;1064;1083;1095;1099;1121","0;0;0;0;0;0;0;0;0;0;0;0;69;127;199;288;368;432;512;603;673;756;831;914","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,676,0.03391572641976379],["MAT","0035 3 ENNISCORTHY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1416;2962;4567;6093;7838;9378;10948;12561;14300;15729;17433;19225;19332;19326;19092;19051;18835;18761;18613;18533;18315;18378;18281;18161","97;196;296;399;523;610;728;848;1000;1136;1253;1382;1446;1483;1520;1567;1570;1632;1640;1664;1654;1673;1704;1706","0;0;0;0;0;0;0;0;0;0;0;0;97;196;296;399;523;610;728;848;1000;1136;1253;1382","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,656,0.032806578296102805],["MAT","0031 2 PORTLAOISE",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1528;3040;4505;5838;7534;8774;10239;11732;13123;14680;16182;17594;17846;17854;17730;17879;17640;17723;17790;17772;17810;17602;17544;17535","23;46;72;97;125;150;182;212;249;277;308;336;343;351;355;361;364;376;374;374;362;360;356;354","0;0;0;0;0;0;0;0;0;0;0;0;23;46;72;97;125;150;182;212;249;277;308;336","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,664,0.03167575301041588],["MAT","0034 2 CARLOW TOWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1822;3480;5428;7036;8760;10586;12165;13644;15376;16901;18458;20168;19825;19793;19425;19350;18898;18441;18211;18200;17864;17734;17684;17335","23;45;60;86;112;141;163;187;214;243;266;287;294;303;344;342;347;346;354;370;379;375;388;401","0;0;0;0;0;0;0;0;0;0;0;0;23;45;60;86;112;141;163;187;214;243;266;287","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,742,0.031314466976650086],["MAT","0029 3 CLONMEL",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1540;3096;4729;6238;7947;9458;10942;12414;14003;15523;17296;18745;18605;18671;18470;18499;18202;17964;18000;17907;17732;17669;17393;17242","81;158;243;318;397;475;558;638;716;796;880;959;968;983;975;994;1026;1015;1017;1021;1034;1036;1049;1036","0;0;0;0;0;0;0;0;0;0;0;0;81;158;243;318;397;475;558;638;716;796;880;959","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,692,0.03114646897094899],["MAT","0060 1 BLACKROCK",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1479;3140;4731;6359;7977;9385;11054;12442;14044;15434;17011;18406;18472;18261;18080;17973;17728;17528;17229;17172;16985;16900;16675;16566","72;160;236;332;415;491;578;658;736;810;877;959;976;968;977;965;967;977;967;962;965;988;1009;1000","0;0;0;0;0;0;0;0;0;0;0;0;72;160;236;332;415;491;578;658;736;810;877;959","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,721,0.02992532217682061],["MAT","0031 1 REST LAOIS",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1333;2792;4178;5546;7023;8170;9657;11141;12358;13797;15154;16553;16464;16353;16185;16179;16134;15988;15847;15710;15793;15705;15743;15795","45;86;133;178;218;264;318;366;409;457;496;552;554;562;559;561;576;578;573;574;578;571;591;587","0;0;0;0;0;0;0;0;0;0;0;0;45;86;133;178;218;264;318;366;409;457;496;552","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,688,0.02853256451665348],["MAT","0068 1 DUBLIN 4",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1355;2764;4141;5585;6976;8259;9521;10892;12306;13665;15164;16247;16305;16199;16035;15997;15855;15777;15744;15637;15410;15331;15076;15178","95;169;244;348;435;507;593;672;752;833;915;988;992;1004;1010;1000;975;978;949;943;930;933;924;922","0;0;0;0;0;0;0;0;0;0;0;0;95;169;244;348;435;507;593;672;752;833;915;988","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,666,0.02741799710248601],["MAT","0035 5 GOREY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1017;2176;3366;4479;5570;6874;8025;9297;10565;11665;12972;14421;14703;14727;14561;14604;14804;14609;14763;14717;14663;14836;14912;14591","22;41;75;112;139;160;176;205;235;258;289;321;341;342;331;318;316;325;334;340;339;357;364;374","0;0;0;0;0;0;0;0;0;0;0;0;22;41;75;112;139;160;176;205;235;258;289;321","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,697,0.026357622593383406],["MAT","0018 1 DUBLIN 2",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1045;2192;3164;4286;5268;6241;7198;8187;9301;10337;11282;12249;12313;12135;11988;11997;12452;12554;12673;12723;12604;12556;12769;12748","54;104;156;211;257;299;346;397;432;486;536;595;590;598;606;624;632;651;661;668;689;696;714;715","0;0;0;0;0;0;0;0;0;0;0;0;54;104;156;211;257;299;346;397;432;486;536;595","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,662,0.023028371792231626],["MAT","0032 3 ARKLOW",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","971;2012;3004;4043;5022;5961;6987;8028;9085;10046;11110;12124;12169;12195;12192;12311;12317;12338;12425;12511;12519;12576;12640;12695","61;114;163;226;283;326;372;425;479;527;588;636;619;632;646;660;660;674;696;713;725;756;763;792","0;0;0;0;0;0;0;0;0;0;0;0;61;114;163;226;283;326;372;425;479;527;588;636","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,640,0.02293263099328369],["MAT","0032 5 GREYSTONES",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1216;2528;3721;5048;6294;7389;8711;9904;11204;12448;13692;14677;14499;14212;13963;13740;13480;13327;13095;12962;12692;12492;12341;12470","37;65;109;156;198;250;286;332;395;430;480;519;521;524;516;524;533;519;553;555;542;559;561;582","0;0;0;0;0;0;0;0;0;0;0;0;37;65;109;156;198;250;286;332;395;430;480;519","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,699,0.022526184205297176],["MAT","0035 4 NEW ROSS",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1071;2307;3520;4775;6116;7037;8147;9440;10569;11723;12931;13948;14203;14007;13797;13694;13443;13390;13414;13044;12965;12775;12466;12464","41;89;130;167;205;243;275;317;356;399;443;485;489;493;492;494;501;507;518;522;541;555;569;599","0;0;0;0;0;0;0;0;0;0;0;0;41;89;130;167;205;243;275;317;356;399;443;485","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,690,0.022515345624284203],["MAT","0030 3 DUNGARVAN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","891;1858;2804;3692;4526;5245;6056;7137;7856;8640;9392;10494;10608;10519;10455;10464;10375;10465;10470;10188;10276;10385;10495;10246","24;48;72;102;128;146;176;202;222;252;275;306;306;306;301;302;301;307;302;297;306;300;308;295","0;0;0;0;0;0;0;0;0;0;0;0;24;48;72;102;128;146;176;202;222;252;275;306","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,730,0.01850868350982156],["MAT","0032 2 WICKLOW TWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","908;1753;2642;3330;4429;5101;5865;6688;7531;8412;9255;10022;9937;9803;9749;9906;9684;9865;10010;10014;10062;10072;10125;10187","25;55;84;111;141;178;219;268;322;367;427;481;510;532;543;549;560;569;568;555;545;545;529;517","0;0;0;0;0;0;0;0;0;0;0;0;25;55;84;111;141;178;219;268;322;367;427;481","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,647,0.018402104129860652],["MAT","0060 2 STILLORGAN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","857;1735;2575;3594;4652;5345;6295;7139;8043;8868;9764;10528;10574;10508;10446;10308;9947;9964;9880;9826;9799;9815;9806;9735","25;57;75;108;149;175;225;242;268;304;331;359;360;363;372;372;363;374;353;377;394;390;399;418","0;0;0;0;0;0;0;0;0;0;0;0;25;57;75;108;149;175;225;242;268;304;331;359","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,702,0.01758559769354996],["MAT","0070 3 DUNDRUM",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","642;1274;1902;2594;3482;4278;5160;6130;7020;7907;9028;9950;10093;10264;10283;10534;10349;10140;9919;9543;9290;9088;8807;9545","26;48;81;102;139;154;183;210;235;259;281;307;313;324;313;340;407;466;555;600;667;738;827;871","0;0;0;0;0;0;0;0;0;0;0;0;26;48;81;102;139;154;183;210;235;259;281;307","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,660,0.017242375961472458],["MAT","0031 3 PTARLINGTON",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","738;1381;2144;3003;3789;4468;5333;5983;6959;7644;8325;9019;9193;9300;9024;9006;8942;9026;9028;9349;8940;8912;8919;8871","20;34;49;65;85;94;105;118;130;138;154;170;164;166;166;168;160;163;175;175;182;188;183;182","0;0;0;0;0;0;0;0;0;0;0;0;20;34;49;65;85;94;105;118;130;138;154;170","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,626,0.016024842027681736],["MAT","0029 2 TIPP TOWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","640;1370;2063;2818;3563;4106;4765;5462;6158;6796;7466;8208;8248;8195;8102;8054;7927;7979;8017;7993;7979;8040;8070;7962","40;76;112;149;186;215;252;292;329;360;401;445;439;435;436;452;467;468;474;470;478;486;489;480","0;0;0;0;0;0;0;0;0;0;0;0;40;76;112;149;186;215;252;292;329;360;401;445","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,745,0.014382797004216208],["MAT","0070 1 REST DUB 14",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","718;1325;1981;2706;3384;4093;4743;5444;6120;6678;7343;7982;7951;7868;7792;7644;7573;7407;7387;7319;7291;7311;7241;7180","27;57;92;123;161;199;239;269;312;341;382;411;419;420;426;418;418;406;390;393;384;383;372;369","0;0;0;0;0;0;0;0;0;0;0;0;27;57;92;123;161;199;239;269;312;341;382;411","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,701,0.012970168612191958],["MAT","0029 4 CASHEL",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","572;946;1281;1661;2066;2405;2748;3143;3523;3977;4388;4733;4544;4547;4599;4624;4608;4606;4641;4646;4657;4574;4610;4655","16;24;39;53;61;73;88;104;127;158;189;213;220;232;241;250;276;282;296;299;300;288;279;278","0;0;0;0;0;0;0;0;0;0;0;0;16;24;39;53;61;73;88;104;127;158;189;213","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,743,0.008408932435898825]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MAT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 355\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 355 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MAT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 355\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MAT",null,null,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153","2758;4721;6645;8753;11818;13832;15990;18274;20520;22801;25107;27153;26838;27011;27188;27305;26543;26655;26721;26661;26698;26694;26761;26891","50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578",null],["National","MAT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;10558;20531;30623;41258;52781;62852;74756;85806;97132;108342;119760;130834","10558;20531;30623;41258;52781;62852;74756;85806;97132;108342;119760;130834;131980;133780;134753;136419;136786;137637;137385;138266;138485;139074;139568;140152","214544;433390;652404;866924;1095258;1292150;1507985;1720055;1943670;2152862;2374098;2577815;2594896;2583198;2562741;2561133;2541729;2530183;2529808;2518568;2499043;2495873;2490611;2489906",null]]},"SELECT \r\nCASE WHEN 'Month' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='355' ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'Month' ='Srv. QTR' \r\nTHEN  ' - Sales/Target (%): '\r\n ELSE ' '\r\nEND\r\n as value ":{"columns":["VALUE"],"data":[[" "]]},"SELECT \r\nCASE WHEN 'Month' ='MQT' \r\nTHEN  'Growth vs 3 previous month'\r\n ELSE \r\nCASE WHEN 'Month' ='Month' \r\nTHEN  'Growth vs previous month'\r\nELSE 'Growth vs previous year'\r\nEND END\r\n as value\r\n ":{"columns":["VALUE"],"data":[["Growth vs previous month"]]},"Select DISTINCT \r\n''  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.marketSalesUnit marketSalesUnitT ,\r\nfsB.MarketSalesUnit marketSalesUnitB,\r\nFsb.SalesUnit SalesUnitB  ,\r\nFsb.SalesUnitPY,\r\nFsT.SalesUnit SalesUnitT,\r\n  --Fsb.SalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.marketSalesUnitLastMonth<>0 and fsT.marketSalesUnitLastMonth is not null then (fsB.MarketSalesUnitLastMonth /fsT.marketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 355\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 355\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 355 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","SALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["","0061 1 DUN LAOIRE",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","4527;4541;4538;4680;4940;4076;4312;4832;4528;4213;4550;4182;4145;4491;3986;4518;4171;3577;4325;4369;4268;4139;4399;3912","120;131;139;157;154;136;154;190;128;181;155;164;159;139;159;150;153;157;172;174;171;176;187;153","0;0;0;0;0;0;0;0;0;0;0;0;120;131;139;157;154;136;154;190;128;181;155;164","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,682,0.08574058650769298],["","0030 2 WATERFD CTY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","5571;4036;4072;3310;6027;3706;4134;4628;4255;3865;4530;3710;4422;3380;3601;3374;4493;3335;3922;3468;3871;3563;3958;3712","1100;216;172;167;1209;329;286;360;345;342;361;122;328;110;144;116;107;126;94;107;112;105;124;107","0;0;0;0;0;0;0;0;0;0;0;0;1100;216;172;167;1209;329;286;360;345;342;361;122","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,709,0.08135712093981502],["","0033 1 K/KENNY CO",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2499;2081;2232;2116;2861;1773;2492;2332;2334;2306;2777;2405;2576;2144;2130;2188;2602;2089;2221;2414;2195;2503;2456;2424","35;42;42;46;34;46;45;36;61;45;44;50;60;50;52;70;59;44;51;49;75;42;65;48","0;0;0;0;0;0;0;0;0;0;0;0;35;42;42;46;34;46;45;36;61;45;44;50","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,635,0.05312760268268093],["","0029 1 REST S TIPP",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2285;3634;2312;2224;2500;2008;2227;2348;2153;2203;2381;2052;2242;2276;2150;2169;2287;1835;2433;2054;2270;2155;2399;2058","119;141;120;126;131;125;121;129;111;121;128;119;122;124;129;138;151;106;138;139;117;134;127;127","0;0;0;0;0;0;0;0;0;0;0;0;119;141;120;126;131;125;121;129;111;121;128;119","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,691,0.04510586069346425],["","0030 1 RST WATERFD",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2107;2089;2095;2105;2502;1856;1898;1989;2272;2250;2004;1809;2491;1861;1921;1938;2105;1595;2335;1752;1754;2055;1983;2003","45;63;50;58;64;56;72;59;65;70;80;51;61;82;62;65;83;63;70;61;79;60;93;67","0;0;0;0;0;0;0;0;0;0;0;0;45;63;50;58;64;56;72;59;65;70;80;51","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,641,0.04390040766229781],["","0035 1 RST WEXFORD",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2526;2245;2310;2580;2558;2101;2112;2021;2180;1943;2118;2064;2358;2013;1907;2184;1836;1688;2142;1868;1960;1907;2062;1818","95;121;112;124;107;122;113;120;128;116;135;125;144;142;121;137;132;128;130;128;125;134;141;125","0;0;0;0;0;0;0;0;0;0;0;0;95;121;112;124;107;122;113;120;128;116;135;125","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,759,0.039845702012010695],["","0034 1 CARLOW COUNTY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1674;1810;1894;1666;1841;1353;1926;1641;1750;1643;1782;1936;1754;1739;1517;1874;1683;1671;1863;1539;1710;1816;1758;1806","47;66;70;63;55;51;57;59;71;51;55;59;109;65;64;66;59;77;69;49;60;55;52;54","0;0;0;0;0;0;0;0;0;0;0;0;47;66;70;63;55;51;57;59;71;51;55;59","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,665,0.03958269407793802],["","0032 1 RST WICKLOW",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1888;3898;1850;1634;1869;1745;1701;2009;1778;1826;1989;1765;1895;1986;1824;1860;1927;1832;2160;1848;1932;2199;2084;1765","95;149;123;174;144;134;149;166;151;169;134;150;175;133;148;144;162;130;152;167;138;165;149;142","0;0;0;0;0;0;0;0;0;0;0;0;95;149;123;174;144;134;149;166;151;169;134;150","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,746,0.03868408363652304],["","0033 2 K/KENNY TWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1954;1783;2064;1940;2584;1709;2306;1915;2200;1770;2216;1892;1875;1878;1933;1907;1717;1628;1894;1795;1815;1790;2055;1717","36;42;49;54;47;47;40;45;30;60;54;45;50;56;52;48;55;73;62;72;75;79;69;60","0;0;0;0;0;0;0;0;0;0;0;0;36;42;49;54;47;47;40;45;30;60;54;45","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,638,0.037632051900232326],["","0035 2 WEXFORD TWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1928;2079;1992;1988;1933;1639;1931;1857;1985;1685;1776;1708;1734;1862;1597;1778;1739;1548;1756;1674;1724;1581;1715;1683","143;116;126;128;126;111;129;129;130;130;145;138;132;166;133;151;150;143;151;157;164;136;146;148","0;0;0;0;0;0;0;0;0;0;0;0;143;116;126;128;126;111;129;129;130;130;145;138","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,713,0.036886862753693066],["","0035 3 ENNISCORTHY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1416;1546;1605;1526;1745;1540;1570;1613;1739;1429;1704;1792;1523;1540;1371;1485;1529;1466;1422;1533;1521;1492;1607;1672","97;99;100;103;124;87;118;120;152;136;117;129;161;136;137;150;127;149;126;144;142;155;148;131","0;0;0;0;0;0;0;0;0;0;0;0;97;99;100;103;124;87;118;120;152;136;117;129","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,656,0.03664577214745978],["","0070 3 DUNDRUM",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","642;632;628;692;888;796;882;970;890;887;1121;922;785;803;647;943;703;587;661;594;637;685;840;1660","26;22;33;21;37;15;29;27;25;24;22;26;32;33;22;48;104;74;118;72;92;95;111;70","0;0;0;0;0;0;0;0;0;0;0;0;26;22;33;21;37;15;29;27;25;24;22;26","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,660,0.036382764213387105],["","0032 4 BRAY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1617;1573;1951;1725;1856;1806;1751;1736;1855;1773;1709;1367;1678;1561;1550;1588;1610;1453;1610;1485;1500;1632;1591;1517","69;58;72;89;80;64;80;91;70;83;75;83;96;94;80;86;120;92;87;98;89;95;79;105","0;0;0;0;0;0;0;0;0;0;0;0;69;58;72;89;80;64;80;91;70;83;75;83","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,676,0.033248586332354356],["","0031 1 REST LAOIS",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1333;1459;1386;1368;1477;1147;1487;1484;1217;1439;1357;1399;1244;1348;1218;1362;1432;1001;1346;1347;1300;1351;1395;1451","45;41;47;45;40;46;54;48;43;48;39;56;47;49;44;47;55;48;49;49;47;41;59;52","0;0;0;0;0;0;0;0;0;0;0;0;45;41;47;45;40;46;54;48;43;48;39;56","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,688,0.03180204269495463],["","0031 2 PORTLAOISE",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1528;1512;1465;1333;1696;1240;1465;1493;1391;1557;1502;1412;1780;1520;1341;1482;1457;1323;1532;1475;1429;1349;1444;1403","23;23;26;25;28;25;32;30;37;28;31;28;30;31;30;31;31;37;30;30;25;26;27;26","0;0;0;0;0;0;0;0;0;0;0;0;23;23;26;25;28;25;32;30;37;28;31;28","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,664,0.03075001095866392],["","0034 2 CARLOW TOWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1822;1658;1948;1608;1724;1826;1579;1479;1732;1525;1557;1710;1479;1626;1580;1533;1272;1369;1349;1468;1396;1395;1507;1361","23;22;15;26;26;29;22;24;27;29;23;21;30;31;56;24;31;28;30;40;36;25;36;34","0;0;0;0;0;0;0;0;0;0;0;0;23;22;15;26;26;29;22;24;27;29;23;21","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,742,0.029829483189409547],["","0029 3 CLONMEL",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1540;1556;1633;1509;1709;1511;1484;1472;1589;1520;1773;1449;1400;1622;1432;1538;1412;1273;1520;1379;1414;1457;1497;1298","81;77;85;75;79;78;83;80;78;80;84;79;90;92;77;94;111;67;85;84;91;82;97;66","0;0;0;0;0;0;0;0;0;0;0;0;81;77;85;75;79;78;83;80;78;80;84;79","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,692,0.028448691535527988],["","0060 1 BLACKROCK",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1479;1661;1591;1628;1618;1408;1669;1388;1602;1390;1577;1395;1545;1450;1410;1521;1373;1208;1370;1331;1415;1305;1352;1286","72;88;76;96;83;76;87;80;78;74;67;82;89;80;85;84;85;86;77;75;81;97;88;73","0;0;0;0;0;0;0;0;0;0;0;0;72;88;76;96;83;76;87;80;78;74;67;82","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,721,0.02818568360145531],["","0068 1 DUBLIN 4",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1355;1409;1377;1444;1391;1283;1262;1371;1414;1359;1499;1083;1413;1303;1213;1406;1249;1205;1229;1264;1187;1280;1244;1185","95;74;75;104;87;72;86;79;80;81;82;73;99;86;81;94;62;75;57;73;67;84;73;71","0;0;0;0;0;0;0;0;0;0;0;0;95;74;75;104;87;72;86;79;80;81;82;73","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,666,0.025972033489676936],["","0035 5 GOREY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1017;1159;1190;1113;1091;1304;1151;1272;1268;1100;1307;1449;1299;1183;1024;1156;1291;1109;1305;1226;1214;1273;1383;1128","22;19;34;37;27;21;16;29;30;23;31;32;42;20;23;24;25;30;25;35;29;41;38;42","0;0;0;0;0;0;0;0;0;0;0;0;22;19;34;37;27;21;16;29;30;23;31;32","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,697,0.02472274580283172],["","0032 5 GREYSTONES",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1216;1312;1193;1327;1246;1095;1322;1193;1300;1244;1244;985;1038;1025;944;1104;986;942;1090;1060;1030;1044;1093;1114","37;28;44;47;42;52;36;46;63;35;50;39;39;31;36;55;51;38;70;48;50;52;52;60","0;0;0;0;0;0;0;0;0;0;0;0;37;28;44;47;42;52;36;46;63;35;50;39","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,699,0.02441590321308026],["","0032 3 ARKLOW",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","971;1041;992;1039;979;939;1026;1041;1057;961;1064;1014;1016;1067;989;1158;985;960;1113;1127;1065;1018;1128;1069","61;53;49;63;57;43;46;53;54;48;61;48;44;66;63;77;57;57;68;70;66;79;68;77","0;0;0;0;0;0;0;0;0;0;0;0;61;53;49;63;57;43;46;53;54;48;61;48","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,640,0.02342962346030772],["","0035 4 NEW ROSS",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1071;1236;1213;1255;1341;921;1110;1293;1129;1154;1208;1017;1326;1040;1003;1152;1090;868;1134;923;1050;964;899;1015","41;48;41;37;38;38;32;42;39;43;44;42;45;52;40;39;45;44;43;46;58;57;58;72","0;0;0;0;0;0;0;0;0;0;0;0;41;48;41;37;38;38;32;42;39;43;44;42","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,690,0.022246087756980667],["","0018 1 DUBLIN 2",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1045;1147;972;1122;982;973;957;989;1114;1036;945;967;1109;969;825;1131;1437;1075;1076;1039;995;988;1158;946","54;50;52;55;46;42;47;51;35;54;50;59;49;58;60;73;54;61;57;58;56;61;68;60","0;0;0;0;0;0;0;0;0;0;0;0;54;50;52;55;46;42;47;51;35;54;50;59","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,662,0.02073379213606277],["","0030 3 DUNGARVAN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","891;967;946;888;834;719;811;1081;719;784;752;1102;1005;878;882;897;745;809;816;799;807;893;862;853","24;24;24;30;26;18;30;26;20;30;23;31;24;24;19;31;25;24;25;21;29;24;31;18","0;0;0;0;0;0;0;0;0;0;0;0;24;24;24;30;26;18;30;26;20;30;23;31","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,730,0.018695480646999517],["","0032 2 WICKLOW TWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","908;845;889;688;1099;672;764;823;843;881;843;767;823;711;835;845;877;853;909;827;891;891;896;829","25;30;29;27;30;37;41;49;54;45;60;54;54;52;40;33;41;46;40;36;44;45;44;42","0;0;0;0;0;0;0;0;0;0;0;0;25;30;29;27;30;37;41;49;54;45;60;54","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,647,0.01816946477885416],["","0060 2 STILLORGAN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","857;878;840;1019;1058;693;950;844;904;825;896;764;903;812;778;881;697;710;866;790;877;841;887;693","25;32;18;33;41;26;50;17;26;36;27;28;26;35;27;33;32;37;29;41;43;32;36;47","0;0;0;0;0;0;0;0;0;0;0;0;25;32;18;33;41;26;50;17;26;36;27;28","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,702,0.015188708192697147],["","0031 3 PTARLINGTON",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","738;643;763;859;786;679;865;650;976;685;681;694;912;750;487;841;722;763;867;971;567;657;688;646","20;14;15;16;20;9;11;13;12;8;16;16;14;16;15;18;12;12;23;13;19;14;11;15","0;0;0;0;0;0;0;0;0;0;0;0;20;14;15;16;20;9;11;13;12;8;16;16","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,626,0.014158593784245823],["","0029 2 TIPP TOWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","640;730;693;755;745;543;659;697;696;638;670;742;680;677;600;707;618;595;697;673;682;699;700;634","40;36;36;37;37;29;37;40;37;31;41;44;34;32;37;53;52;30;43;36;45;39;44;35","0;0;0;0;0;0;0;0;0;0;0;0;40;36;36;37;37;29;37;40;37;31;41;44","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,745,0.013895585850173146],["","0070 1 REST DUB 14",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","718;607;656;725;678;709;650;701;676;558;665;639;687;524;580;577;607;543;630;633;648;578;595;578","27;30;35;31;38;38;40;30;43;29;41;29;35;31;41;23;38;26;24;33;34;28;30;26","0;0;0;0;0;0;0;0;0;0;0;0;27;30;35;31;38;38;40;30;43;29;41;29","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,701,0.012668215491167315],["","0029 4 CASHEL",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","572;374;335;380;405;339;343;395;380;454;411;345;383;377;387;405;389;337;378;400;391;371;447;390","16;8;15;14;8;12;15;16;23;31;31;24;23;20;24;23;34;18;29;19;24;19;22;23","0;0;0;0;0;0;0;0;0;0;0;0;16;8;15;14;8;12;15;16;23;31;31;24","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","2758;1963;3887;5995;3065;5079;7237;2284;4530;6811;2306;4352;6795;2136;4237;6462;2303;4429;6653;2224;4507;6784;2373;4549",4672,null,null,null,null,743,0.00854775785736203]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 355\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 355 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 355\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 355\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","",null,null,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626",null],["National","",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;10558;9973;10092;10635;11523;10071;11904;11050;11326;11210;11418;11074","10558;9973;10092;10635;11523;10071;11904;11050;11326;11210;11418;11074;11704;11773;11065;12301;11890;10922;11652;11931;11545;11799;11912;11658","214544;218846;219014;214520;228334;196892;215835;212070;223615;209192;221236;203717;231625;207148;198557;212912;208930;185346;215460;200830;204090;206022;215974;203012",null]]},"SELECT \r\nCASE WHEN 'Month' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='364' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n''  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.marketSalesUnit marketSalesUnitT ,\r\nfsB.MarketSalesUnit marketSalesUnitB,\r\nFsb.SalesUnit SalesUnitB  ,\r\nFsb.SalesUnitPY,\r\nFsT.SalesUnit SalesUnitT,\r\n  --Fsb.SalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.marketSalesUnitLastMonth<>0 and fsT.marketSalesUnitLastMonth is not null then (fsB.MarketSalesUnitLastMonth /fsT.marketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 364\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 364\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 364 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","SALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["","0061 1 DUN LAOIRE",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","4527;4541;4538;4680;4940;4076;4312;4832;4528;4213;4550;4182;4145;4491;3986;4518;4171;3577;4325;4369;4268;4139;4399;3912","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;8;19;19;19;19;29;18;19;28","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,682,0.08574058650769298],["","0030 2 WATERFD CTY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","5571;4036;4072;3310;6027;3706;4134;4628;4255;3865;4530;3710;4422;3380;3601;3374;4493;3335;3922;3468;3871;3563;3958;3712","0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;0;2;5;9;3;14;13;7;15","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,709,0.08135712093981502],["","0033 1 K/KENNY CO",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2499;2081;2232;2116;2861;1773;2492;2332;2334;2306;2777;2405;2576;2144;2130;2188;2602;2089;2221;2414;2195;2503;2456;2424","0;0;0;0;0;0;0;0;0;0;0;0;0;4;3;3;1;2;6;6;12;13;16;19","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,635,0.05312760268268093],["","0029 1 REST S TIPP",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2285;3634;2312;2224;2500;2008;2227;2348;2153;2203;2381;2052;2242;2276;2150;2169;2287;1835;2433;2054;2270;2155;2399;2058","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;1;7;4;2;3","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,691,0.04510586069346425],["","0030 1 RST WATERFD",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2107;2089;2095;2105;2502;1856;1898;1989;2272;2250;2004;1809;2491;1861;1921;1938;2105;1595;2335;1752;1754;2055;1983;2003","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;2;1;2;3","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,641,0.04390040766229781],["","0035 1 RST WEXFORD",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","2526;2245;2310;2580;2558;2101;2112;2021;2180;1943;2118;2064;2358;2013;1907;2184;1836;1688;2142;1868;1960;1907;2062;1818","0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;3;3;12;9;13;12;9;11;11","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,759,0.039845702012010695],["","0034 1 CARLOW COUNTY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1674;1810;1894;1666;1841;1353;1926;1641;1750;1643;1782;1936;1754;1739;1517;1874;1683;1671;1863;1539;1710;1816;1758;1806","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,665,0.03958269407793802],["","0032 1 RST WICKLOW",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1888;3898;1850;1634;1869;1745;1701;2009;1778;1826;1989;1765;1895;1986;1824;1860;1927;1832;2160;1848;1932;2199;2084;1765","0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;1;6;2;11;4;4;6;14;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,746,0.03868408363652304],["","0033 2 K/KENNY TWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1954;1783;2064;1940;2584;1709;2306;1915;2200;1770;2216;1892;1875;1878;1933;1907;1717;1628;1894;1795;1815;1790;2055;1717","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;9;7;9;6;8;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,638,0.037632051900232326],["","0035 2 WEXFORD TWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1928;2079;1992;1988;1933;1639;1931;1857;1985;1685;1776;1708;1734;1862;1597;1778;1739;1548;1756;1674;1724;1581;1715;1683","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;3;5;3;3;1;2;2;3","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,713,0.036886862753693066],["","0035 3 ENNISCORTHY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1416;1546;1605;1526;1745;1540;1570;1613;1739;1429;1704;1792;1523;1540;1371;1485;1529;1466;1422;1533;1521;1492;1607;1672","0;0;0;0;0;0;0;0;0;0;0;0;0;5;1;14;9;12;15;14;21;11;16;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,656,0.03664577214745978],["","0070 3 DUNDRUM",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","642;632;628;692;888;796;882;970;890;887;1121;922;785;803;647;943;703;587;661;594;637;685;840;1660","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;2;4;4;3;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,660,0.036382764213387105],["","0032 4 BRAY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1617;1573;1951;1725;1856;1806;1751;1736;1855;1773;1709;1367;1678;1561;1550;1588;1610;1453;1610;1485;1500;1632;1591;1517","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;2;5;3;3;7;8;9;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,676,0.033248586332354356],["","0031 1 REST LAOIS",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1333;1459;1386;1368;1477;1147;1487;1484;1217;1439;1357;1399;1244;1348;1218;1362;1432;1001;1346;1347;1300;1351;1395;1451","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;1;4;5;4","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,688,0.03180204269495463],["","0031 2 PORTLAOISE",1,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1528;1512;1465;1333;1696;1240;1465;1493;1391;1557;1502;1412;1780;1520;1341;1482;1457;1323;1532;1475;1429;1349;1444;1403","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,664,0.03075001095866392],["","0034 2 CARLOW TOWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1822;1658;1948;1608;1724;1826;1579;1479;1732;1525;1557;1710;1479;1626;1580;1533;1272;1369;1349;1468;1396;1395;1507;1361","0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;3;3;1;2;0;5;2;3;6","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,742,0.029829483189409547],["","0029 3 CLONMEL",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1540;1556;1633;1509;1709;1511;1484;1472;1589;1520;1773;1449;1400;1622;1432;1538;1412;1273;1520;1379;1414;1457;1497;1298","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;0;2;1;3;2;2","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,692,0.028448691535527988],["","0060 1 BLACKROCK",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1479;1661;1591;1628;1618;1408;1669;1388;1602;1390;1577;1395;1545;1450;1410;1521;1373;1208;1370;1331;1415;1305;1352;1286","0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;1;2;4;4;2;2;7;4;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,721,0.02818568360145531],["","0068 1 DUBLIN 4",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1355;1409;1377;1444;1391;1283;1262;1371;1414;1359;1499;1083;1413;1303;1213;1406;1249;1205;1229;1264;1187;1280;1244;1185","0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;6;3;10;4;13;5;11;6;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,666,0.025972033489676936],["","0035 5 GOREY",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1017;1159;1190;1113;1091;1304;1151;1272;1268;1100;1307;1449;1299;1183;1024;1156;1291;1109;1305;1226;1214;1273;1383;1128","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;9;5;8;6;11;7;16;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,697,0.02472274580283172],["","0032 5 GREYSTONES",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1216;1312;1193;1327;1246;1095;1322;1193;1300;1244;1244;985;1038;1025;944;1104;986;942;1090;1060;1030;1044;1093;1114","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;4;1;4;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,699,0.02441590321308026],["","0032 3 ARKLOW",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","971;1041;992;1039;979;939;1026;1041;1057;961;1064;1014;1016;1067;989;1158;985;960;1113;1127;1065;1018;1128;1069","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;3;1;1;2;1;1;1;3;2","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,640,0.02342962346030772],["","0035 4 NEW ROSS",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1071;1236;1213;1255;1341;921;1110;1293;1129;1154;1208;1017;1326;1040;1003;1152;1090;868;1134;923;1050;964;899;1015","0;0;0;0;0;0;0;0;0;0;0;0;0;1;0;0;0;3;6;1;1;2;3;2","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,690,0.022246087756980667],["","0018 1 DUBLIN 2",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","1045;1147;972;1122;982;973;957;989;1114;1036;945;967;1109;969;825;1131;1437;1075;1076;1039;995;988;1158;946","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;2;2;2;5;1;2;3","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,662,0.02073379213606277],["","0030 3 DUNGARVAN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","891;967;946;888;834;719;811;1081;719;784;752;1102;1005;878;882;897;745;809;816;799;807;893;862;853","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;0;1;1;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,730,0.018695480646999517],["","0032 2 WICKLOW TWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","908;845;889;688;1099;672;764;823;843;881;843;767;823;711;835;845;877;853;909;827;891;891;896;829","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;8;0;1;2;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,647,0.01816946477885416],["","0060 2 STILLORGAN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","857;878;840;1019;1058;693;950;844;904;825;896;764;903;812;778;881;697;710;866;790;877;841;887;693","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;1;2;1;1;1;3;4","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,702,0.015188708192697147],["","0031 3 PTARLINGTON",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","738;643;763;859;786;679;865;650;976;685;681;694;912;750;487;841;722;763;867;971;567;657;688;646","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,626,0.014158593784245823],["","0029 2 TIPP TOWN",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","640;730;693;755;745;543;659;697;696;638;670;742;680;677;600;707;618;595;697;673;682;699;700;634","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,745,0.013895585850173146],["","0070 1 REST DUB 14",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","718;607;656;725;678;709;650;701;676;558;665;639;687;524;580;577;607;543;630;633;648;578;595;578","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,701,0.012668215491167315],["","0029 4 CASHEL",null,"50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","572;374;335;380;405;339;343;395;380;454;411;345;383;377;387;405;389;337;378;400;391;371;447;390","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;2;0;0;1;1;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,743,0.00854775785736203]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 364\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 364 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 364\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","",null,1,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626",null],["National","",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;96;87;198;247;345;459;458;529;518;634;573","214544;218846;219014;214520;228334;196892;215835;212070;223615;209192;221236;203717;231625;207148;198557;212912;208930;185346;215460;200830;204090;206022;215974;203012",null]]},"SELECT \r\nCASE WHEN 'MAT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='364' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'MAT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MATmarketSalesUnit marketSalesUnitT ,\r\nfsB.MATMarketSalesUnit marketSalesUnitB,\r\nFsb.MATSalesUnit SalesUnitB  ,\r\nFsb.MATSalesUnitPY,\r\nFsT.MATSalesUnit SalesUnitT,\r\n  --Fsb.MATSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MATmarketSalesUnitLastMonth<>0 and fsT.MATmarketSalesUnitLastMonth is not null then (fsB.MATMarketSalesUnitLastMonth /fsT.MATmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 364\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 364\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 364 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MATSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MAT","0061 1 DUN LAOIRE",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","4527;9068;13606;18286;23226;27302;31614;36446;40974;45187;49737;53919;53537;53487;52935;52773;52004;51505;51518;51055;50795;50721;50570;50300","0;0;0;0;0;0;0;0;0;0;0;0;0;5;11;19;38;57;76;95;124;142;161;189","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,682,0.09086343749209687],["MAT","0030 2 WATERFD CTY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","5571;9607;13679;16989;23016;26722;30856;35484;39739;43604;48134;51844;50695;50039;49568;49632;48098;47727;47515;46355;45971;45669;45097;45099","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;6;11;20;23;37;50;57;72","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,709,0.08146819418401743],["MAT","0033 1 K/KENNY CO",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2499;4580;6812;8928;11789;13562;16054;18386;20720;23026;25803;28208;28285;28348;28246;28318;28059;28375;28104;28186;28047;28244;27923;27942","0;0;0;0;0;0;0;0;0;0;0;0;0;4;7;10;11;13;19;25;37;50;66;85","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,635,0.0504752717774189],["MAT","0029 1 REST S TIPP",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2285;5919;8231;10455;12955;14963;17190;19538;21691;23894;26275;28327;28284;26926;26764;26709;26496;26323;26529;26235;26352;26304;26322;26328","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;5;6;13;17;19;22","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,691,0.04755969348492895],["MAT","0030 1 RST WATERFD",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2107;4196;6291;8396;10898;12754;14652;16641;18913;21163;23167;24976;25360;25132;24958;24791;24394;24133;24570;24333;23815;23620;23599;23793","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;5;7;10","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,641,0.04298039300694753],["MAT","0035 1 RST WEXFORD",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","2526;4771;7081;9661;12219;14320;16432;18453;20633;22576;24694;26758;26590;26358;25955;25559;24837;24424;24454;24301;24081;24045;23989;23743","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;7;10;22;31;44;56;65;76;87","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,759,0.042890071498506085],["MAT","0032 1 RST WICKLOW",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1888;5786;7636;9270;11139;12884;14585;16594;18372;20198;22187;23952;23959;22047;22021;22247;22305;22392;22851;22690;22844;23217;23312;23312","0;0;0;0;0;0;0;0;0;0;0;0;0;2;6;7;13;15;26;30;34;40;54;59","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,746,0.0421115000957408],["MAT","0033 2 K/KENNY TWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1954;3737;5801;7741;10325;12034;14340;16255;18455;20225;22441;24333;24254;24349;24218;24185;23318;23237;22825;22705;22320;22340;22179;22004","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;8;17;24;33;39;47;56","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,638,0.03974868943491251],["MAT","0034 1 CARLOW COUNTY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1674;3484;5378;7044;8885;10238;12164;13805;15555;17198;18980;20916;20996;20925;20548;20756;20598;20916;20853;20751;20711;20884;20860;20730","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,665,0.037447297399824414],["MAT","0035 2 WEXFORD TWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1928;4007;5999;7987;9920;11559;13490;15347;17332;19017;20793;22501;22307;22090;21695;21485;21291;21200;21025;20842;20581;20477;20416;20391","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;9;14;17;20;21;23;25;28","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,713,0.03683491757259139],["MAT","0032 4 BRAY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1617;3190;5141;6866;8722;10528;12279;14015;15870;17643;19352;20719;20780;20768;20367;20230;19984;19631;19490;19239;18884;18743;18625;18775","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;8;13;16;19;26;34;43;52","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,676,0.03391572641976379],["MAT","0035 3 ENNISCORTHY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1416;2962;4567;6093;7838;9378;10948;12561;14300;15729;17433;19225;19332;19326;19092;19051;18835;18761;18613;18533;18315;18378;18281;18161","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;20;29;41;56;70;91;102;118;134","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,656,0.032806578296102805],["MAT","0031 2 PORTLAOISE",1,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1528;3040;4505;5838;7534;8774;10239;11732;13123;14680;16182;17594;17846;17854;17730;17879;17640;17723;17790;17772;17810;17602;17544;17535","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,1,1,1,1,664,0.03167575301041588],["MAT","0034 2 CARLOW TOWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1822;3480;5428;7036;8760;10586;12165;13644;15376;16901;18458;20168;19825;19793;19425;19350;18898;18441;18211;18200;17864;17734;17684;17335","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;5;8;9;11;11;16;18;21;27","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,742,0.031314466976650086],["MAT","0029 3 CLONMEL",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1540;3096;4729;6238;7947;9458;10942;12414;14003;15523;17296;18745;18605;18671;18470;18499;18202;17964;18000;17907;17732;17669;17393;17242","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;4;6;7;10;12;14","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,692,0.03114646897094899],["MAT","0060 1 BLACKROCK",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1479;3140;4731;6359;7977;9385;11054;12442;14044;15434;17011;18406;18472;18261;18080;17973;17728;17528;17229;17172;16985;16900;16675;16566","0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;5;9;13;15;17;24;28;28","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,721,0.02992532217682061],["MAT","0031 1 REST LAOIS",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1333;2792;4178;5546;7023;8170;9657;11141;12358;13797;15154;16553;16464;16353;16185;16179;16134;15988;15847;15710;15793;15705;15743;15795","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;7;12;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,688,0.02853256451665348],["MAT","0068 1 DUBLIN 4",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1355;2764;4141;5585;6976;8259;9521;10892;12306;13665;15164;16247;16305;16199;16035;15997;15855;15777;15744;15637;15410;15331;15076;15178","0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;10;13;23;27;40;45;56;62;67","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,666,0.02741799710248601],["MAT","0035 5 GOREY",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1017;2176;3366;4479;5570;6874;8025;9297;10565;11665;12972;14421;14703;14727;14561;14604;14804;14609;14763;14717;14663;14836;14912;14591","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;9;14;22;28;39;46;62;78","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,697,0.026357622593383406],["MAT","0018 1 DUBLIN 2",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1045;2192;3164;4286;5268;6241;7198;8187;9301;10337;11282;12249;12313;12135;11988;11997;12452;12554;12673;12723;12604;12556;12769;12748","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;2;3;5;7;9;14;15;17;20","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,662,0.023028371792231626],["MAT","0032 3 ARKLOW",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","971;2012;3004;4043;5022;5961;6987;8028;9085;10046;11110;12124;12169;12195;12192;12311;12317;12338;12425;12511;12519;12576;12640;12695","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;4;5;6;8;9;10;11;14;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,640,0.02293263099328369],["MAT","0032 5 GREYSTONES",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1216;2528;3721;5048;6294;7389;8711;9904;11204;12448;13692;14677;14499;14212;13963;13740;13480;13327;13095;12962;12692;12492;12341;12470","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;5;6;10;15","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,699,0.022526184205297176],["MAT","0035 4 NEW ROSS",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","1071;2307;3520;4775;6116;7037;8147;9440;10569;11723;12931;13948;14203;14007;13797;13694;13443;13390;13414;13044;12965;12775;12466;12464","0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;1;4;10;11;12;14;17;19","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,690,0.022515345624284203],["MAT","0030 3 DUNGARVAN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","891;1858;2804;3692;4526;5245;6056;7137;7856;8640;9392;10494;10608;10519;10455;10464;10375;10465;10470;10188;10276;10385;10495;10246","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;5;6;6;6;6","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,730,0.01850868350982156],["MAT","0032 2 WICKLOW TWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","908;1753;2642;3330;4429;5101;5865;6688;7531;8412;9255;10022;9937;9803;9749;9906;9684;9865;10010;10014;10062;10072;10125;10187","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;10;10;11;13;13","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,647,0.018402104129860652],["MAT","0060 2 STILLORGAN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","857;1735;2575;3594;4652;5345;6295;7139;8043;8868;9764;10528;10574;10508;10446;10308;9947;9964;9880;9826;9799;9815;9806;9735","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;5;7;8;9;10;13;17","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,702,0.01758559769354996],["MAT","0070 3 DUNDRUM",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","642;1274;1902;2594;3482;4278;5160;6130;7020;7907;9028;9950;10093;10264;10283;10534;10349;10140;9919;9543;9290;9088;8807;9545","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;8;12;15;24","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,660,0.017242375961472458],["MAT","0031 3 PTARLINGTON",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","738;1381;2144;3003;3789;4468;5333;5983;6959;7644;8325;9019;9193;9300;9024;9006;8942;9026;9028;9349;8940;8912;8919;8871","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,626,0.016024842027681736],["MAT","0029 2 TIPP TOWN",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","640;1370;2063;2818;3563;4106;4765;5462;6158;6796;7466;8208;8248;8195;8102;8054;7927;7979;8017;7993;7979;8040;8070;7962","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,745,0.014382797004216208],["MAT","0070 1 REST DUB 14",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","718;1325;1981;2706;3384;4093;4743;5444;6120;6678;7343;7982;7951;7868;7792;7644;7573;7407;7387;7319;7291;7311;7241;7180","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,701,0.012970168612191958],["MAT","0029 4 CASHEL",null,"50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578","572;946;1281;1661;2066;2405;2748;3143;3523;3977;4388;4733;4544;4547;4599;4624;4608;4606;4641;4646;4657;4574;4610;4655","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;3;3;3;4;5;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,743,0.008408932435898825]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MAT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 364\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 364 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MAT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 364\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MAT",1,1,7886,"H3",1,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","50335;102476;152101;200347;255310;299419;348215;397772;447698;494601;545209;591746;590931;585206;579243;578499;570577;567715;566890;562458;558047;557015;554489;553578",1],["National","MAT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;96;183;381;628;973;1432;1890;2419;2937;3571;4144","214544;433390;652404;866924;1095258;1292150;1507985;1720055;1943670;2152862;2374098;2577815;2594896;2583198;2562741;2561133;2541729;2530183;2529808;2518568;2499043;2495873;2490611;2489906",null]]},"SELECT \r\nCASE WHEN 'YTD' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='364' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'YTD'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.YTDmarketSalesUnit marketSalesUnitT ,\r\nfsB.YTDMarketSalesUnit marketSalesUnitB,\r\nFsb.YTDSalesUnit SalesUnitB  ,\r\nFsb.YTDSalesUnitPY,\r\nFsT.YTDSalesUnit SalesUnitT,\r\n  --Fsb.YTDSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.YTDmarketSalesUnitLastMonth<>0 and fsT.YTDmarketSalesUnitLastMonth is not null then (fsB.YTDMarketSalesUnitLastMonth /fsT.YTDmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 364\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 364\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 364 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","YTDSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["YTD","0061 1 DUN LAOIRE",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","4527;4541;9079;13759;18699;22775;27087;31919;36447;40660;45210;49392;53537;4491;8477;12995;17166;20743;25068;29437;33705;37844;42243;46155","0;0;0;0;0;0;0;0;0;0;0;0;0;5;11;19;38;57;76;95;124;142;161;189","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,682,0.09156684349816886],["YTD","0030 2 WATERFD CTY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","5571;4036;8108;11418;17445;21151;25285;29913;34168;38033;42563;46273;50695;3380;6981;10355;14848;18183;22105;25573;29444;33007;36965;40677","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;6;11;20;23;37;50;57;72","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,709,0.0806990465382952],["YTD","0033 1 K/KENNY CO",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2499;2081;4313;6429;9290;11063;13555;15887;18221;20527;23304;25709;28285;2144;4274;6462;9064;11153;13374;15788;17983;20486;22942;25366","0;0;0;0;0;0;0;0;0;0;0;0;0;4;7;10;11;13;19;25;37;50;66;85","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,635,0.05032357387443508],["YTD","0029 1 REST S TIPP",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2285;3634;5946;8170;10670;12678;14905;17253;19406;21609;23990;26042;28284;2276;4426;6595;8882;10717;13150;15204;17474;19629;22028;24086","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;5;6;13;17;19;22","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,691,0.047784183566176905],["YTD","0032 1 RST WICKLOW",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1888;3898;5748;7382;9251;10996;12697;14706;16484;18310;20299;22064;23959;1986;3810;5670;7597;9429;11589;13437;15369;17568;19652;21417","0;0;0;0;0;0;0;0;0;0;0;0;0;2;6;7;13;15;26;30;34;40;54;59","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,746,0.042489157993722944],["YTD","0035 1 RST WEXFORD",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2526;2245;4555;7135;9693;11794;13906;15927;18107;20050;22168;24232;26590;2013;3920;6104;7940;9628;11770;13638;15598;17505;19567;21385","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;7;10;22;31;44;56;65;76;87","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,759,0.04242567323601649],["YTD","0030 1 RST WATERFD",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","2107;2089;4184;6289;8791;10647;12545;14534;16806;19056;21060;22869;25360;1861;3782;5720;7825;9420;11755;13507;15261;17316;19299;21302","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;5;7;10","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,641,0.04226100964571537],["YTD","0033 2 K/KENNY TWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1954;1783;3847;5787;8371;10080;12386;14301;16501;18271;20487;22379;24254;1878;3811;5718;7435;9063;10957;12752;14567;16357;18412;20129","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;8;17;24;33;39;47;56","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,638,0.03993389649603815],["YTD","0034 1 CARLOW COUNTY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1674;1810;3704;5370;7211;8564;10490;12131;13881;15524;17306;19242;20996;1739;3256;5130;6813;8484;10347;11886;13596;15412;17170;18976","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,665,0.037646461319927466],["YTD","0035 2 WEXFORD TWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1928;2079;4071;6059;7992;9631;11562;13419;15404;17089;18865;20573;22307;1862;3459;5237;6976;8524;10280;11954;13678;15259;16974;18657","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;9;14;17;20;21;23;25;28","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,713,0.03701359764154125],["YTD","0032 4 BRAY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1617;1573;3524;5249;7105;8911;10662;12398;14253;16026;17735;19102;20780;1561;3111;4699;6309;7762;9372;10857;12357;13989;15580;17097","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;8;13;16;19;26;34;43;52","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,676,0.0339187157033516],["YTD","0035 3 ENNISCORTHY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1416;1546;3151;4677;6422;7962;9532;11145;12884;14313;16017;17809;19332;1540;2911;4396;5925;7391;8813;10346;11867;13359;14966;16638","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;20;29;41;56;70;91;102;118;134","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,656,0.033008106209999645],["YTD","0034 2 CARLOW TOWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1822;1658;3606;5214;6938;8764;10343;11822;13554;15079;16636;18346;19825;1626;3206;4739;6011;7380;8729;10197;11593;12988;14495;15856","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;5;8;9;11;11;16;18;21;27","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,742,0.03145669744354816],["YTD","0029 3 CLONMEL",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1540;1556;3189;4698;6407;7918;9402;10874;12463;13983;15756;17205;18605;1622;3054;4592;6004;7277;8797;10176;11590;13047;14544;15842","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;4;6;7;10;12;14","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,692,0.03142892286205159],["YTD","0031 2 PORTLAOISE",1,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1528;1512;2977;4310;6006;7246;8711;10204;11595;13152;14654;16066;17846;1520;2861;4343;5800;7123;8655;10130;11559;12908;14352;15755","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,1,1,1,1,664,0.031256323677037165],["YTD","0060 1 BLACKROCK",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1479;1661;3252;4880;6498;7906;9575;10963;12565;13955;15532;16927;18472;1450;2860;4381;5754;6962;8332;9663;11078;12383;13735;15021","0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;5;9;13;15;17;24;28;28","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,721,0.02980014204714537],["YTD","0031 1 REST LAOIS",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1333;1459;2845;4213;5690;6837;8324;9808;11025;12464;13821;15220;16464;1348;2566;3928;5360;6361;7707;9054;10354;11705;13100;14551","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;7;12;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,688,0.02886770966833182],["YTD","0068 1 DUBLIN 4",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1355;1409;2786;4230;5621;6904;8166;9537;10951;12310;13809;14892;16305;1303;2516;3922;5171;6376;7605;8869;10056;11336;12580;13765","0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;10;13;23;27;40;45;56;62;67","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,666,0.027308365307167033],["YTD","0035 5 GOREY",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1017;1159;2349;3462;4553;5857;7008;8280;9548;10648;11955;13404;14703;1183;2207;3363;4654;5763;7068;8294;9508;10781;12164;13292","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;9;14;22;28;39;46;62;78","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,697,0.026369981232318502],["YTD","0032 3 ARKLOW",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","971;1041;2033;3072;4051;4990;6016;7057;8114;9075;10139;11153;12169;1067;2056;3214;4199;5159;6272;7399;8464;9482;10610;11679","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;4;5;6;8;9;10;11;14;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,640,0.023169952664177536],["YTD","0018 1 DUBLIN 2",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1045;1147;2119;3241;4223;5196;6153;7142;8256;9292;10237;11204;12313;969;1794;2925;4362;5437;6513;7552;8547;9535;10693;11639","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;2;3;5;7;9;14;15;17;20","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,662,0.023090596717044467],["YTD","0032 5 GREYSTONES",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1216;1312;2505;3832;5078;6173;7495;8688;9988;11232;12476;13461;14499;1025;1969;3073;4059;5001;6091;7151;8181;9225;10318;11432","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;5;6;10;15","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,699,0.02267992969063084],["YTD","0035 4 NEW ROSS",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","1071;1236;2449;3704;5045;5966;7076;8369;9498;10652;11860;12877;14203;1040;2043;3195;4285;5153;6287;7210;8260;9224;10123;11138","0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;1;4;10;11;12;14;17;19","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,690,0.02209666347920279],["YTD","0032 2 WICKLOW TWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","908;845;1734;2422;3521;4193;4957;5780;6623;7504;8347;9114;9937;711;1546;2391;3268;4121;5030;5857;6748;7639;8535;9364","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;10;10;11;13;13","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,647,0.018577227223851224],["YTD","0030 3 DUNGARVAN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","891;967;1913;2801;3635;4354;5165;6246;6965;7749;8501;9603;10608;878;1760;2657;3402;4211;5027;5826;6633;7526;8388;9241","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;5;6;6;6;6","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,730,0.01833320768641704],["YTD","0060 2 STILLORGAN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","857;878;1718;2737;3795;4488;5438;6282;7186;8011;8907;9671;10574;812;1590;2471;3168;3878;4744;5534;6411;7252;8139;8832","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;5;7;8;9;10;13;17","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,702,0.01752179312698142],["YTD","0070 3 DUNDRUM",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","642;632;1260;1952;2840;3636;4518;5488;6378;7265;8386;9308;10093;803;1450;2393;3096;3683;4344;4938;5575;6260;7100;8760","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;8;12;15;24","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,660,0.017378952422141897],["YTD","0031 3 PTARLINGTON",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","738;643;1406;2265;3051;3730;4595;5245;6221;6906;7587;8281;9193;750;1237;2078;2800;3563;4430;5401;5968;6625;7313;7959","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,626,0.01578984958080221],["YTD","0029 2 TIPP TOWN",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","640;730;1423;2178;2923;3466;4125;4822;5518;6156;6826;7568;8248;677;1277;1984;2602;3197;3894;4567;5249;5948;6648;7282","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,745,0.014446750175575033],["YTD","0070 1 REST DUB 14",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","718;607;1263;1988;2666;3375;4025;4726;5402;5960;6625;7264;7951;524;1104;1681;2288;2831;3461;4094;4742;5320;5915;6493","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,701,0.012881454118375267],["YTD","0029 4 CASHEL",null,"50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058","572;374;709;1089;1494;1833;2176;2571;2951;3405;3816;4161;4544;377;764;1169;1558;1895;2273;2673;3064;3435;3882;4272","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;3;3;3;4;5;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,743,0.008475215153811664]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'YTD' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 364\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 364 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'YTD' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 364\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","YTD",1,1,7886,"H3",1,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;182;282;405;520;680;817;980;1159","50335;52141;101766;150012;204975;249084;297880;347437;397363;444266;494874;541411;590931;46416;90078;137580;184621;225868;273839;318964;364479;410350;458432;504058",1],["National","YTD",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;96;183;381;628;973;1432;1890;2419;2937;3571;4144","214544;218846;437860;652380;880714;1077606;1293441;1505511;1729126;1938318;2159554;2363271;2594896;207148;405705;618617;827547;1012893;1228353;1429183;1633273;1839295;2055269;2258281",null]]},"SELECT \r\nCASE WHEN 'MQT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='364' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'MQT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MQTmarketSalesUnit marketSalesUnitT ,\r\nfsB.MQTMarketSalesUnit marketSalesUnitB,\r\nFsb.MQTSalesUnit SalesUnitB  ,\r\nFsb.MQTSalesUnitPY,\r\nFsT.MQTSalesUnit SalesUnitT,\r\n  --Fsb.MQTSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MQTmarketSalesUnitLastMonth<>0 and fsT.MQTmarketSalesUnitLastMonth is not null then (fsB.MQTMarketSalesUnitLastMonth /fsT.MQTmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 364\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 364\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 364 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MQTSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MQT","0061 1 DUN LAOIRE",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","4527;9068;13606;13759;14158;13696;13328;13220;13672;13573;13291;12945;12877;12818;12622;12995;12675;12266;12073;12271;12962;12776;12806;12450","0;0;0;0;0;0;0;0;0;0;0;0;0;5;11;19;33;46;57;57;67;66;66;65","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,682,0.0891967989454001],["MQT","0030 2 WATERFD CTY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","5571;9607;13679;11418;13409;13043;13867;12468;13017;12748;12650;12105;12662;11512;11403;10355;11468;11202;11750;10725;11261;10902;11392;11233","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;2;7;16;17;26;30;34;35","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,709,0.08047772229346821],["MQT","0033 1 K/KENNY CO",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2499;4580;6812;6429;7209;6750;7126;6597;7158;6972;7417;7488;7758;7125;6850;6462;6920;6879;6912;6724;6830;7112;7154;7383","0;0;0;0;0;0;0;0;0;0;0;0;0;4;7;10;7;6;9;14;24;31;41;48","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,635,0.052894776434850514],["MQT","0029 1 REST S TIPP",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2285;5919;8231;8170;7036;6732;6735;6583;6728;6704;6737;6636;6675;6570;6668;6595;6606;6291;6555;6322;6757;6479;6824;6612","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;5;6;11;12;13;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,691,0.04737102286160526],["MQT","0032 1 RST WICKLOW",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1888;5786;7636;7382;5353;5248;5315;5455;5488;5613;5593;5580;5649;5646;5705;5670;5611;5619;5919;5840;5940;5979;6215;6048","0;0;0;0;0;0;0;0;0;0;0;0;0;2;6;7;11;9;19;17;19;14;24;25","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,746,0.0433303004033558],["MQT","0030 1 RST WATERFD",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2107;4196;6291;6289;6702;6463;6256;5743;6159;6511;6526;6063;6304;6161;6273;5720;5964;5638;6035;5682;5841;5561;5792;6041","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;3;5;6","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,641,0.04328014959270377],["MQT","0035 1 RST WEXFORD",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","2526;4771;7081;7135;7448;7239;6771;6234;6313;6144;6241;6125;6540;6435;6278;6104;5927;5708;5666;5698;5970;5735;5929;5787","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;7;6;18;24;34;34;34;32;31","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,759,0.041460391606187176],["MQT","0033 2 K/KENNY TWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1954;3737;5801;5787;6588;6233;6599;5930;6421;5885;6186;5878;5983;5645;5686;5718;5557;5252;5239;5317;5504;5400;5660;5562","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;8;15;20;25;22;23;23","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,638,0.03984840126380043],["MQT","0034 1 CARLOW COUNTY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1674;3484;5378;5370;5401;4860;5120;4920;5317;5034;5175;5361;5472;5429;5010;5130;5074;5228;5217;5073;5112;5065;5284;5380","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,665,0.03854448018684759],["MQT","0035 2 WEXFORD TWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1928;4007;5999;6059;5913;5560;5503;5427;5773;5527;5446;5169;5218;5304;5193;5237;5114;5065;5043;4978;5154;4979;5020;4979","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;9;14;11;11;7;6;5;7","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,713,0.035671555176638316],["MQT","0035 3 ENNISCORTHY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1416;2962;4567;4677;4876;4811;4855;4723;4922;4781;4872;4925;5019;4855;4434;4396;4385;4480;4417;4421;4476;4546;4620;4771","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;20;24;35;36;41;50;46;48;43","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,656,0.03418135966012079],["MQT","0032 4 BRAY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1617;3190;5141;5249;5532;5387;5413;5293;5342;5364;5337;4849;4754;4606;4789;4699;4748;4651;4673;4548;4595;4617;4723;4740","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;8;13;10;11;13;18;24;26","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,676,0.0339592632129475],["MQT","0034 2 CARLOW TOWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1822;3480;5428;5214;5280;5158;5129;4884;4790;4736;4814;4792;4746;4815;4685;4739;4385;4174;3990;4186;4213;4259;4298;4263","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;5;6;7;6;3;7;7;10;11","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,742,0.030541843687087598],["MQT","0029 3 CLONMEL",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1540;3096;4729;4698;4851;4729;4704;4467;4545;4581;4882;4742;4622;4471;4454;4592;4382;4223;4205;4172;4313;4250;4368;4252","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;4;4;3;6;6;7","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,692,0.03046303527034869],["MQT","0031 1 REST LAOIS",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1333;2792;4178;4213;4231;3992;4111;4118;4188;4140;4013;4195;4000;3991;3810;3928;4012;3795;3779;3694;3993;3998;4046;4197","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;7;10;13","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,688,0.030068993186654153],["MQT","0031 2 PORTLAOISE",1,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1528;3040;4505;4310;4494;4269;4401;4198;4349;4441;4450;4471;4694;4712;4641;4343;4280;4262;4312;4330;4436;4253;4222;4196","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,664,0.030061828785132434],["MQT","0060 1 BLACKROCK",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1479;3140;4731;4880;4837;4654;4695;4465;4659;4380;4569;4362;4517;4390;4405;4381;4304;4102;3951;3909;4116;4051;4072;3943","0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;5;7;10;10;8;11;13;11","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,721,0.028249235200137557],["MQT","0035 5 GOREY",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1017;2176;3366;3462;3394;3508;3546;3727;3691;3640;3675;3856;4055;3931;3506;3363;3471;3556;3705;3640;3745;3713;3870;3784","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;9;14;22;19;25;24;34;39","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,697,0.027110095358184254],["MQT","0068 1 DUBLIN 4",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1355;2764;4141;4230;4212;4118;3936;3916;4047;4144;4272;3941;3995;3799;3929;3922;3868;3860;3683;3698;3680;3731;3711;3709","0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;10;13;19;17;27;22;29;22;22","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,666,0.026572765244055337],["MQT","0032 5 GREYSTONES",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1216;2528;3721;3832;3766;3668;3663;3610;3815;3737;3788;3473;3267;3048;3007;3073;3034;3032;3018;3092;3180;3134;3167;3251","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;5;6;9;10","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,699,0.023291469347108087],["MQT","0032 3 ARKLOW",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","971;2012;3004;3072;3010;2957;2944;3006;3124;3059;3082;3039;3094;3097;3072;3214;3132;3103;3058;3200;3305;3210;3211;3215","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;4;5;5;4;4;4;3;5;6","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,640,0.02303355089232621],["MQT","0070 3 DUNDRUM",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","642;1274;1902;1952;2208;2376;2566;2648;2742;2747;2898;2930;2828;2510;2235;2393;2293;2233;1951;1842;1892;1916;2162;3185","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;6;10;11;16","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,660,0.022818618846674642],["MQT","0018 1 DUBLIN 2",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1045;2192;3164;3241;3076;3077;2912;2919;3060;3139;3095;2948;3021;3045;2903;2925;3393;3643;3588;3190;3110;3022;3141;3092","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;2;3;4;5;6;9;8;8;6","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,662,0.022152329505154784],["MQT","0035 4 NEW ROSS",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","1071;2307;3520;3704;3809;3517;3372;3324;3532;3576;3491;3379;3551;3383;3369;3195;3245;3110;3092;2925;3107;2937;2913;2878","0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;0;3;9;10;8;4;6;7","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,690,0.020619147579506943],["MQT","0032 2 WICKLOW TWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","908;1753;2642;2422;2676;2459;2535;2259;2430;2547;2567;2491;2433;2301;2369;2391;2557;2575;2639;2589;2627;2609;2678;2616","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;10;10;9;3;3","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,647,0.018742074380816598],["MQT","0030 3 DUNGARVAN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","891;1858;2804;2801;2668;2441;2364;2611;2611;2584;2255;2638;2859;2985;2765;2657;2524;2451;2370;2424;2422;2499;2562;2608","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;1;2;2;1;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,730,0.01868475916864285],["MQT","0060 2 STILLORGAN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","857;1735;2575;2737;2917;2770;2701;2487;2698;2573;2625;2485;2563;2479;2493;2471;2356;2288;2273;2366;2533;2508;2605;2421","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;5;3;4;4;3;5;8","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,702,0.017345016084081417],["MQT","0029 2 TIPP TOWN",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","640;1370;2063;2178;2193;2043;1947;1899;2052;2031;2004;2050;2092;2099;1957;1984;1925;1920;1910;1965;2052;2054;2081;2033","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,745,0.014565228293654489],["MQT","0031 3 PTARLINGTON",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","738;1381;2144;2265;2408;2324;2330;2194;2491;2311;2342;2060;2287;2356;2149;2078;2050;2326;2352;2601;2405;2195;1912;1991","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,626,0.014264323429742296],["MQT","0070 1 REST DUB 14",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","718;1325;1981;1988;2059;2112;2037;2060;2027;1935;1899;1862;1991;1850;1791;1681;1764;1727;1780;1806;1911;1859;1821;1751","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,701,0.012544867064529765],["MQT","0029 4 CASHEL",null,"50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579","572;946;1281;1089;1120;1124;1087;1077;1118;1229;1245;1210;1139;1105;1147;1169;1181;1131;1104;1115;1169;1162;1209;1208","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;3;3;2;1;2;2","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,743,0.00865459703823641]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MQT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 364\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 364 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MQT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 364\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MQT",null,1,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;155;233;295;338;398;412;460;479","50335;102476;152101;150012;152834;147318;147868;142462;148279;146386;147437;144048;146665;142473;139598;137580;138205;135790;136259;134343;138611;136511;139468;139579",null],["National","MQT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;96;183;381;532;790;1051;1262;1446;1505;1681;1725","214544;433390;652404;652380;661868;639746;641061;624797;651520;644877;654043;634145;656578;642490;637330;618617;620399;607188;609736;601636;620380;610942;626086;625008",null]]},"SELECT \r\nCASE WHEN 'Srv. QTR' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='364' ":{"columns":["VALUE"],"data":[["110.7"]]},"Select DISTINCT \r\n'QTR'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.QTRmarketSalesUnit marketSalesUnitT ,\r\nfsB.QTRMarketSalesUnit marketSalesUnitB,\r\nFsb.QTRSalesUnit SalesUnitB  ,\r\nFsb.QTRSalesUnitPY,\r\nFsT.QTRSalesUnit SalesUnitT,\r\n  --Fsb.QTRSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.QTRmarketSalesUnitLastMonth<>0 and fsT.QTRmarketSalesUnitLastMonth is not null then (fsB.QTRMarketSalesUnitLastMonth /fsT.QTRmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 364\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 364\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 364 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","QTRSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["QTR","0061 1 DUN LAOIRE",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","4527;4541;9079;13759;4940;9016;13328;4832;9360;13573;4550;8732;12877;4491;8477;12995;4171;7748;12073;4369;8637;12776;4399;8311","0;0;0;0;0;0;0;0;0;0;0;0;0;5;11;19;19;38;57;19;48;66;19;47","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,682,0.08869039996585137],["QTR","0030 2 WATERFD CTY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","5571;4036;8108;11418;6027;9733;13867;4628;8883;12748;4530;8240;12662;3380;6981;10355;4493;7828;11750;3468;7339;10902;3958;7670","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;2;7;16;3;17;30;7;22","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,709,0.0818500021342895],["QTR","0033 1 K/KENNY CO",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2499;2081;4313;6429;2861;4634;7126;2332;4666;6972;2777;5182;7758;2144;4274;6462;2602;4691;6912;2414;4609;7112;2456;4880","0;0;0;0;0;0;0;0;0;0;0;0;0;4;7;10;1;3;9;6;18;31;16;35","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,635,0.05207666367866137],["QTR","0029 1 REST S TIPP",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2285;3634;5946;8170;2500;4508;6735;2348;4501;6704;2381;4433;6675;2276;4426;6595;2287;4122;6555;2054;4324;6479;2399;4457","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;5;1;8;12;2;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,691,0.047562641396679047],["QTR","0030 1 RST WATERFD",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2107;2089;4184;6289;2502;4358;6256;1989;4261;6511;2004;3813;6304;1861;3782;5720;2105;3700;6035;1752;3506;5561;1983;3986","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;2;3;2;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,641,0.04253638963589021],["QTR","0035 1 RST WEXFORD",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","2526;2245;4555;7135;2558;4659;6771;2021;4201;6144;2118;4182;6540;2013;3920;6104;1836;3524;5666;1868;3828;5735;2062;3880","0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;7;3;15;24;13;25;34;11;22","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,759,0.041405216203525844],["QTR","0032 1 RST WICKLOW",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1888;3898;5748;7382;1869;3614;5315;2009;3787;5613;1989;3754;5649;1986;3810;5670;1927;3759;5919;1848;3780;5979;2084;3849","0;0;0;0;0;0;0;0;0;0;0;0;0;2;6;7;6;8;19;4;8;14;14;19","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,746,0.04107440133179664],["QTR","0033 2 K/KENNY TWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1954;1783;3847;5787;2584;4293;6599;1915;4115;5885;2216;4108;5983;1878;3811;5718;1717;3345;5239;1795;3610;5400;2055;3772","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;6;15;7;16;22;8;17","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,638,0.04025269987621121],["QTR","0034 1 CARLOW COUNTY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1674;1810;3704;5370;1841;3194;5120;1641;3391;5034;1782;3718;5472;1739;3256;5130;1683;3354;5217;1539;3249;5065;1758;3564","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,665,0.03803303880138302],["QTR","0035 2 WEXFORD TWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1928;2079;4071;6059;1933;3572;5503;1857;3842;5527;1776;3484;5218;1862;3459;5237;1739;3287;5043;1674;3398;4979;1715;3398","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;3;8;11;3;4;6;2;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,713,0.03626157852051052],["QTR","0035 3 ENNISCORTHY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1416;1546;3151;4677;1745;3285;4855;1613;3352;4781;1704;3496;5019;1540;2911;4396;1529;2995;4417;1533;3054;4546;1607;3279","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;20;9;21;36;14;35;46;16;32","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,656,0.03499167627096939],["QTR","0032 4 BRAY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1617;1573;3524;5249;1856;3662;5413;1736;3591;5364;1709;3076;4754;1561;3111;4699;1610;3063;4673;1485;2985;4617;1591;3108","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;2;7;10;3;10;18;9;18","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,676,0.03316685875272122],["QTR","0034 2 CARLOW TOWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1822;1658;3606;5214;1724;3550;5129;1479;3211;4736;1557;3267;4746;1626;3206;4739;1272;2641;3990;1468;2864;4259;1507;2868","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;5;3;4;6;0;5;7;3;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,742,0.03060571135868869],["QTR","0031 2 PORTLAOISE",1,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1528;1512;2977;4310;1696;2936;4401;1493;2884;4441;1502;2914;4694;1520;2861;4343;1457;2780;4312;1475;2904;4253;1444;2847","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,664,0.030381610961710846],["QTR","0031 1 REST LAOIS",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1333;1459;2845;4213;1477;2624;4111;1484;2701;4140;1357;2756;4000;1348;2566;3928;1432;2433;3779;1347;2647;3998;1395;2846","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;7;5;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,688,0.03037093951423571],["QTR","0029 3 CLONMEL",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1540;1556;3189;4698;1709;3220;4704;1472;3061;4581;1773;3222;4622;1622;3054;4592;1412;2685;4205;1379;2793;4250;1497;2795","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;4;2;3;6;2;4","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,692,0.0298266956930038],["QTR","0060 1 BLACKROCK",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1479;1661;3252;4880;1618;3026;4695;1388;2990;4380;1577;2972;4517;1450;2860;4381;1373;2581;3951;1331;2746;4051;1352;2638","0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;2;6;10;2;4;11;4;4","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,721,0.028151278439407523],["QTR","0035 5 GOREY",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1017;1159;2349;3462;1091;2395;3546;1272;2540;3640;1307;2756;4055;1183;2207;3363;1291;2400;3705;1226;2440;3713;1383;2511","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;9;14;22;6;17;24;16;32","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,697,0.02679600461006531],["QTR","0070 3 DUNDRUM",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","642;632;1260;1952;888;1684;2566;970;1860;2747;1121;2043;2828;803;1450;2393;703;1290;1951;594;1231;1916;840;2500","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;2;6;10;3;12","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,660,0.02667861868783882],["QTR","0068 1 DUBLIN 4",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1355;1409;2786;4230;1391;2674;3936;1371;2785;4144;1499;2582;3995;1303;2516;3922;1249;2454;3683;1264;2451;3731;1244;2429","0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;10;3;13;17;13;18;29;6;11","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,666,0.025920945917104195],["QTR","0032 5 GREYSTONES",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1216;1312;2505;3832;1246;2341;3663;1193;2493;3737;1244;2229;3267;1025;1969;3073;986;1928;3018;1060;2090;3134;1093;2207","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;5;6;4;9","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,699,0.023551884577624107],["QTR","0032 3 ARKLOW",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","971;1041;2033;3072;979;1918;2944;1041;2098;3059;1064;2078;3094;1067;2056;3214;985;1945;3058;1127;2192;3210;1128;2197","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;4;1;2;4;1;2;3;3;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,640,0.023445170102872753],["QTR","0018 1 DUBLIN 2",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1045;1147;2119;3241;982;1955;2912;989;2103;3139;945;1912;3021;969;1794;2925;1437;2512;3588;1039;2034;3022;1158;2104","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;2;1;3;5;2;7;8;2;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,662,0.02245272548768515],["QTR","0035 4 NEW ROSS",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","1071;1236;2449;3704;1341;2262;3372;1293;2422;3576;1208;2225;3551;1040;2043;3195;1090;1958;3092;923;1973;2937;899;1914","0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;0;3;9;1;2;4;3;5","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,690,0.0204251504674094],["QTR","0032 2 WICKLOW TWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","908;845;1734;2422;1099;1771;2535;823;1666;2547;843;1610;2433;711;1546;2391;877;1730;2639;827;1718;2609;896;1725","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;8;8;9;2;2","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,647,0.018408246894608783],["QTR","0030 3 DUNGARVAN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","891;967;1913;2801;834;1553;2364;1081;1800;2584;752;1854;2859;878;1760;2657;745;1554;2370;799;1606;2499;862;1715","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;4;4;1;2;2;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,730,0.01830153241985743],["QTR","0060 2 STILLORGAN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","857;878;1718;2737;1058;1751;2701;844;1748;2573;896;1660;2563;812;1590;2471;697;1407;2273;790;1667;2508;887;1580","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;1;3;1;2;3;3;7","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,702,0.016860887010714132],["QTR","0029 2 TIPP TOWN",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","640;730;1423;2178;745;1288;1947;697;1393;2031;670;1412;2092;677;1277;1984;618;1213;1910;673;1355;2054;700;1334","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,745,0.014235710931830793],["QTR","0031 3 PTARLINGTON",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","738;643;1406;2265;786;1465;2330;650;1626;2311;681;1375;2287;750;1237;2078;722;1485;2352;971;1538;2195;688;1334","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,626,0.014235710931830793],["QTR","0070 1 REST DUB 14",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","718;607;1263;1988;678;1387;2037;701;1377;1935;665;1304;1991;524;1104;1681;607;1150;1780;633;1281;1859;595;1173","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,701,0.012517607888333972],["QTR","0029 4 CASHEL",null,"50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708","572;374;709;1089;405;744;1087;395;775;1229;411;756;1139;377;764;1169;389;726;1104;400;791;1162;447;837","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;3;0;0;1;1;1","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342",378.5985,null,null,null,null,743,0.008932001536688435]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'QTR' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 364\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 364 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 364\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'QTR' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 364\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","QTR",null,1,7886,"H3",null,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;27;49;110;72;172;295;115;275;412;163;342","50335;52141;101766;150012;54963;99072;147868;49557;99483;146386;50608;97145;146665;46416;90078;137580;47041;88288;136259;45125;90640;136511;48082;93708",null],["National","QTR",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","0;0;0;0;0;0;0;0;0;0;0;0;0;96;183;381;247;592;1051;458;987;1505;634;1207","214544;218846;437860;652380;228334;425226;641061;212070;435685;644877;221236;424953;656578;207148;405705;618617;208930;394276;609736;200830;404920;610942;215974;418986",null]]},"SELECT \r\nCASE WHEN 'Srv. QTR' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='265' ":{"columns":["VALUE"],"data":[["101.47"]]},"Select DISTINCT \r\n'QTR'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.QTRmarketSalesUnit marketSalesUnitT ,\r\nfsB.QTRMarketSalesUnit marketSalesUnitB,\r\nFsb.QTRSalesUnit SalesUnitB  ,\r\nFsb.QTRSalesUnitPY,\r\nFsT.QTRSalesUnit SalesUnitT,\r\n  --Fsb.QTRSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.QTRmarketSalesUnitLastMonth<>0 and fsT.QTRmarketSalesUnitLastMonth is not null then (fsB.QTRMarketSalesUnitLastMonth /fsT.QTRmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 265\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 265\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 265 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","QTRSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["QTR","0061 1 DUN LAOIRE",6,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","326;373;687;1065;371;716;1131;355;700;1034;386;744;1074;399;726;1104;365;664;1026;336;643;978;348;658","79;106;193;303;113;194;302;101;192;280;109;210;286;116;196;292;95;173;280;80;162;244;99;193","0;0;0;0;0;0;0;0;0;0;0;0;79;106;193;303;113;194;302;101;192;280;109;210","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,1,1,0.11538461538461539,682,0.12455044482301722],["QTR","0030 2 WATERFD CTY",15,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","369;150;331;494;289;469;636;161;350;509;179;311;457;219;359;487;130;258;405;147;247;360;142;307","287;70;172;237;202;300;401;100;214;306;94;150;228;61;119;164;46;89;144;54;89;129;45;92","0;0;0;0;0;0;0;0;0;0;0;0;287;70;172;237;202;300;401;100;214;306;94;150","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,10,0.6666666666666666,1.2,0.23076923076923078,709,0.0581109218247208],["QTR","0035 2 WEXFORD TWN",8,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","153;144;276;424;142;274;406;114;247;402;141;295;446;164;311;466;160;279;447;167;317;493;136;292","79;83;158;242;69;138;205;55;127;203;72;154;235;75;152;226;70;134;216;71;147;216;72;146","0;0;0;0;0;0;0;0;0;0;0;0;79;83;158;242;69;138;205;55;127;203;72;154","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,0.625,2,0.19230769230769232,713,0.05527162597009275],["QTR","0029 1 REST S TIPP",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","125;130;245;377;126;252;377;147;270;425;108;249;380;173;312;451;152;289;422;138;268;419;136;268","30;32;69;106;42;83;124;53;97;144;29;75;109;43;80;117;41;79;113;34;70;103;37;72","0;0;0;0;0;0;0;0;0;0;0;0;30;32;69;106;42;83;124;53;97;144;29;75","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,691,0.05072875260268787],["QTR","0035 1 RST WEXFORD",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","134;134;260;397;131;251;391;149;263;391;129;262;385;124;258;375;124;233;353;125;252;365;134;256","46;58;112;170;56;105;166;66;123;183;60;119;175;59;123;180;53;101;158;61;119;166;64;123","0;0;0;0;0;0;0;0;0;0;0;0;46;58;112;170;56;105;166;66;123;183;60;119","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,759,0.04845731591898542],["QTR","0032 1 RST WICKLOW",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","135;101;228;354;118;224;335;101;232;340;119;227;351;122;224;352;124;204;308;104;194;311;131;240","21;23;57;87;32;57;82;18;55;72;32;58;80;30;48;82;27;48;72;26;51;70;33;64","0;0;0;0;0;0;0;0;0;0;0;0;21;23;57;87;32;57;82;18;55;72;32;58","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,746,0.045428733674048836],["QTR","0033 1 K/KENNY CO",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","74;54;119;185;84;154;234;74;158;240;93;186;283;96;195;301;103;194;297;144;238;372;134;234","15;14;26;41;15;35;56;16;35;53;22;41;59;22;46;63;20;36;56;22;39;59;19;39","0;0;0;0;0;0;0;0;0;0;0;0;15;14;26;41;15;35;56;16;35;53;22;41","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,635,0.044293015332197615],["QTR","0029 3 CLONMEL",5,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","80;111;208;297;115;216;312;103;200;290;84;181;279;103;207;301;106;211;307;103;199;300;102;198","19;19;35;48;20;39;64;17;38;59;17;36;55;19;37;52;19;40;56;18;36;53;17;36","0;0;0;0;0;0;0;0;0;0;0;0;19;19;35;48;20;39;64;17;38;59;17;36","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,1,1.2,0.11538461538461539,692,0.03747870528109029],["QTR","0018 1 DUBLIN 2",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","60;50;93;146;55;91;135;40;92;115;43;88;133;212;260;308;47;86;150;48;105;198;63;197","10;16;35;50;18;33;50;11;26;29;15;33;39;20;30;42;6;11;27;9;22;40;18;31","0;0;0;0;0;0;0;0;0;0;0;0;10;16;35;50;18;33;50;11;26;29;15;33","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,662,0.03728941889078175],["QTR","0060 1 BLACKROCK",1,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","86;104;186;305;90;189;287;104;206;302;97;189;322;93;195;308;99;189;294;98;199;303;101;194","26;24;44;81;21;52;80;29;58;83;35;59;95;29;52;97;27;54;81;27;53;78;29;52","0;0;0;0;0;0;0;0;0;0;0;0;26;24;44;81;21;52;80;29;58;83;35;59","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,1,0.019230769230769232,721,0.03672155971985614],["QTR","0032 4 BRAY",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","93;76;153;247;77;150;227;73;160;231;69;148;214;81;152;229;90;160;233;90;166;253;98;184","16;17;29;49;14;29;51;21;40;58;16;36;51;18;35;47;18;33;45;17;30;47;21;38","0;0;0;0;0;0;0;0;0;0;0;0;16;17;29;49;14;29;51;21;40;58;16;36","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,676,0.034828695816770776],["QTR","0035 3 ENNISCORTHY",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","64;68;146;217;80;137;220;89;183;267;93;179;262;86;179;267;78;137;234;75;162;266;99;181","37;34;67;101;30;51;86;42;86;127;41;80;116;39;90;136;38;61;104;39;79;132;43;89","0;0;0;0;0;0;0;0;0;0;0;0;37;34;67;101;30;51;86;42;86;127;41;80","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,656,0.034260836645845165],["QTR","0035 5 GOREY",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","78;95;197;289;79;161;255;85;177;275;88;192;290;89;201;311;98;172;294;122;215;333;90;176","19;26;50;83;15;39;73;22;47;85;27;62;85;31;74;103;40;60;92;33;55;81;30;62","0;0;0;0;0;0;0;0;0;0;0;0;19;26;50;83;15;39;73;22;47;85;27;62","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,697,0.03331440469430248],["QTR","0030 1 RST WATERFD",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","76;69;147;242;75;154;224;76;152;228;76;134;220;86;147;220;80;148;217;92;180;256;87;173","19;16;40;69;15;41;64;21;48;71;24;44;78;31;49;67;34;63;82;33;54;75;30;63","0;0;0;0;0;0;0;0;0;0;0;0;19;16;40;69;15;41;64;21;48;71;24;44","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,641,0.03274654552337687],["QTR","0034 1 CARLOW COUNTY",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","62;71;143;200;64;123;190;72;138;210;72;123;192;75;141;225;76;147;226;76;155;240;92;156","14;14;30;45;16;28;48;12;27;44;21;33;44;20;35;50;18;28;44;17;32;42;16;23","0;0;0;0;0;0;0;0;0;0;0;0;14;14;30;45;16;28;48;12;27;44;21;33","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,665,0.029528676888131742],["QTR","0068 1 DUBLIN 4",8,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","81;95;177;265;112;186;277;95;195;274;95;170;256;75;158;249;68;134;209;82;165;236;64;146","20;21;48;67;31;50;68;23;60;72;27;50;73;18;48;72;18;38;62;23;53;76;17;45","0;0;0;0;0;0;0;0;0;0;0;0;20;21;48;67;31;50;68;23;60;72;27;50","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,4,0.5,1.5,0.11538461538461539,666,0.027635812985046374],["QTR","0033 2 K/KENNY TWN",10,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","74;74;149;236;101;166;252;73;159;239;69;159;235;77;139;227;82;144;218;104;174;286;77;142","9;12;19;32;8;14;21;10;18;32;8;15;26;4;8;17;5;8;15;4;12;22;14;18","0;0;0;0;0;0;0;0;0;0;0;0;9;12;19;32;8;14;21;10;18;32;8;15","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,4,0.4,1.25,0.09615384615384616,638,0.026878667423812227],["QTR","0034 2 CARLOW TOWN",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","70;74;147;216;65;140;208;74;142;218;70;137;209;68;129;209;52;126;192;63;136;206;65;136","7;11;18;28;6;15;25;8;18;31;7;17;27;10;17;24;3;12;16;9;16;24;8;13","0;0;0;0;0;0;0;0;0;0;0;0;7;11;18;28;6;15;25;8;18;31;7;17","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,742,0.02574294908196101],["QTR","0032 3 ARKLOW",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","72;67;142;236;75;136;203;82;164;224;77;130;212;87;161;240;68;116;180;79;145;215;64;127","13;15;28;49;20;38;58;24;44;58;15;28;45;21;41;60;23;35;51;23;40;61;23;40","0;0;0;0;0;0;0;0;0;0;0;0;13;15;28;49;20;38;58;24;44;58;15;28","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,640,0.024039371569184176],["QTR","0031 1 REST LAOIS",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","35;40;75;106;29;126;165;34;69;109;47;93;148;42;101;139;42;86;131;45;88;132;67;117","7;14;25;35;8;82;93;11;18;27;11;24;36;8;18;28;11;22;39;15;28;40;18;31","0;0;0;0;0;0;0;0;0;0;0;0;7;14;25;35;8;82;93;11;18;27;11;24","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,688,0.022146507666098807],["QTR","0029 2 TIPP TOWN",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","34;49;98;155;56;90;145;49;118;159;50;121;169;54;97;150;49;102;161;52;104;158;63;114","6;12;21;41;15;26;39;15;32;39;14;30;39;9;17;31;11;19;28;10;24;33;16;26","0;0;0;0;0;0;0;0;0;0;0;0;6;12;21;41;15;26;39;15;32;39;14;30","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,745,0.021578648495173196],["QTR","0070 3 DUNDRUM",1,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","61;62;127;194;56;107;173;54;113;168;59;111;187;50;112;172;61;116;161;61;117;169;51;110","11;10;20;32;9;23;46;8;20;32;13;28;50;6;28;47;9;26;39;18;37;52;12;20","0;0;0;0;0;0;0;0;0;0;0;0;11;10;20;32;9;23;46;8;20;32;13;28","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,1,0.019230769230769232,660,0.02082150293393905],["QTR","0031 2 PORTLAOISE",7,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","27;46;92;145;39;91;126;45;81;114;33;70;113;38;77;115;38;69;113;43;86;142;59;108","3;6;11;17;3;7;11;2;7;9;3;5;10;4;7;10;2;4;8;2;7;10;4;7","0;0;0;0;0;0;0;0;0;0;0;0;3;6;11;17;3;7;11;2;7;9;3;5","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,4,0.5714285714285714,1.25,0.09615384615384616,664,0.020442930153321975],["QTR","0060 2 STILLORGAN",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","62;43;102;154;67;130;184;71;117;175;39;75;126;60;115;174;41;85;141;41;91;128;52;90","15;6;20;35;12;31;43;22;37;48;14;26;38;17;32;47;13;32;48;16;32;44;12;29","0;0;0;0;0;0;0;0;0;0;0;0;15;6;20;35;12;31;43;22;37;48;14;26","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,702,0.017035775127768313],["QTR","0035 4 NEW ROSS",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","42;35;76;106;35;70;103;34;72;103;37;80;113;53;93;129;35;72;114;46;82;114;44;87","21;20;38;52;16;34;47;18;32;48;19;41;56;24;45;59;17;36;55;21;39;53;21;41","0;0;0;0;0;0;0;0;0;0;0;0;21;20;38;52;16;34;47;18;32;48;19;41","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,690,0.016467915956842702],["QTR","0032 5 GREYSTONES",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","73;79;162;220;65;155;262;70;149;219;85;127;180;45;96;149;49;93;140;53;107;150;52;83","24;6;24;29;16;32;50;19;28;44;22;31;38;9;16;24;8;15;20;7;11;17;4;6","0;0;0;0;0;0;0;0;0;0;0;0;24;6;24;29;16;32;50;19;28;44;22;31","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,699,0.015710770395608555],["QTR","0029 4 CASHEL",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","37;34;66;102;24;49;75;29;62;94;33;64;99;37;70;105;38;71;106;39;83;124;42;77","11;8;18;31;9;17;29;6;14;28;11;19;29;13;21;31;10;16;26;12;20;30;10;19","0;0;0;0;0;0;0;0;0;0;0;0;11;8;18;31;9;17;29;6;14;28;11;19","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,743,0.014575052053757333],["QTR","0070 1 REST DUB 14",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","47;47;96;136;38;80;110;31;71;119;31;86;111;69;117;166;31;52;94;20;56;84;29;63","12;13;24;37;15;22;26;4;10;14;5;14;19;8;13;24;4;9;16;3;13;16;7;18","0;0;0;0;0;0;0;0;0;0;0;0;12;13;24;37;15;22;26;4;10;14;5;14","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,701,0.011925042589437818],["QTR","0031 3 PTARLINGTON",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","22;29;62;86;25;49;86;29;59;89;32;63;96;39;63;105;40;75;104;35;65;97;29;59","0;2;2;2;0;4;6;0;1;2;0;1;2;1;3;6;4;5;6;2;5;6;3;5","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;2;0;4;6;0;1;2;0;1","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,626,0.011167897028203672],["QTR","0030 3 DUNGARVAN",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","24;24;55;86;28;58;81;27;60;217;152;264;324;123;158;197;36;64;98;31;63;94;29;57","8;11;22;35;10;17;25;7;18;34;9;21;35;8;17;31;20;30;41;15;25;41;8;18","0;0;0;0;0;0;0;0;0;0;0;0;8;11;22;35;10;17;25;7;18;34;9;21","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,730,0.010789324247586598],["QTR","0032 2 WICKLOW TWN",null,"2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283","39;42;76;121;42;82;123;47;97;149;55;92;132;46;91;134;49;94;136;28;58;95;30;53","6;15;23;30;14;25;39;11;29;41;13;22;27;6;11;21;9;20;33;8;19;29;8;14","0;0;0;0;0;0;0;0;0;0;0;0;6;15;23;30;14;25;39;11;29;41;13;22","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,647,0.010032178686352452]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'QTR' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 265\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 265 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'QTR' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 265\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","QTR",40,61,7886,"H3",1.3,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473","2715;2570;5121;7803;2753;5276;7933;2587;5256;7929;2741;5350;7998;3085;5644;8365;2611;4870;7511;2687;5160;7877;2710;5283",0.6557377049180327],["National","QTR",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;2835;2850;5903;9106;3224;6212;10396;3130;6486;9626;3292;6366","2835;2850;5903;9106;3224;6212;10396;3130;6486;9626;3292;6366;9485;3229;6240;9614;3077;5770;8854;2979;5894;8977;3217;6288","12448;12727;25598;38690;12845;24602;38281;12410;25654;38762;13450;26155;39577;14950;27637;41226;12883;24335;37419;12903;25285;38227;13226;25590",null]]},"SELECT \r\nCASE WHEN 'MQT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='265' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'MQT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MQTmarketSalesUnit marketSalesUnitT ,\r\nfsB.MQTMarketSalesUnit marketSalesUnitB,\r\nFsb.MQTSalesUnit SalesUnitB  ,\r\nFsb.MQTSalesUnitPY,\r\nFsT.MQTSalesUnit SalesUnitT,\r\n  --Fsb.MQTSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MQTmarketSalesUnitLastMonth<>0 and fsT.MQTmarketSalesUnitLastMonth is not null then (fsB.MQTMarketSalesUnitLastMonth /fsT.MQTmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 265\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 265\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 265 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MQTSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MQT","0061 1 DUN LAOIRE",6,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","326;699;1013;1065;1063;1094;1131;1115;1115;1034;1065;1078;1074;1087;1056;1104;1070;1042;1026;997;1005;978;990;993","79;185;272;303;310;304;302;290;300;280;288;298;286;293;272;292;271;269;280;265;269;244;263;275","0;0;0;0;0;0;0;0;0;0;0;0;79;185;272;303;310;304;302;290;300;280;288;298","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,1,1.6666666666666667,0.11764705882352941,682,0.124125],["MQT","0035 2 WEXFORD TWN",8,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","153;297;429;424;422;422;406;378;379;402;429;450;446;469;462;466;462;434;447;454;485;493;462;468","79;162;237;242;228;222;205;191;194;203;220;230;235;238;233;226;221;208;216;217;229;216;217;215","0;0;0;0;0;0;0;0;0;0;0;0;79;162;237;242;228;222;205;191;194;203;220;230","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,0.75,2.5,0.17647058823529413,713,0.0585],["MQT","0030 2 WATERFD CTY",15,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","369;519;700;494;633;632;636;508;517;509;527;470;457;497;505;487;398;386;405;422;394;360;355;420","287;357;459;237;369;365;401;299;315;306;300;242;228;195;197;164;149;134;144;152;144;129;120;132","0;0;0;0;0;0;0;0;0;0;0;0;287;357;459;237;369;365;401;299;315;306;300;242","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,11,0.7333333333333333,1.7272727272727273,0.2235294117647059,709,0.0525],["MQT","0029 1 REST S TIPP",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","125;255;370;377;373;384;377;398;395;425;386;404;380;445;443;451;430;428;422;408;401;419;417;419","30;62;99;106;116;120;124;135;138;144;120;122;109;123;114;117;115;116;113;106;104;103;106;105","0;0;0;0;0;0;0;0;0;0;0;0;30;62;99;106;116;120;124;135;138;144;120;122","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,691,0.052375],["MQT","0035 1 RST WEXFORD",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","134;268;394;397;394;388;391;409;403;391;371;390;385;380;381;375;375;350;353;354;372;365;374;369","46;104;158;170;168;163;166;176;184;183;177;179;175;174;179;180;174;158;158;166;176;166;169;170","0;0;0;0;0;0;0;0;0;0;0;0;46;104;158;170;168;163;166;176;184;183;177;179","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,759,0.046125],["MQT","0033 1 K/KENNY CO",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","74;128;193;185;215;220;234;224;238;240;259;268;283;286;292;301;308;300;297;338;341;372;362;368","15;29;41;41;42;50;56;57;56;53;59;59;59;59;64;63;61;53;56;58;59;59;56;59","0;0;0;0;0;0;0;0;0;0;0;0;15;29;41;41;42;50;56;57;56;53;59;59","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,635,0.046],["MQT","0032 1 RST WICKLOW",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","135;236;363;354;371;350;335;318;343;340;358;335;351;354;348;352;354;332;308;288;298;311;338;357","21;44;78;87;96;87;82;68;80;72;86;75;80;78;70;82;79;82;72;71;75;70;77;83","0;0;0;0;0;0;0;0;0;0;0;0;21;44;78;87;96;87;82;68;80;72;86;75","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,746,0.044625],["MQT","0029 3 CLONMEL",5,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","80;191;288;297;301;305;312;300;296;290;271;271;279;298;305;301;304;305;307;304;295;300;299;299","19;38;54;48;49;52;64;61;63;59;59;57;55;57;56;52;52;55;56;55;52;53;52;53","0;0;0;0;0;0;0;0;0;0;0;0;19;38;54;48;49;52;64;61;63;59;59;57","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,1,1.2,0.07058823529411765,692,0.037375],["MQT","0060 1 BLACKROCK",1,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","86;190;272;305;291;308;287;301;304;302;295;285;322;318;328;308;314;302;294;293;304;303;306;298","26;50;70;81;78;89;80;88;86;83;89;84;95;89;88;97;95;99;81;81;80;78;80;77","0;0;0;0;0;0;0;0;0;0;0;0;26;50;70;81;78;89;80;88;86;83;89;84","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,3,0.03529411764705882,721,0.03725],["MQT","0035 5 GOREY",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","78;173;275;289;273;253;255;261;271;275;278;290;290;291;299;311;320;282;294;318;337;333;301;294","19;45;69;83;72;72;73;80;81;85;90;100;85;89;97;103;112;89;92;85;87;81;78;88","0;0;0;0;0;0;0;0;0;0;0;0;19;45;69;83;72;72;73;80;81;85;90;100","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,697,0.03675],["MQT","0018 1 DUBLIN 2",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","60;110;153;146;151;144;135;120;136;115;118;111;133;302;305;308;143;134;150;151;169;198;213;290","10;26;45;50;52;48;50;43;43;29;33;36;39;44;36;42;28;23;27;30;38;40;49;49","0;0;0;0;0;0;0;0;0;0;0;0;10;26;45;50;52;48;50;43;43;29;33;36","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,662,0.03625],["MQT","0035 3 ENNISCORTHY",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","64;132;210;217;229;208;220;229;266;267;271;263;262;255;262;267;259;225;234;231;259;266;290;285","37;71;104;101;97;85;86;98;121;127;126;121;116;114;126;136;135;107;104;105;122;132;136;142","0;0;0;0;0;0;0;0;0;0;0;0;37;71;104;101;97;85;86;98;121;127;126;121","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,656,0.035625],["MQT","0032 4 BRAY",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","93;169;246;247;248;244;227;223;237;231;227;219;214;226;218;229;238;237;233;233;239;253;261;271","16;33;45;49;46;49;51;58;62;58;53;54;51;53;50;47;47;45;45;44;42;47;51;55","0;0;0;0;0;0;0;0;0;0;0;0;16;33;45;49;46;49;51;58;62;58;53;54","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,676,0.033875],["MQT","0033 2 K/KENNY TWN",10,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","74;148;223;236;263;253;252;224;245;239;235;239;235;243;215;227;232;232;218;240;248;286;259;254","9;21;28;32;28;27;21;23;25;32;30;29;26;22;19;17;18;17;15;14;19;22;32;28","0;0;0;0;0;0;0;0;0;0;0;0;9;21;28;32;28;27;21;23;25;32;30;29","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,0.6,2,0.1411764705882353,638,0.03175],["MQT","0030 1 RST WATERFD",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","76;145;223;242;248;249;224;225;222;228;228;210;220;230;233;220;214;221;217;229;249;256;251;249","19;35;59;69;68;70;64;70;71;71;74;67;78;85;83;67;70;81;82;81;73;75;72;84","0;0;0;0;0;0;0;0;0;0;0;0;19;35;59;69;68;70;64;70;71;71;74;67","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,641,0.031125],["MQT","0034 1 CARLOW COUNTY",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","62;133;205;200;193;180;190;198;205;210;210;195;192;195;210;225;226;231;226;226;234;240;256;241","14;28;44;45;47;43;48;44;47;44;53;50;44;43;46;50;48;43;44;43;48;42;41;33","0;0;0;0;0;0;0;0;0;0;0;0;14;28;44;45;47;43;48;44;47;44;53;50","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,665,0.030125],["MQT","0068 1 DUBLIN 4",8,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","81;176;258;265;282;274;277;260;286;274;274;249;256;236;244;249;242;225;209;223;240;236;218;217","20;41;68;67;77;69;68;60;78;72;76;62;73;64;71;72;72;62;62;67;77;76;70;68","0;0;0;0;0;0;0;0;0;0;0;0;20;41;68;67;77;69;68;60;78;72;76;62","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,0.75,1.6666666666666667,0.11764705882352941,666,0.027125],["MQT","0034 2 CARLOW TOWN",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","70;144;217;216;207;209;208;217;210;218;214;213;209;207;201;209;193;206;192;203;202;206;208;206","7;18;25;28;23;25;25;27;28;31;30;30;27;30;27;24;17;19;16;22;20;24;23;21","0;0;0;0;0;0;0;0;0;0;0;0;7;18;25;28;23;25;25;27;28;31;30;30","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,742,0.02575],["MQT","0032 3 ARKLOW",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","72;139;214;236;244;230;203;210;231;224;219;190;212;222;243;240;221;195;180;191;209;215;200;197","13;28;41;49;54;59;58;62;64;58;49;42;45;51;58;60;62;54;51;51;56;61;61;61","0;0;0;0;0;0;0;0;0;0;0;0;13;28;41;49;54;59;58;62;64;58;49;42","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,640,0.024625],["MQT","0029 2 TIPP TOWN",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","34;83;132;155;162;147;145;138;173;159;160;162;169;173;145;150;145;155;161;164;163;158;169;168","6;18;27;41;44;46;39;39;45;39;38;37;39;34;26;31;33;33;28;27;33;33;39;35","0;0;0;0;0;0;0;0;0;0;0;0;6;18;27;41;44;46;39;39;45;39;38;37","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,745,0.021],["MQT","0031 2 PORTLAOISE",7,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","27;73;119;145;138;144;126;132;116;114;102;103;113;118;120;115;115;107;113;118;130;142;158;164","3;9;14;17;14;13;11;10;11;9;10;7;10;11;12;10;8;7;8;8;11;10;12;10","0;0;0;0;0;0;0;0;0;0;0;0;3;9;14;17;14;13;11;10;11;9;10;7","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,4,0.5714285714285714,2,0.09411764705882353,664,0.0205],["MQT","0070 3 DUNDRUM",1,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","61;123;188;194;188;174;173;171;179;168;173;166;187;178;188;172;183;176;161;161;162;169;159;162","11;21;31;32;31;35;46;45;43;32;37;40;50;43;50;47;50;45;39;48;50;52;46;35","0;0;0;0;0;0;0;0;0;0;0;0;11;21;31;32;31;35;46;45;43;32;37;40","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,2,0.023529411764705882,660,0.02025],["MQT","0031 1 REST LAOIS",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","35;75;110;106;95;157;165;170;108;109;122;133;148;143;156;139;139;124;131;134;133;132;154;161","7;21;32;35;29;92;93;96;29;27;27;33;36;33;30;28;31;32;39;43;45;40;43;43","0;0;0;0;0;0;0;0;0;0;0;0;7;21;32;35;29;92;93;96;29;27;27;33","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,688,0.020125],["MQT","0060 2 STILLORGAN",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","62;105;164;154;178;182;184;188;171;175;143;133;126;147;166;174;155;144;141;141;147;128;139;127","15;21;35;35;41;46;43;53;49;48;40;37;38;41;44;47;43;47;48;51;48;44;40;41","0;0;0;0;0;0;0;0;0;0;0;0;15;21;35;35;41;46;43;53;49;48;40;37","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,702,0.015875],["MQT","0032 5 GREYSTONES",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","73;152;235;220;206;213;262;267;256;219;234;197;180;140;149;149;153;146;140;144;154;150;149;126","24;30;48;29;39;37;50;53;46;44;47;47;38;25;23;24;23;23;20;19;16;17;14;12","0;0;0;0;0;0;0;0;0;0;0;0;24;30;48;29;39;37;50;53;46;44;47;47","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,699,0.01575],["MQT","0035 4 NEW ROSS",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","42;77;118;106;106;100;103;102;105;103;106;111;113;129;126;129;111;108;114;125;124;114;112;119","21;41;59;52;48;48;47;49;45;48;49;57;56;61;60;59;52;50;55;59;58;53;53;55","0;0;0;0;0;0;0;0;0;0;0;0;21;41;59;52;48;48;47;49;45;48;49;57","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,690,0.014875],["MQT","0029 4 CASHEL",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","37;71;103;102;92;85;75;80;88;94;98;96;99;103;105;105;106;106;106;107;118;124;127;118","11;19;29;31;32;30;29;26;26;28;33;33;29;31;31;31;28;26;26;28;30;30;28;29","0;0;0;0;0;0;0;0;0;0;0;0;11;19;29;31;32;30;29;26;26;28;33;33","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,743,0.01475],["MQT","0031 3 PTARLINGTON",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","22;51;84;86;82;73;86;90;96;89;92;93;96;103;96;105;106;117;104;99;94;97;91;91","0;2;2;2;0;4;6;6;3;2;2;2;2;3;4;6;9;8;6;4;6;6;7;6","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;2;0;4;6;6;3;2;2;2","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,626,0.011375],["MQT","0070 1 REST DUB 14",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","47;94;143;136;127;120;110;103;101;119;119;134;111;149;142;166;128;101;94;83;98;84;93;91","12;25;36;37;39;35;26;15;14;14;15;18;19;22;18;24;20;20;16;15;20;16;20;21","0;0;0;0;0;0;0;0;0;0;0;0;12;25;36;37;39;35;26;15;14;14;15;18","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,701,0.011375],["MQT","0032 2 WICKLOW TWN",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","39;81;115;121;121;127;123;128;138;149;157;144;132;123;131;134;137;137;136;115;100;95;97;90","6;21;29;30;29;32;39;36;43;41;43;34;27;20;16;21;24;30;33;32;32;29;29;24","0;0;0;0;0;0;0;0;0;0;0;0;6;21;29;30;29;32;39;36;43;41;43;34","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,647,0.01125],["MQT","0030 3 DUNGARVAN",null,"2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000","24;48;79;86;90;89;81;80;83;217;342;421;324;295;218;197;110;103;98;93;97;94;92;88","8;19;30;35;34;30;25;22;26;34;36;37;35;34;31;31;43;44;41;36;36;41;34;34","0;0;0;0;0;0;0;0;0;0;0;0;8;19;30;35;34;30;25;22;26;34;36;37","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,730,0.011]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MQT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 265\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 265 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MQT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 265\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MQT",46,61,7886,"H3",1.8478260869565217,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319","890;1624;2368;2264;2400;2447;2478;2380;2416;2356;2389;2319;2285;2259;2231;2250;2190;2079;2073;2083;2155;2089;2118;2143","2715;5285;7836;7803;7986;7958;7933;7767;7913;7929;8083;8023;7998;8342;8292;8365;7891;7591;7511;7587;7801;7877;7900;8000",0.7540983606557377],["National","MQT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;2835;5685;8738;9106;9480;9415;10396;10302;10670;9626;9788;9506","2835;5685;8738;9106;9480;9415;10396;10302;10670;9626;9788;9506;9485;9422;9359;9614;9462;9144;8854;8756;8978;8977;9215;9371","12448;25175;38046;38690;38808;37694;38281;37846;39333;38762;39802;39263;39577;41077;41059;41226;39159;37924;37419;37439;38369;38227;38550;38532",null]]},"SELECT \r\nCASE WHEN 'YTD' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='265' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'YTD'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.YTDmarketSalesUnit marketSalesUnitT ,\r\nfsB.YTDMarketSalesUnit marketSalesUnitB,\r\nFsb.YTDSalesUnit SalesUnitB  ,\r\nFsb.YTDSalesUnitPY,\r\nFsT.YTDSalesUnit SalesUnitT,\r\n  --Fsb.YTDSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.YTDmarketSalesUnitLastMonth<>0 and fsT.YTDmarketSalesUnitLastMonth is not null then (fsB.YTDMarketSalesUnitLastMonth /fsT.YTDmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 265\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 265\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 265 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","YTDSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["YTD","0061 1 DUN LAOIRE",6,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","326;373;687;1065;1436;1781;2196;2551;2896;3230;3616;3974;4304;399;726;1104;1469;1768;2130;2466;2773;3108;3456;3766","79;106;193;303;416;497;605;706;797;885;994;1095;1171;116;196;292;387;465;572;652;734;816;915;1009","0;0;0;0;0;0;0;0;0;0;0;0;79;106;193;303;416;497;605;706;797;885;994;1095","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,1,5.333333333333333,0.12030075187969924,682,0.12970106075216972],["YTD","0035 2 WEXFORD TWN",8,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","153;144;276;424;566;698;830;944;1077;1232;1373;1527;1678;164;311;466;626;745;913;1080;1230;1406;1542;1698","79;83;158;242;311;380;447;502;574;650;722;804;885;75;152;226;296;360;442;513;589;658;730;804","0;0;0;0;0;0;0;0;0;0;0;0;79;83;158;242;311;380;447;502;574;650;722;804","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,7,0.875,5.142857142857143,0.13533834586466165,713,0.0584791293566607],["YTD","0029 1 REST S TIPP",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","125;130;245;377;503;629;754;901;1024;1179;1287;1428;1559;173;312;451;603;740;873;1011;1141;1292;1428;1560","30;32;69;106;148;189;230;283;327;374;403;449;483;43;80;117;158;196;230;264;300;333;370;405","0;0;0;0;0;0;0;0;0;0;0;0;30;32;69;106;148;189;230;283;327;374;403;449","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,691,0.05372640859622538],["YTD","0030 2 WATERFD CTY",15,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","369;150;331;494;783;963;1130;1291;1480;1639;1818;1950;2096;219;359;487;617;745;892;1039;1139;1252;1394;1559","287;70;172;237;439;537;638;738;852;944;1038;1094;1172;61;119;164;210;253;308;362;397;437;482;529","0;0;0;0;0;0;0;0;0;0;0;0;287;70;172;237;439;537;638;738;852;944;1038;1094","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,14,0.9333333333333333,5.357142857142857,0.2819548872180451,709,0.05369196859071498],["YTD","0035 1 RST WEXFORD",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","134;134;260;397;528;648;788;937;1051;1179;1308;1441;1564;124;258;375;499;608;728;853;980;1093;1227;1349","46;58;112;170;226;275;336;402;459;519;579;638;694;59;123;180;233;281;338;399;457;504;568;627","0;0;0;0;0;0;0;0;0;0;0;0;46;58;112;170;226;275;336;402;459;519;579;638","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,759,0.04645956743353079],["YTD","0032 1 RST WICKLOW",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","135;101;228;354;472;578;689;790;921;1029;1148;1256;1380;122;224;352;476;556;660;764;854;971;1102;1211","21;23;57;87;119;144;169;187;224;241;273;299;321;30;48;82;109;130;154;180;205;224;257;288","0;0;0;0;0;0;0;0;0;0;0;0;21;23;57;87;119;144;169;187;224;241;273;299","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,746,0.04170684667309547],["YTD","0033 1 K/KENNY CO",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","74;54;119;185;269;339;419;493;577;659;752;845;942;96;195;301;404;495;598;742;836;970;1104;1204","15;14;26;41;56;76;97;113;132;150;172;191;209;22;46;63;83;99;119;141;158;178;197;217","0;0;0;0;0;0;0;0;0;0;0;0;15;14;26;41;56;76;97;113;132;150;172;191","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,635,0.04146576663452266],["YTD","0035 5 GOREY",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","78;95;197;289;368;450;544;629;721;819;907;1011;1109;89;201;311;409;483;605;727;820;938;1028;1114","19;26;50;83;98;122;156;178;203;241;268;303;326;31;74;103;143;163;195;228;250;276;306;338","0;0;0;0;0;0;0;0;0;0;0;0;19;26;50;83;98;122;156;178;203;241;268;303","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,697,0.03836616613858658],["YTD","0029 3 CLONMEL",5,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","80;111;208;297;412;513;609;712;809;899;983;1080;1178;103;207;301;407;512;608;711;807;908;1010;1106","19;19;35;48;68;87;112;129;150;171;188;207;226;19;37;52;71;92;108;126;144;161;178;197","0;0;0;0;0;0;0;0;0;0;0;0;19;19;35;48;68;87;112;129;150;171;188;207","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,1,5.4,0.10150375939849623,692,0.038090646094503376],["YTD","0060 1 BLACKROCK",1,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","86;104;186;305;395;494;592;696;798;894;991;1083;1216;93;195;308;407;497;602;700;801;905;1006;1099","26;24;44;81;102;133;161;190;219;244;279;303;339;29;52;97;124;151;178;205;231;256;285;308","0;0;0;0;0;0;0;0;0;0;0;0;26;24;44;81;102;133;161;190;219;244;279;303","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,7,0.02631578947368421,721,0.03784956605593057],["YTD","0035 3 ENNISCORTHY",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","64;68;146;217;297;354;437;526;620;704;797;883;966;86;179;267;345;404;501;576;663;767;866;948","37;34;67;101;131;152;187;229;273;314;355;394;430;39;90;136;174;197;240;279;319;372;415;461","0;0;0;0;0;0;0;0;0;0;0;0;37;34;67;101;131;152;187;229;273;314;355;394","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,656,0.032649125223860036],["YTD","0032 4 BRAY",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","93;76;153;247;324;397;474;547;634;705;774;853;919;81;152;229;319;389;462;552;628;715;813;899","16;17;29;49;63;78;100;121;140;158;174;194;209;18;35;47;65;80;92;109;122;139;160;177","0;0;0;0;0;0;0;0;0;0;0;0;16;17;29;49;63;78;100;121;140;158;174;194","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,676,0.03096156495385039],["YTD","0033 2 K/KENNY TWN",10,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","74;74;149;236;337;402;488;561;647;727;796;886;962;77;139;227;309;371;445;549;619;731;808;873","9;12;19;32;40;46;53;63;71;85;93;100;111;4;8;17;22;25;32;36;44;54;68;72","0;0;0;0;0;0;0;0;0;0;0;0;9;12;19;32;40;46;53;63;71;85;93;100","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,7,0.7,5.714285714285714,0.15037593984962405,638,0.030066124810579967],["YTD","0030 1 RST WATERFD",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","76;69;147;242;317;396;466;542;618;694;770;828;914;86;147;220;300;368;437;529;617;693;780;866","19;16;40;69;84;110;133;154;181;204;228;248;282;31;49;67;101;130;149;182;203;224;254;287","0;0;0;0;0;0;0;0;0;0;0;0;19;16;40;69;84;110;133;154;181;204;228;248","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,641,0.02982504477200716],["YTD","0018 1 DUBLIN 2",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","60;50;93;146;201;237;281;321;373;396;439;484;529;212;260;308;355;394;458;506;563;656;719;853","10;16;35;50;68;83;100;111;126;129;144;162;168;20;30;42;48;53;69;78;91;109;127;140","0;0;0;0;0;0;0;0;0;0;0;0;10;16;35;50;68;83;100;111;126;129;144;162","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,662,0.02937732470037195],["YTD","0034 1 CARLOW COUNTY",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","62;71;143;200;264;323;390;462;528;600;672;723;792;75;141;225;301;372;451;527;606;691;783;847","14;14;30;45;61;73;93;105;120;137;158;170;181;20;35;50;68;78;94;111;126;136;152;159","0;0;0;0;0;0;0;0;0;0;0;0;14;14;30;45;61;73;93;105;120;137;158;170","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,665,0.029170684667309547],["YTD","0068 1 DUBLIN 4",8,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","81;95;177;265;377;451;542;637;737;816;911;986;1072;75;158;249;317;383;458;540;623;694;758;840","20;21;48;67;98;117;135;158;195;207;234;257;280;18;48;72;90;110;134;157;187;210;227;255","0;0;0;0;0;0;0;0;0;0;0;0;20;21;48;67;98;117;135;158;195;207;234;257","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,0.75,4.333333333333333,0.09774436090225563,666,0.02892960462873674],["YTD","0032 3 ARKLOW",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","72;67;142;236;311;372;439;521;603;663;740;793;875;87;161;240;308;356;420;499;565;635;699;762","13;15;28;49;69;87;107;131;151;165;180;193;210;21;41;60;83;95;111;134;151;172;195;212","0;0;0;0;0;0;0;0;0;0;0;0;13;15;28;49;69;87;107;131;151;165;180;193","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,640,0.026243284198925472],["YTD","0034 2 CARLOW TOWN",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","70;74;147;216;281;356;424;498;566;642;712;779;851;68;129;209;261;335;401;464;537;607;672;743","7;11;18;28;34;43;53;61;71;84;91;101;111;10;17;24;27;36;40;49;56;64;72;77","0;0;0;0;0;0;0;0;0;0;0;0;7;11;18;28;34;43;53;61;71;84;91;101","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,742,0.025588924094227854],["YTD","0070 3 DUNDRUM",1,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","61;62;127;194;250;301;367;421;480;535;594;646;722;50;112;172;233;288;333;394;450;502;553;612","11;10;20;32;41;55;78;86;98;110;123;138;160;6;28;47;56;73;86;104;123;138;150;158","0;0;0;0;0;0;0;0;0;0;0;0;11;10;20;32;41;55;78;86;98;110;123;138","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,2,0.007518796992481203,660,0.02107728337236534],["YTD","0029 2 TIPP TOWN",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","34;49;98;155;211;245;300;349;418;459;509;580;628;54;97;150;199;252;311;363;415;469;532;583","6;12;21;41;56;67;80;95;112;119;133;149;158;9;17;31;42;50;59;69;83;92;108;118","0;0;0;0;0;0;0;0;0;0;0;0;6;12;21;41;56;67;80;95;112;119;133;149","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,745,0.020078523212563714],["YTD","0060 2 STILLORGAN",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","62;43;102;154;221;284;338;409;455;513;552;588;639;60;115;174;215;259;315;356;406;443;495;533","15;6;20;35;47;66;78;100;115;126;140;152;164;17;32;47;60;79;95;111;127;139;151;168","0;0;0;0;0;0;0;0;0;0;0;0;15;6;20;35;47;66;78;100;115;126;140;152","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,702,0.01835652293704367],["YTD","0032 5 GREYSTONES",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","73;79;162;220;285;375;482;552;631;701;786;828;881;45;96;149;198;242;289;342;396;439;491;522","24;6;24;29;45;61;79;98;107;123;145;154;161;9;16;24;32;39;44;51;55;61;65;67","0;0;0;0;0;0;0;0;0;0;0;0;24;6;24;29;45;61;79;98;107;123;145;154","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,699,0.01797768287642926],["YTD","0031 1 REST LAOIS",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","35;40;75;106;135;232;271;305;340;380;427;473;528;42;101;139;181;225;270;315;358;402;469;519","7;14;25;35;43;117;128;139;146;155;166;179;191;8;18;28;39;50;67;82;95;107;125;138","0;0;0;0;0;0;0;0;0;0;0;0;7;14;25;35;43;117;128;139;146;155;166;179","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,688,0.017874362859898057],["YTD","0031 2 PORTLAOISE",7,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","27;46;92;145;184;236;271;316;352;385;418;455;498;38;77;115;153;184;228;271;314;370;429;478","3;6;11;17;20;24;28;30;35;37;40;42;47;4;7;10;12;14;18;20;25;28;32;35","0;0;0;0;0;0;0;0;0;0;0;0;3;6;11;17;20;24;28;30;35;37;40;42","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,0.7142857142857143,4.2,0.07894736842105263,664,0.01646232263397162],["YTD","0030 3 DUNGARVAN",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","24;24;55;86;114;144;167;194;227;384;536;648;708;123;158;197;233;261;295;326;358;389;418;446","8;11;22;35;45;52;60;67;78;94;103;115;129;8;17;31;51;61;72;87;97;113;121;131","0;0;0;0;0;0;0;0;0;0;0;0;8;11;22;35;45;52;60;67;78;94;103;115","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,730,0.015360242457638793],["YTD","0035 4 NEW ROSS",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","42;35;76;106;141;176;209;243;281;312;349;392;425;53;93;129;164;201;243;289;325;357;401;444","21;20;38;52;68;86;99;117;131;147;166;188;203;24;45;59;76;95;114;135;153;167;188;208","0;0;0;0;0;0;0;0;0;0;0;0;21;20;38;52;68;86;99;117;131;147;166;188","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,690,0.01529136244661799],["YTD","0032 2 WICKLOW TWN",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","39;42;76;121;163;203;244;291;341;393;448;485;525;46;91;134;183;228;270;298;328;365;395;418","6;15;23;30;44;55;69;80;98;110;123;132;137;6;11;21;30;41;54;62;73;83;91;97","0;0;0;0;0;0;0;0;0;0;0;0;6;15;23;30;44;55;69;80;98;110;123;132","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,647,0.014395922303347568],["YTD","0029 4 CASHEL",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","37;34;66;102;126;151;177;206;239;271;304;335;370;37;70;105;143;176;211;250;294;335;377;412","11;8;18;31;40;48;60;66;74;88;99;107;117;13;21;31;41;47;57;69;77;87;97;106","0;0;0;0;0;0;0;0;0;0;0;0;11;8;18;31;40;48;60;66;74;88;99;107","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,743,0.014189282270285163],["YTD","0070 1 REST DUB 14",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","47;47;96;136;174;216;246;277;317;365;396;451;476;69;117;166;197;218;260;280;316;344;373;407","12;13;24;37;52;59;63;67;73;77;82;91;96;8;13;24;28;33;40;43;53;56;63;74","0;0;0;0;0;0;0;0;0;0;0;0;12;13;24;37;52;59;63;67;73;77;82;91","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,701,0.014017082242733158],["YTD","0031 3 PTARLINGTON",null,"2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036","22;29;62;86;111;135;172;201;231;261;293;324;357;39;63;105;145;180;209;244;274;306;335;365","0;2;2;2;2;6;8;8;9;10;10;11;12;1;3;6;10;11;12;14;17;18;21;23","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;2;2;6;8;8;9;10;10;11","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,626,0.012570602011296322]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'YTD' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 265\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 265 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'YTD' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 265\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","YTD",52,61,7886,"H3",5.115384615384615,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660","890;734;1478;2264;3134;3925;4742;5514;6341;7098;7903;8660;9383;779;1508;2250;2969;3587;4323;5052;5742;6412;7170;7885","2715;2570;5121;7803;10556;13079;15736;18323;20992;23665;26406;29015;31663;3085;5644;8365;10976;13235;15876;18563;21036;23753;26463;29036",0.8524590163934426],["National","YTD",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;2835;2850;5903;9106;12330;15318;19502;22632;25988;29128;32420;35494","2835;2850;5903;9106;12330;15318;19502;22632;25988;29128;32420;35494;38613;3229;6240;9614;12691;15384;18468;21447;24362;27445;30662;33733","12448;12727;25598;38690;51535;63292;76971;89381;102625;115733;129183;141888;155310;14950;27637;41226;54109;65561;78645;91548;103930;116872;130098;142462",null]]},"SELECT \r\nCASE WHEN 'MAT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='265' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'MAT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MATmarketSalesUnit marketSalesUnitT ,\r\nfsB.MATMarketSalesUnit marketSalesUnitB,\r\nFsb.MATSalesUnit SalesUnitB  ,\r\nFsb.MATSalesUnitPY,\r\nFsT.MATSalesUnit SalesUnitT,\r\n  --Fsb.MATSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MATmarketSalesUnitLastMonth<>0 and fsT.MATmarketSalesUnitLastMonth is not null then (fsB.MATMarketSalesUnitLastMonth /fsT.MATmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 265\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 265\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 265 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MATSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MAT","0061 1 DUN LAOIRE",6,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","326;699;1013;1391;1762;2107;2522;2877;3222;3556;3942;4300;4304;4330;4343;4343;4337;4291;4238;4219;4181;4182;4144;4096","79;185;272;382;495;576;684;785;876;964;1073;1174;1171;1181;1174;1160;1142;1139;1138;1117;1108;1102;1092;1085","0;0;0;0;0;0;0;0;0;0;0;0;79;185;272;382;495;576;684;785;876;964;1073;1174","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,1,5.333333333333333,0.12030075187969924,682,0.12927660648907965],["MAT","0035 2 WEXFORD TWN",8,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","153;297;429;577;719;851;983;1097;1230;1385;1526;1680;1678;1698;1713;1720;1738;1725;1761;1814;1831;1852;1847;1849","79;162;237;321;390;459;526;581;653;729;801;883;885;877;879;869;870;865;880;896;900;893;893;885","0;0;0;0;0;0;0;0;0;0;0;0;79;162;237;321;390;459;526;581;653;729;801;883","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,7,0.875,5.142857142857143,0.13533834586466165,713,0.05835753061482136],["MAT","0030 2 WATERFD CTY",15,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","369;519;700;863;1152;1332;1499;1660;1849;2008;2187;2319;2096;2165;2124;2089;1930;1878;1858;1844;1755;1709;1672;1705","287;357;459;524;726;824;925;1025;1139;1231;1325;1381;1172;1163;1119;1099;943;888;842;796;717;665;616;607","0;0;0;0;0;0;0;0;0;0;0;0;287;357;459;524;726;824;925;1025;1139;1231;1325;1381","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,14,0.9333333333333333,5.357142857142857,0.2819548872180451,709,0.05381264991793965],["MAT","0029 1 REST S TIPP",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","125;255;370;502;628;754;879;1026;1149;1304;1412;1553;1559;1602;1626;1633;1659;1670;1678;1669;1676;1672;1700;1691","30;62;99;136;178;219;260;313;357;404;433;479;483;494;494;494;493;490;483;464;456;442;450;439","0;0;0;0;0;0;0;0;0;0;0;0;30;62;99;136;178;219;260;313;357;404;433;479","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,691,0.05337078651685393],["MAT","0035 1 RST WEXFORD",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","134;268;394;531;662;782;922;1071;1185;1313;1442;1575;1564;1554;1562;1542;1535;1524;1504;1480;1493;1478;1483;1472","46;104;158;216;272;321;382;448;505;565;625;684;694;695;705;704;701;700;696;691;692;679;683;683","0;0;0;0;0;0;0;0;0;0;0;0;46;104;158;216;272;321;382;448;505;565;625;684","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,759,0.046458780457013],["MAT","0032 1 RST WICKLOW",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","135;236;363;489;607;713;824;925;1056;1164;1283;1391;1380;1401;1376;1378;1384;1358;1351;1354;1313;1322;1334;1335","21;44;78;108;140;165;190;208;245;262;294;320;321;328;312;316;311;307;306;314;302;304;305;310","0;0;0;0;0;0;0;0;0;0;0;0;21;44;78;108;140;165;190;208;245;262;294;320","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,746,0.042134831460674156],["MAT","0033 1 K/KENNY CO",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","74;128;193;259;343;413;493;567;651;733;826;919;942;984;1018;1058;1077;1098;1121;1191;1201;1253;1294;1301","15;29;41;56;71;91;112;128;147;165;187;206;209;217;229;231;236;232;231;237;235;237;234;235","0;0;0;0;0;0;0;0;0;0;0;0;15;29;41;56;71;91;112;128;147;165;187;206","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,635,0.041061734629465975],["MAT","0060 1 BLACKROCK",1,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","86;190;272;391;481;580;678;782;884;980;1077;1169;1216;1205;1225;1219;1228;1219;1226;1220;1219;1227;1231;1232","26;50;70;107;128;159;187;216;245;270;305;329;339;344;347;355;361;357;356;354;351;351;345;344","0;0;0;0;0;0;0;0;0;0;0;0;26;50;70;107;128;159;187;216;245;270;305;329","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,7,0.02631578947368421,721,0.03888397929554349],["MAT","0035 5 GOREY",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","78;173;275;367;446;528;622;707;799;897;985;1089;1109;1103;1113;1131;1150;1142;1170;1207;1208;1228;1230;1212","19;45;69;102;117;141;175;197;222;260;287;322;326;331;350;346;371;367;365;376;373;361;364;361","0;0;0;0;0;0;0;0;0;0;0;0;19;45;69;102;117;141;175;197;222;260;287;322","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,697,0.03825274586542103],["MAT","0029 3 CLONMEL",5,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","80;191;288;377;492;593;689;792;889;979;1063;1160;1178;1170;1177;1182;1173;1177;1177;1177;1176;1187;1205;1204","19;38;54;67;87;106;131;148;169;190;207;226;226;226;228;230;229;231;222;223;220;216;216;216","0;0;0;0;0;0;0;0;0;0;0;0;19;38;54;67;87;106;131;148;169;190;207;226","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,1,5.4,0.10150375939849623,692,0.03800025249337205],["MAT","0035 3 ENNISCORTHY",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","64;132;210;281;361;418;501;590;684;768;861;947;966;984;999;1016;1014;1016;1030;1016;1009;1029;1035;1031","37;71;104;138;168;189;224;266;310;351;392;431;430;435;453;465;473;475;483;480;476;488;490;497","0;0;0;0;0;0;0;0;0;0;0;0;37;71;104;138;168;189;224;266;310;351;392;431","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,656,0.032540083322812774],["MAT","0032 4 BRAY",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","93;169;246;340;417;490;567;640;727;798;867;946;919;924;918;901;914;911;907;924;913;929;958;965","16;33;45;65;79;94;116;137;156;174;190;210;209;210;215;207;211;211;201;197;191;190;195;192","0;0;0;0;0;0;0;0;0;0;0;0;16;33;45;65;79;94;116;137;156;174;190;210","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,676,0.03045701300340866],["MAT","0030 1 RST WATERFD",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","76;145;223;318;393;472;542;618;694;770;846;904;914;931;914;892;897;886;885;901;913;913;924;952","19;35;59;88;103;129;152;173;200;223;247;267;282;297;291;280;299;302;298;310;304;302;308;321","0;0;0;0;0;0;0;0;0;0;0;0;19;35;59;88;103;129;152;173;200;223;247;267","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,641,0.03004671127382906],["MAT","0033 2 K/KENNY TWN",10,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","74;148;223;310;411;476;562;635;721;801;870;960;962;965;952;953;934;931;919;950;934;966;974;949","9;21;28;41;49;55;62;72;80;94;102;109;111;103;100;96;93;90;90;84;84;80;86;83","0;0;0;0;0;0;0;0;0;0;0;0;9;21;28;41;49;55;62;72;80;94;102;109","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,7,0.7,5.714285714285714,0.15037593984962405,638,0.029952026259310694],["MAT","0068 1 DUBLIN 4",8,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","81;176;258;346;458;532;623;718;818;897;992;1067;1072;1052;1053;1056;1012;1004;988;975;958;950;919;926","20;41;68;87;118;137;155;178;215;227;254;277;280;277;280;285;272;273;279;279;272;283;273;278","0;0;0;0;0;0;0;0;0;0;0;0;20;41;68;87;118;137;155;178;215;227;254;277","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,6,0.75,4.333333333333333,0.09774436090225563,666,0.029226107814669864],["MAT","0034 1 CARLOW COUNTY",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","62;133;205;262;326;385;452;524;590;662;734;785;792;796;790;817;829;841;853;857;870;883;903;916","14;28;44;59;75;87;107;119;134;151;172;184;181;187;186;186;188;186;182;187;187;180;175;170","0;0;0;0;0;0;0;0;0;0;0;0;14;28;44;59;75;87;107;119;134;151;172;184","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,665,0.028910491099608634],["MAT","0018 1 DUBLIN 2",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","60;110;153;206;261;297;341;381;433;456;499;544;529;691;696;691;683;686;706;714;719;789;809;898","10;26;45;60;78;93;110;121;136;139;154;172;168;172;163;160;148;138;137;135;133;148;151;146","0;0;0;0;0;0;0;0;0;0;0;0;10;26;45;60;78;93;110;121;136;139;154;172","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,662,0.028342381012498422],["MAT","0032 3 ARKLOW",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","72;139;214;308;383;444;511;593;675;735;812;865;875;895;894;879;872;859;856;853;837;847;834;844","13;28;41;62;82;100;120;144;164;178;193;206;210;216;223;221;224;218;214;213;210;217;225;229","0;0;0;0;0;0;0;0;0;0;0;0;13;28;41;62;82;100;120;144;164;178;193;206","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,640,0.02663805075116778],["MAT","0034 2 CARLOW TOWN",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","70;144;217;286;351;426;494;568;636;712;782;849;851;845;833;844;831;830;828;817;822;816;811;815","7;18;25;35;41;50;60;68;78;91;98;108;111;110;110;107;104;104;98;99;96;91;92;87","0;0;0;0;0;0;0;0;0;0;0;0;7;18;25;35;41;50;60;68;78;91;98;108","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,742,0.025722762277490215],["MAT","0070 3 DUNDRUM",1,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","61;123;188;255;311;362;428;482;541;596;655;707;722;710;707;700;705;709;688;695;692;689;681;688","11;21;31;43;52;66;89;97;109;121;134;149;160;156;168;175;175;178;168;178;185;188;187;180","0;0;0;0;0;0;0;0;0;0;0;0;11;21;31;43;52;66;89;97;109;121;134;149","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,2,0.007518796992481203,660,0.0217144299962126],["MAT","0029 2 TIPP TOWN",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","34;83;132;189;245;279;334;383;452;493;543;614;628;633;627;623;616;635;639;642;625;638;651;631","6;18;27;47;62;73;86;101;118;125;139;155;158;155;154;148;144;141;137;132;129;131;133;127","0;0;0;0;0;0;0;0;0;0;0;0;6;18;27;47;62;73;86;101;118;125;139;155","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,745,0.01991541472036359],["MAT","0060 2 STILLORGAN",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","62;105;164;216;283;346;400;471;517;575;614;650;639;656;652;659;633;614;616;586;590;569;582;584","15;21;35;50;62;81;93;115;130;141;155;167;164;175;176;176;177;177;181;175;176;177;175;180","0;0;0;0;0;0;0;0;0;0;0;0;15;21;35;50;62;81;93;115;130;141;155;167","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,702,0.01843201615957581],["MAT","0032 5 GREYSTONES",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","73;152;235;293;358;448;555;625;704;774;859;901;881;847;815;810;794;748;688;671;646;619;586;575","24;30;48;53;69;85;103;122;131;147;169;178;161;164;153;156;148;139;126;114;109;99;81;74","0;0;0;0;0;0;0;0;0;0;0;0;24;30;48;53;69;85;103;122;131;147;169;178","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,699,0.018147961116020704],["MAT","0031 1 REST LAOIS",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","35;75;110;141;170;267;306;340;375;415;462;508;528;530;554;561;574;521;527;538;546;550;570;574","7;21;32;42;50;124;135;146;153;162;173;186;191;185;184;184;187;124;130;134;140;143;150;150","0;0;0;0;0;0;0;0;0;0;0;0;7;21;32;42;50;124;135;146;153;162;173;186","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,688,0.01811639944451458],["MAT","0031 2 PORTLAOISE",7,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","27;73;119;172;211;263;298;343;379;412;445;482;498;490;483;468;467;446;455;453;460;483;509;521","3;9;14;20;23;27;31;33;38;40;43;45;47;45;43;40;39;37;37;37;37;38;39;40","0;0;0;0;0;0;0;0;0;0;0;0;3;9;14;20;23;27;31;33;38;40;43;45","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,0.7142857142857143,4.2,0.07894736842105263,664,0.016443630854690063],["MAT","0030 3 DUNGARVAN",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","24;48;79;110;138;168;191;218;251;408;560;672;708;807;811;819;827;825;836;840;839;713;590;506","8;19;30;43;53;60;68;75;86;102;111;123;129;126;124;125;135;138;141;149;148;148;147;145","0;0;0;0;0;0;0;0;0;0;0;0;8;19;30;43;53;60;68;75;86;102;111;123","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,730,0.01597020578209822],["MAT","0035 4 NEW ROSS",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","42;77;118;148;183;218;251;285;323;354;391;434;425;443;442;448;448;450;459;471;469;470;477;477","21;41;59;73;89;107;120;138;152;168;187;209;203;207;210;210;211;212;218;221;225;223;225;223","0;0;0;0;0;0;0;0;0;0;0;0;21;41;59;73;89;107;120;138;152;168;187;209","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,690,0.015054917308420653],["MAT","0032 2 WICKLOW TWN",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","39;81;115;160;202;242;283;330;380;432;487;524;525;529;540;538;545;550;551;532;512;497;472;458","6;21;29;36;50;61;75;86;104;116;129;138;137;128;125;128;123;123;122;119;112;110;105;102","0;0;0;0;0;0;0;0;0;0;0;0;6;21;29;36;50;61;75;86;104;116;129;138","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,647,0.014455245549804317],["MAT","0029 4 CASHEL",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","37;71;103;139;163;188;214;243;276;308;341;372;370;373;374;373;387;395;404;414;425;434;443;447","11;19;29;42;51;59;71;77;85;99;110;118;117;122;120;117;118;116;114;120;120;116;115;116","0;0;0;0;0;0;0;0;0;0;0;0;11;19;29;42;51;59;71;77;85;99;110;118","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,743,0.014108067163236966],["MAT","0070 1 REST DUB 14",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","47;94;143;183;221;263;293;324;364;412;443;498;476;498;497;506;499;478;490;479;475;455;453;432","12;25;36;49;64;71;75;79;85;89;94;103;96;91;85;83;72;70;73;72;76;75;77;79","0;0;0;0;0;0;0;0;0;0;0;0;12;25;36;49;64;71;75;79;85;89;94;103","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,701,0.01363464209064512],["MAT","0031 3 PTARLINGTON",null,"2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684","22;51;84;108;133;157;194;223;253;283;315;346;357;367;358;376;391;402;394;400;400;402;399;398","0;2;2;2;2;6;8;8;9;10;10;11;12;11;13;16;20;17;16;18;20;20;23;24","0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;2;2;6;8;8;9;10;10;11","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,626,0.01256154525943694]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MAT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 265\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 265 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MAT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 265\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MAT",52,61,7886,"H3",5.115384615384615,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550","890;1624;2368;3154;4024;4815;5632;6404;7231;7988;8793;9550;9383;9428;9413;9369;9218;9045;8964;8921;8784;8697;8650;8608","2715;5285;7836;10518;13271;15794;18451;21038;23707;26380;29121;31730;31663;32178;32186;32225;32083;31819;31803;31903;31707;31751;31720;31684",0.8524590163934426],["National","MAT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;2835;5685;8738;11941;15165;18153;22337;25467;28823;31963;35255;38329","2835;5685;8738;11941;15165;18153;22337;25467;28823;31963;35255;38329;38613;38992;38950;39121;38974;38679;37579;37428;36987;36930;36855;36852","12448;25175;38046;51138;63983;75740;89419;101829;115073;128181;141631;154336;155310;157533;157349;157846;157884;157579;156984;157477;156615;156449;156225;155884",null]]},"SELECT \r\nCASE WHEN 'Month' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='265' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n''  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.marketSalesUnit marketSalesUnitT ,\r\nfsB.MarketSalesUnit marketSalesUnitB,\r\nFsb.SalesUnit SalesUnitB  ,\r\nFsb.SalesUnitPY,\r\nFsT.SalesUnit SalesUnitT,\r\n  --Fsb.SalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.marketSalesUnitLastMonth<>0 and fsT.marketSalesUnitLastMonth is not null then (fsB.MarketSalesUnitLastMonth /fsT.marketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 265\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 265\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 265 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","SALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["","0061 1 DUN LAOIRE",6,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","326;373;314;378;371;345;415;355;345;334;386;358;330;399;327;378;365;299;362;336;307;335;348;310","79;106;87;110;113;81;108;101;91;88;109;101;76;116;80;96;95;78;107;80;82;82;99;94","0;0;0;0;0;0;0;0;0;0;0;0;79;106;87;110;113;81;108;101;91;88;109;101","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,3,0.5,1,0.13043478260869565,682,0.12048192771084337],["","0030 2 WATERFD CTY",15,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","369;150;181;163;289;180;167;161;189;159;179;132;146;219;140;128;130;128;147;147;100;113;142;165","287;70;102;65;202;98;101;100;114;92;94;56;78;61;58;45;46;43;55;54;35;40;45;47","0;0;0;0;0;0;0;0;0;0;0;0;287;70;102;65;202;98;101;100;114;92;94;56","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,5,0.3333333333333333,1.2,0.2608695652173913,709,0.06412747765254567],["","0035 2 WEXFORD TWN",8,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","153;144;132;148;142;132;132;114;133;155;141;154;151;164;147;155;160;119;168;167;150;176;136;156","79;83;75;84;69;69;67;55;72;76;72;82;81;75;77;74;70;64;82;71;76;69;72;74","0;0;0;0;0;0;0;0;0;0;0;0;79;83;75;84;69;69;67;55;72;76;72;82","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,4,0.5,1,0.17391304347826086,713,0.060629615235134084],["","0018 1 DUBLIN 2",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","60;50;43;53;55;36;44;40;52;23;43;45;45;212;48;48;47;39;64;48;57;93;63;134","10;16;19;15;18;15;17;11;15;3;15;18;6;20;10;12;6;5;16;9;13;18;18;13","0;0;0;0;0;0;0;0;0;0;0;0;10;16;19;15;18;15;17;11;15;3;15;18","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,662,0.05207928488146133],["","0029 1 REST S TIPP",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","125;130;115;132;126;126;125;147;123;155;108;141;131;173;139;139;152;137;133;138;130;151;136;132","30;32;37;37;42;41;41;53;44;47;29;46;34;43;37;37;41;38;34;34;36;33;37;35","0;0;0;0;0;0;0;0;0;0;0;0;30;32;37;37;42;41;41;53;44;47;29;46","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,691,0.05130198212203653],["","0035 1 RST WEXFORD",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","134;134;126;137;131;120;140;149;114;128;129;133;123;124;134;117;124;109;120;125;127;113;134;122","46;58;54;58;56;49;61;66;57;60;60;59;56;59;64;57;53;48;57;61;58;47;64;59","0;0;0;0;0;0;0;0;0;0;0;0;46;58;54;58;56;49;61;66;57;60;60;59","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,759,0.04741546832491255],["","0032 1 RST WICKLOW",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","135;101;127;126;118;106;111;101;131;108;119;108;124;122;102;128;124;80;104;104;90;117;131;109","21;23;34;30;32;25;25;18;37;17;32;26;22;30;18;34;27;21;24;26;25;19;33;31","0;0;0;0;0;0;0;0;0;0;0;0;21;23;34;30;32;25;25;18;37;17;32;26","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,746,0.04236300038865138],["","0033 1 K/KENNY CO",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","74;54;65;66;84;70;80;74;84;82;93;93;97;96;99;106;103;91;103;144;94;134;134;100","15;14;12;15;15;20;21;16;19;18;22;19;18;22;24;17;20;16;20;22;17;20;19;20","0;0;0;0;0;0;0;0;0;0;0;0;15;14;12;15;15;20;21;16;19;18;22;19","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,635,0.0388651379712398],["","0029 3 CLONMEL",5,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","80;111;97;89;115;101;96;103;97;90;84;97;98;103;104;94;106;105;96;103;96;101;102;96","19;19;16;13;20;19;25;17;21;21;17;19;19;19;18;15;19;21;16;18;18;17;17;19","0;0;0;0;0;0;0;0;0;0;0;0;19;19;16;13;20;19;25;17;21;21;17;19","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,0.2,1,0.043478260869565216,692,0.0373105324523902],["","0060 1 BLACKROCK",1,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","86;104;82;119;90;99;98;104;102;96;97;92;133;93;102;113;99;90;105;98;101;104;101;93","26;24;20;37;21;31;28;29;29;25;35;24;36;29;23;45;27;27;27;27;26;25;29;23","0;0;0;0;0;0;0;0;0;0;0;0;26;24;20;37;21;31;28;29;29;25;35;24","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,721,0.03614457831325301],["","0030 1 RST WATERFD",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","76;69;78;95;75;79;70;76;76;76;76;58;86;86;61;73;80;68;69;92;88;76;87;86","19;16;24;29;15;26;23;21;27;23;24;20;34;31;18;18;34;29;19;33;21;21;30;33","0;0;0;0;0;0;0;0;0;0;0;0;19;16;24;29;15;26;23;21;27;23;24;20","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,641,0.03342401865526622],["","0032 4 BRAY",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","93;76;77;94;77;73;77;73;87;71;69;79;66;81;71;77;90;70;73;90;76;87;98;86","16;17;12;20;14;15;22;21;19;18;16;20;15;18;17;12;18;15;12;17;13;17;21;17","0;0;0;0;0;0;0;0;0;0;0;0;16;17;12;20;14;15;22;21;19;18;16;20","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,676,0.03342401865526622],["","0035 5 GOREY",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","78;95;102;92;79;82;94;85;92;98;88;104;98;89;112;110;98;74;122;122;93;118;90;86","19;26;24;33;15;24;34;22;25;38;27;35;23;31;43;29;40;20;32;33;22;26;30;32","0;0;0;0;0;0;0;0;0;0;0;0;19;26;24;33;15;24;34;22;25;38;27;35","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,697,0.03342401865526622],["","0035 3 ENNISCORTHY",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","64;68;78;71;80;57;83;89;94;84;93;86;83;86;93;88;78;59;97;75;87;104;99;82","37;34;33;34;30;21;35;42;44;41;41;39;36;39;51;46;38;23;43;39;40;53;43;46","0;0;0;0;0;0;0;0;0;0;0;0;37;34;33;34;30;21;35;42;44;41;41;39","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,656,0.031869413136416634],["","0068 1 DUBLIN 4",8,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","81;95;82;88;112;74;91;95;100;79;95;75;86;75;83;91;68;66;75;82;83;71;64;82","20;21;27;19;31;19;18;23;37;12;27;23;23;18;30;24;18;20;24;23;30;23;17;28","0;0;0;0;0;0;0;0;0;0;0;0;20;21;27;19;31;19;18;23;37;12;27;23","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,4,0.5,1.25,0.21739130434782608,666,0.031869413136416634],["","0034 2 CARLOW TOWN",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","70;74;73;69;65;75;68;74;68;76;70;67;72;68;61;80;52;74;66;63;73;70;65;71","7;11;7;10;6;9;10;8;10;13;7;10;10;10;7;7;3;9;4;9;7;8;8;5","0;0;0;0;0;0;0;0;0;0;0;0;7;11;7;10;6;9;10;8;10;13;7;10","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,742,0.027594247959580254],["","0033 2 K/KENNY TWN",10,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","74;74;75;87;101;65;86;73;86;80;69;90;76;77;62;88;82;62;74;104;70;112;77;65","9;12;7;13;8;6;7;10;8;14;8;7;11;4;4;9;5;3;7;4;8;10;14;4","0;0;0;0;0;0;0;0;0;0;0;0;9;12;7;13;8;6;7;10;8;14;8;7","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,638,0.025262339681305868],["","0034 1 CARLOW COUNTY",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","62;71;72;57;64;59;67;72;66;72;72;51;69;75;66;84;76;71;79;76;79;85;92;64","14;14;16;15;16;12;20;12;15;17;21;12;11;20;15;15;18;10;16;17;15;10;16;7","0;0;0;0;0;0;0;0;0;0;0;0;14;14;16;15;16;12;20;12;15;17;21;12","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,665,0.02487368830159347],["","0032 3 ARKLOW",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","72;67;75;94;75;61;67;82;82;60;77;53;82;87;74;79;68;48;64;79;66;70;64;63","13;15;13;21;20;18;20;24;20;14;15;13;17;21;20;19;23;12;16;23;17;21;23;17","0;0;0;0;0;0;0;0;0;0;0;0;13;15;13;21;20;18;20;24;20;14;15;13","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,640,0.024485036921881073],["","0070 3 DUNDRUM",1,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","61;62;65;67;56;51;66;54;59;55;59;52;76;50;62;60;61;55;45;61;56;52;51;59","11;10;10;12;9;14;23;8;12;12;13;15;22;6;22;19;9;17;13;18;19;15;12;8","0;0;0;0;0;0;0;0;0;0;0;0;11;10;10;12;9;14;23;8;12;12;13;15","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,1,1,1,0.043478260869565216,660,0.02293043140303148],["","0029 2 TIPP TOWN",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","34;49;49;57;56;34;55;49;69;41;50;71;48;54;43;53;49;53;59;52;52;54;63;51","6;12;9;20;15;11;13;15;17;7;14;16;9;9;8;14;11;8;9;10;14;9;16;10","0;0;0;0;0;0;0;0;0;0;0;0;6;12;9;20;15;11;13;15;17;7;14;16","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,745,0.019821220365332296],["","0031 1 REST LAOIS",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","35;40;35;31;29;97;39;34;35;40;47;46;55;42;59;38;42;44;45;45;43;44;67;50","7;14;11;10;8;74;11;11;7;9;11;13;12;8;10;10;11;11;17;15;13;12;18;13","0;0;0;0;0;0;0;0;0;0;0;0;7;14;11;10;8;74;11;11;7;9;11;13","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,688,0.0194325689856199],["","0031 2 PORTLAOISE",7,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","27;46;46;53;39;52;35;45;36;33;33;37;43;38;39;38;38;31;44;43;43;56;59;49","3;6;5;6;3;4;4;2;5;2;3;2;5;4;3;3;2;2;4;2;5;3;4;3","0;0;0;0;0;0;0;0;0;0;0;0;3;6;5;6;3;4;4;2;5;2;3;2","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,3,0.42857142857142855,1,0.13043478260869565,664,0.0190439176059075],["","0035 4 NEW ROSS",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","42;35;41;30;35;35;33;34;38;31;37;43;33;53;40;36;35;37;42;46;36;32;44;43","21;20;18;14;16;18;13;18;14;16;19;22;15;24;21;14;17;19;19;21;18;14;21;20","0;0;0;0;0;0;0;0;0;0;0;0;21;20;18;14;16;18;13;18;14;16;19;22","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,690,0.01671200932763311],["","0060 2 STILLORGAN",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","62;43;59;52;67;63;54;71;46;58;39;36;51;60;55;59;41;44;56;41;50;37;52;38","15;6;14;15;12;19;12;22;15;11;14;12;12;17;15;15;13;19;16;16;16;12;12;17","0;0;0;0;0;0;0;0;0;0;0;0;15;6;14;15;12;19;12;22;15;11;14;12","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,702,0.014768752429071124],["","0029 4 CASHEL",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","37;34;32;36;24;25;26;29;33;32;33;31;35;37;33;35;38;33;35;39;44;41;42;35","11;8;10;13;9;8;12;6;8;14;11;8;10;13;8;10;10;6;10;12;8;10;10;9","0;0;0;0;0;0;0;0;0;0;0;0;11;8;10;13;9;8;12;6;8;14;11;8","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,743,0.013602798289933929],["","0070 1 REST DUB 14",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","47;47;49;40;38;42;30;31;40;48;31;55;25;69;48;49;31;21;42;20;36;28;29;34","12;13;11;13;15;7;4;4;6;4;5;9;5;8;5;11;4;5;7;3;10;3;7;11","0;0;0;0;0;0;0;0;0;0;0;0;12;13;11;13;15;7;4;4;6;4;5;9","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,701,0.013214146910221531],["","0032 5 GREYSTONES",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","73;79;83;58;65;90;107;70;79;70;85;42;53;45;51;53;49;44;47;53;54;43;52;31","24;6;18;5;16;16;18;19;9;16;22;9;7;9;7;8;8;7;5;7;4;6;4;2","0;0;0;0;0;0;0;0;0;0;0;0;24;6;18;5;16;16;18;19;9;16;22;9","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,699,0.012048192771084336],["","0031 3 PTARLINGTON",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","22;29;33;24;25;24;37;29;30;30;32;31;33;39;24;42;40;35;29;35;30;32;29;30","0;2;0;0;0;4;2;0;1;1;0;1;1;1;2;3;4;1;1;2;3;1;3;2","0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;0;0;4;2;0;1;1;0;1","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,626,0.011659541391371939],["","0030 3 DUNGARVAN",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","24;24;31;31;28;30;23;27;33;157;152;112;60;123;35;39;36;28;34;31;32;31;29;28","8;11;11;13;10;7;8;7;11;16;9;12;14;8;9;14;20;10;11;15;10;16;8;10","0;0;0;0;0;0;0;0;0;0;0;0;8;11;11;13;10;7;8;7;11;16;9;12","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,730,0.010882238631947143],["","0032 2 WICKLOW TWN",null,"2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","39;42;34;45;42;40;41;47;50;52;55;37;40;46;45;43;49;45;42;28;30;37;30;23","6;15;8;7;14;11;14;11;18;12;13;9;5;6;5;10;9;11;13;8;11;10;8;6","0;0;0;0;0;0;0;0;0;0;0;0;6;15;8;7;14;11;14;11;18;12;13;9","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","890;734;1478;2264;870;1661;2478;772;1599;2356;805;1562;2285;779;1508;2250;719;1337;2073;729;1419;2089;758;1473",1494.66666,null,null,null,null,647,0.008938981733385153]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 265\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 265 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 265\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 265\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","",21,61,7886,"H3",1.0952380952380953,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;890;734;744;786;870;791;817;772;827;757;805;757","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573",0.3442622950819672],["National","",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;2835;2850;3053;3203;3224;2988;4184;3130;3356;3140;3292;3074","2835;2850;3053;3203;3224;2988;4184;3130;3356;3140;3292;3074;3119;3229;3011;3374;3077;2693;3084;2979;2915;3083;3217;3071","12448;12727;12871;13092;12845;11757;13679;12410;13244;13108;13450;12705;13422;14950;12687;13589;12883;11452;13084;12903;12382;12942;13226;12364",null]]},"SELECT \r\nCASE WHEN 'Month' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='346' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n''  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.marketSalesUnit marketSalesUnitT ,\r\nfsB.MarketSalesUnit marketSalesUnitB,\r\nFsb.SalesUnit SalesUnitB  ,\r\nFsb.SalesUnitPY,\r\nFsT.SalesUnit SalesUnitT,\r\n  --Fsb.SalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.marketSalesUnitLastMonth<>0 and fsT.marketSalesUnitLastMonth is not null then (fsB.MarketSalesUnitLastMonth /fsT.marketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 346\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 346\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 346 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","SALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["","0030 2 WATERFD CTY",16,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","6213;5505;5685;5216;5890;5042;5456;5845;6344;6157;5619;5643;5922;5688;5714;6042;7003;4960;5666;6207;5875;5981;6481;6247","314;147;153;153;332;214;205;170;173;192;198;50;204;99;73;71;78;57;72;71;69;82;78;76","0;0;0;0;0;0;0;0;0;0;0;0;314;147;153;153;332;214;205;170;173;192;198;50","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,0.1875,1,0.08823529411764706,709,0.0830695992127869],["","0061 1 DUN LAOIRE",3,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","5206;5971;5498;6212;5782;5179;5848;6180;5790;7021;6132;5267;5734;6293;5875;6634;6857;5529;5951;6373;6218;5977;6640;5949","53;44;48;51;62;65;67;48;74;58;69;55;62;68;66;83;50;58;64;60;52;59;35;47","0;0;0;0;0;0;0;0;0;0;0;0;53;44;48;51;62;65;67;48;74;58;69;55","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,682,0.0791069386452488],["","0033 2 K/KENNY TWN",14,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","3461;3380;3526;3698;3581;3367;3857;4110;3803;3781;3595;3293;3706;3448;3303;3469;4151;3363;3589;3735;3910;3725;3678;3806","73;77;69;100;75;63;73;74;87;68;74;64;71;59;76;70;53;58;54;57;58;67;79;61","0;0;0;0;0;0;0;0;0;0;0;0;73;77;69;100;75;63;73;74;87;68;74;64","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,9,0.6428571428571429,1,0.2647058823529412,638,0.05061035610755033],["","0029 1 REST S TIPP",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","3388;3545;3207;3158;3597;3152;3491;3543;3472;3640;3748;3392;3545;3493;3530;3677;4059;3368;3409;3708;4179;3401;4234;3581","157;124;126;144;164;148;132;160;172;119;137;120;105;135;125;134;129;146;118;127;132;119;118;129","0;0;0;0;0;0;0;0;0;0;0;0;157;124;126;144;164;148;132;160;172;119;137;120","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,691,0.04761841440387224],["","0033 1 K/KENNY CO",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2681;2579;2991;2752;2825;2811;3047;3258;2920;3277;2610;2651;3066;3160;2727;2803;3042;2922;2746;3102;3194;3200;3184;3285","53;60;57;50;65;62;60;51;46;40;47;54;68;56;50;62;72;53;63;59;62;63;70;59","0;0;0;0;0;0;0;0;0;0;0;0;53;60;57;50;65;62;60;51;46;40;47;54","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,635,0.043682348873700164],["","0030 1 RST WATERFD",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2833;2659;2889;2709;2823;2618;2736;2794;2898;3239;2629;2760;2879;2930;2919;2929;3737;2527;2853;3368;3096;3022;3099;3154","50;35;54;47;33;47;41;46;38;44;51;45;25;46;33;51;35;36;42;35;38;28;31;21","0;0;0;0;0;0;0;0;0;0;0;0;50;35;54;47;33;47;41;46;38;44;51;45","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,641,0.04194037392622536],["","0034 2 CARLOW TOWN",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","3406;3093;2789;2967;3076;3192;2636;2962;3351;2931;3309;3003;2739;3370;3149;3205;3154;2817;3009;3228;3126;3336;3487;2997","56;54;50;52;43;46;30;37;45;39;40;44;41;44;35;44;46;33;43;45;45;61;60;52","0;0;0;0;0;0;0;0;0;0;0;0;56;54;50;52;43;46;30;37;45;39;40;44","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,742,0.039852663492992206],["","0035 3 ENNISCORTHY",6,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2265;2496;2862;2467;2959;2152;2237;2846;2477;2780;2373;2261;2419;2360;2453;2579;2806;2411;2273;2686;2564;2650;3117;2915","64;54;73;69;60;68;59;80;65;64;62;74;63;60;51;78;55;58;53;63;62;56;77;58","0;0;0;0;0;0;0;0;0;0;0;0;64;54;73;69;60;68;59;80;65;64;62;74","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,0.6666666666666666,1.25,0.14705882352941177,656,0.03876226696098508],["","0035 2 WEXFORD TWN",2,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","3583;2761;3054;2905;2687;2314;2805;2739;3008;3286;2866;2868;3017;3078;3005;3082;3254;3035;3155;2864;3278;3196;3279;2902","56;86;110;87;61;85;100;80;55;111;88;85;80;94;73;103;74;78;67;101;81;96;89;104","0;0;0;0;0;0;0;0;0;0;0;0;56;86;110;87;61;85;100;80;55;111;88;85","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,713,0.0385893992181059],["","0035 1 RST WEXFORD",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2977;2979;3092;3116;3376;2662;2735;2696;3150;2716;2769;2644;2810;2911;2717;2965;3342;2805;3208;3030;2903;2897;3236;2859","75;82;92;74;74;62;69;72;55;59;59;52;65;61;74;74;67;67;74;79;65;74;71;68","0;0;0;0;0;0;0;0;0;0;0;0;75;82;92;74;74;62;69;72;55;59;59;52","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,759,0.03801760591473631],["","0031 2 PORTLAOISE",6,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2225;2533;2304;2412;2683;2213;2514;2591;2378;2794;2586;2416;2558;2731;2463;2702;2713;2239;2639;2762;2650;2552;2743;2561","57;65;65;64;57;61;66;46;68;56;64;50;63;58;62;63;41;45;54;46;46;56;58;36","0;0;0;0;0;0;0;0;0;0;0;0;57;65;65;64;57;61;66;46;68;56;64;50","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,0.8333333333333334,1.2,0.17647058823529413,664,0.03405494534719821],["","0032 4 BRAY",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2483;2440;2347;2487;2651;2262;2197;2442;2574;2644;2511;2008;2724;2493;2154;2232;2695;2106;2586;2633;2671;2446;2661;2508","35;43;53;34;33;33;53;29;33;30;36;23;38;31;40;38;42;27;47;55;46;46;42;40","0;0;0;0;0;0;0;0;0;0;0;0;35;43;53;34;33;33;53;29;33;30;36;23","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,676,0.03335017685699848],["","0018 1 DUBLIN 2",7,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2380;2295;2376;2187;2194;1999;3077;4517;3725;2887;2392;2442;2301;2438;2130;2731;2701;2307;2462;2824;2621;2753;2867;2507","42;26;36;29;32;29;24;28;26;24;42;30;28;24;27;25;28;25;37;22;26;29;31;32","0;0;0;0;0;0;0;0;0;0;0;0;42;26;36;29;32;29;24;28;26;24;42;30","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.2857142857142857,1,0.058823529411764705,662,0.03333687933831547],["","0032 1 RST WICKLOW",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2788;2340;2585;2312;2697;2223;2395;2363;2722;2635;2580;2325;2763;2554;2135;2953;2699;2527;2455;2750;2497;2612;2695;2452","32;31;46;41;35;51;39;44;45;47;46;45;54;36;39;44;50;28;32;29;31;49;36;47","0;0;0;0;0;0;0;0;0;0;0;0;32;31;46;41;35;51;39;44;45;47;46;45","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,746,0.03260551581074971],["","0070 3 DUNDRUM",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1130;740;762;5312;3188;833;3559;2511;2233;1727;1349;1395;1323;1018;1176;2501;1437;2050;1300;2096;1212;990;1636;2316","7;11;9;12;7;10;36;8;17;17;22;42;18;13;16;20;19;15;25;21;15;48;24;20","0;0;0;0;0;0;0;0;0;0;0;0;7;11;9;12;7;10;36;8;17;17;22;42","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,660,0.030797053269859844],["","0068 1 DUBLIN 4",5,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1975;2459;2043;2384;2465;1838;2435;2337;2261;2431;2246;1991;2303;2264;2247;2531;2312;2313;2470;2148;2655;2478;2349;2309","36;43;29;29;26;31;33;24;24;22;24;14;28;29;17;23;20;28;26;33;29;31;27;23","0;0;0;0;0;0;0;0;0;0;0;0;36;43;29;29;26;31;33;24;24;22;24;14","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,1,0.2,1,0.029411764705882353,666,0.030703970639078745],["","0029 3 CLONMEL",9,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2415;2220;2264;2218;2160;2111;2085;2422;2368;2355;2319;2125;2189;2376;2279;2165;2397;2327;2366;2383;2518;2322;2433;2292","38;35;48;32;49;23;34;36;36;29;27;37;28;22;20;30;17;25;19;28;28;32;35;18","0;0;0;0;0;0;0;0;0;0;0;0;38;35;48;32;49;23;34;36;36;29;27;37","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,0.4444444444444444,1,0.11764705882352941,692,0.030477912821467515],["","0035 5 GOREY",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1586;1846;1832;2031;1938;1883;2043;2131;2354;2239;2160;2105;2281;2241;2135;2380;2546;2204;2652;2466;2358;2584;2727;2290","22;31;16;12;20;26;16;27;29;19;21;30;24;27;14;22;19;21;27;33;23;33;30;26","0;0;0;0;0;0;0;0;0;0;0;0;22;31;16;12;20;26;16;27;29;19;21;30","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,697,0.030451317784101487],["","0060 1 BLACKROCK",3,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1824;1863;1961;1784;1817;1625;1862;1742;2016;1787;1717;1727;1849;1803;1803;1936;1901;1941;1831;1990;1875;1896;1937;1909","22;13;33;26;20;20;16;17;14;18;20;18;21;13;17;29;22;29;18;23;17;25;20;23","0;0;0;0;0;0;0;0;0;0;0;0;22;13;33;26;20;20;16;17;14;18;20;18","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,1,0.3333333333333333,1,0.029411764705882353,721,0.02538496316587325],["","0031 1 REST LAOIS",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1589;1724;1595;1716;1773;1436;1658;1726;1838;1764;1850;1995;1610;1679;1925;1667;1728;1587;1940;1922;1870;1683;1854;1735","31;27;28;37;33;30;35;33;38;30;28;39;31;31;35;30;43;39;41;31;32;32;35;36","0;0;0;0;0;0;0;0;0;0;0;0;31;27;28;37;33;30;35;33;38;30;28;39","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,688,0.023071194915028854],["","0034 1 CARLOW COUNTY",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1587;1946;1675;1750;1707;1432;1696;1802;1771;1859;1635;1542;1656;1764;1746;1678;1795;1618;1704;1603;1845;1779;1881;1691","24;27;36;35;25;19;24;29;29;29;17;35;24;32;37;39;33;36;36;23;41;27;39;38","0;0;0;0;0;0;0;0;0;0;0;0;24;27;36;35;25;19;24;29;29;29;17;35","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,665,0.02248610409297625],["","0032 3 ARKLOW",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1580;1601;1604;1593;1570;1335;1554;1587;1672;1582;1650;1522;1626;1702;1639;1972;1716;1671;1963;1723;1849;1876;1861;1674","31;52;44;46;42;29;37;34;27;35;44;32;41;53;57;52;44;47;65;54;60;50;44;46","0;0;0;0;0;0;0;0;0;0;0;0;31;52;44;46;42;29;37;34;27;35;44;32","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,640,0.022260046275365018],["","0030 3 DUNGARVAN",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1783;1527;1483;1319;1655;1257;1495;1734;1760;1937;1494;1780;1490;1735;1465;1531;1822;1461;1635;1591;1513;1696;2124;1668","16;17;15;15;11;17;21;13;19;17;29;11;21;19;13;11;11;10;25;10;7;8;10;11","0;0;0;0;0;0;0;0;0;0;0;0;16;17;15;15;11;17;21;13;19;17;29;11","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,730,0.022180261163266934],["","0032 5 GREYSTONES",4,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","2275;2436;2221;2194;2476;1896;2612;2208;2798;2463;2399;1546;1599;1592;1503;1720;1678;1499;1577;1685;1728;1705;1813;1593","30;16;32;20;26;21;29;21;34;21;33;12;10;10;12;17;14;17;26;17;16;17;16;10","0;0;0;0;0;0;0;0;0;0;0;0;30;16;32;20;26;21;29;21;34;21;33;12","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,1,0.25,1,0.029411764705882353,699,0.021182947262040903],["","0035 4 NEW ROSS",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1408;1308;1334;1396;1308;1222;1308;1377;1421;1355;1491;1310;1539;1488;1268;1505;1558;1284;1439;1484;1427;1613;1681;1485","19;19;16;15;17;17;16;22;13;14;20;15;17;20;22;13;22;16;23;13;17;17;18;18","0;0;0;0;0;0;0;0;0;0;0;0;19;19;16;15;17;17;16;22;13;14;20;15","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,690,0.019746815244275417],["","0032 2 WICKLOW TWN",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1285;1463;1165;1386;1384;1021;1364;1452;1476;1486;1398;1362;1258;1242;1373;1435;1503;1171;1593;1373;1620;1722;1589;1352","37;31;43;45;48;39;47;49;35;51;35;53;30;41;22;28;31;19;34;23;15;17;28;18","0;0;0;0;0;0;0;0;0;0;0;0;37;31;43;45;48;39;47;49;35;51;35;53","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,647,0.01797824525943459],["","0029 2 TIPP TOWN",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1259;909;1314;1035;1218;1005;1176;969;1305;1038;1025;1275;1224;1220;1229;1205;1113;1119;1241;1242;1235;1337;1298;1283","79;58;80;104;99;58;74;67;77;82;55;86;62;72;86;68;73;78;78;75;99;100;96;96","0;0;0;0;0;0;0;0;0;0;0;0;79;58;80;104;99;58;74;67;77;82;55;86","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,745,0.01706071647030664],["","0031 3 PTARLINGTON",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1035;1360;1124;1238;1001;982;1108;1183;1428;1344;1135;1085;1169;1507;934;1263;1117;1230;1363;1263;1315;1157;1196;1175","2;4;2;3;6;7;3;4;4;1;3;0;4;0;0;0;0;2;0;2;2;5;4;1","0;0;0;0;0;0;0;0;0;0;0;0;2;4;2;3;6;7;3;4;4;1;3;0","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,626,0.015624584452541154],["","0060 2 STILLORGAN",3,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","1241;1207;1000;1136;1153;921;1298;1231;1111;1302;938;888;1135;1116;1353;1098;1102;1055;1440;978;1316;1437;1203;1088","25;14;15;17;16;14;24;18;20;13;23;5;16;16;5;13;12;14;6;11;10;12;9;7","0;0;0;0;0;0;0;0;0;0;0;0;25;14;15;17;16;14;24;18;20;13;23;5","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.6666666666666666,1,0.058823529411764705,702,0.014467700327118959],["","0070 1 REST DUB 14",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","791;988;786;929;883;658;894;824;1097;1004;948;808;1040;885;947;971;1031;932;862;969;933;926;1038;908","10;12;7;10;8;14;15;7;9;4;14;7;8;10;10;10;10;11;13;9;9;7;14;8","0;0;0;0;0;0;0;0;0;0;0;0;10;12;7;10;8;14;15;7;9;4;14;7","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,701,0.012074146964176484],["","0029 4 CASHEL",null,"71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","655;614;714;658;693;599;675;658;625;785;626;678;713;719;687;768;698;642;714;743;659;824;757;711","24;9;18;15;17;16;20;11;18;16;25;12;14;14;15;16;15;12;28;15;13;13;20;18","0;0;0;0;0;0;0;0;0;0;0;0;24;9;18;15;17;16;20;11;18;16;25;12","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,743,0.009454535783622774]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 346\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 346 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.StartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.SalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.SalesUnitPY SalesUnitPY ,\r\nFsT.SalesUnit SalesUnit,\r\nFsT.MarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 346\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","",32,72,7886,"H3",1.0625,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202",0.4444444444444444],["National","",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;5943;5671;6125;5631;6295;5374;7213;5522;5647;5386;5770;5030","5943;5671;6125;5631;6295;5374;7213;5522;5647;5386;5770;5030;5618;5476;5280;5820;5412;5282;5487;5363;5054;5338;5505;5041","323015;308364;313383;320151;319136;280965;320057;323095;343892;360225;315477;305859;328977;327926;312003;344554;350700;308203;337950;339261;341406;341711;360475;327487",null]]},"SELECT \r\nCASE WHEN 'MAT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='346' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'MAT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MATmarketSalesUnit marketSalesUnitT ,\r\nfsB.MATMarketSalesUnit marketSalesUnitB,\r\nFsb.MATSalesUnit SalesUnitB  ,\r\nFsb.MATSalesUnitPY,\r\nFsT.MATSalesUnit SalesUnitT,\r\n  --Fsb.MATSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MATmarketSalesUnitLastMonth<>0 and fsT.MATmarketSalesUnitLastMonth is not null then (fsB.MATMarketSalesUnitLastMonth /fsT.MATmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 346\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 346\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 346 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MATSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MAT","0061 1 DUN LAOIRE",3,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","5206;11177;16675;22887;28669;33848;39696;45876;51666;58687;64819;70086;70614;70936;71313;71735;72810;73160;73263;73456;73884;72840;73348;74030","53;97;145;196;258;323;390;438;512;570;639;694;703;727;745;777;765;758;755;767;745;746;712;704","0;0;0;0;0;0;0;0;0;0;0;0;53;97;145;196;258;323;390;438;512;570;639;694","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,5.333333333333333,0.041025641025641026,682,0.08225857170318467],["MAT","0030 2 WATERFD CTY",16,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","6213;11718;17403;22619;28509;33551;39007;44852;51196;57353;62972;68615;68324;68507;68536;69362;70475;70393;70603;70965;70496;70320;71182;71786","314;461;614;767;1099;1313;1518;1688;1861;2053;2251;2301;2191;2143;2063;1981;1727;1570;1437;1338;1234;1124;1004;1030","0;0;0;0;0;0;0;0;0;0;0;0;314;461;614;767;1099;1313;1518;1688;1861;2053;2251;2301","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,14,0.875,7.214285714285714,0.258974358974359,709,0.07976514694427685],["MAT","0029 1 REST S TIPP",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","3388;6933;10140;13298;16895;20047;23538;27081;30553;34193;37941;41333;41490;41438;41761;42280;42742;42958;42876;43041;43748;43509;43995;44184","157;281;407;551;715;863;995;1155;1327;1446;1583;1703;1651;1662;1661;1651;1616;1614;1600;1567;1527;1527;1508;1517","0;0;0;0;0;0;0;0;0;0;0;0;157;281;407;551;715;863;995;1155;1327;1446;1583;1703","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,691,0.0490951334882279],["MAT","0033 2 K/KENNY TWN",14,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","3461;6841;10367;14065;17646;21013;24870;28980;32783;36564;40159;43452;43697;43765;43542;43313;43883;43879;43611;43236;43343;43287;43370;43883","73;150;219;319;394;457;530;604;691;759;833;897;895;877;884;854;832;827;808;791;762;761;766;763","0;0;0;0;0;0;0;0;0;0;0;0;73;150;219;319;394;457;530;604;691;759;833;897","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,12,0.8571428571428571,6.25,0.19230769230769232,638,0.04876067678037083],["MAT","0034 2 CARLOW TOWN",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","3406;6499;9288;12255;15331;18523;21159;24121;27472;30403;33712;36715;36048;36325;36685;36923;37001;36626;36999;37265;37040;37445;37623;37617","56;110;160;212;255;301;331;368;413;452;492;536;521;511;496;488;491;478;491;499;499;521;541;549","0;0;0;0;0;0;0;0;0;0;0;0;56;110;160;212;255;301;331;368;413;452;492;536","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,742,0.04179819926730647],["MAT","0035 2 WEXFORD TWN",2,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","3583;6344;9398;12303;14990;17304;20109;22848;25856;29142;32008;34876;34310;34627;34578;34755;35322;36043;36393;36518;36788;36698;37111;37145","56;142;252;339;400;485;585;665;720;831;919;1004;1028;1036;999;1015;1028;1021;988;1009;1035;1020;1021;1040","0;0;0;0;0;0;0;0;0;0;0;0;56;142;252;339;400;485;585;665;720;831;919;1004","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,1,2.5,0.01282051282051282,713,0.04127373559252728],["MAT","0030 1 RST WATERFD",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2833;5492;8381;11090;13913;16531;19267;22061;24959;28198;30827;33587;33633;33904;33934;34154;35068;34977;35094;35668;35866;35649;36119;36513","50;85;139;186;219;266;307;353;391;435;486;531;506;517;496;500;502;491;492;481;481;465;445;421","0;0;0;0;0;0;0;0;0;0;0;0;50;85;139;186;219;266;307;353;391;435;486;531","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,641,0.04057148762121278],["MAT","0033 1 K/KENNY CO",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2681;5260;8251;11003;13828;16639;19686;22944;25864;29141;31751;34402;34787;35368;35104;35155;35372;35483;35182;35026;35300;35223;35797;36431","53;113;170;220;285;347;407;458;504;544;591;645;660;656;649;661;668;659;662;670;686;709;732;737","0;0;0;0;0;0;0;0;0;0;0;0;53;113;170;220;285;347;407;458;504;544;591;645","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,635,0.04048037316923843],["MAT","0035 1 RST WEXFORD",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2977;5956;9048;12164;15540;18202;20937;23633;26783;29499;32268;34912;34745;34677;34302;34151;34117;34260;34733;35067;34820;35001;35468;35683","75;157;249;323;397;459;528;600;655;714;773;825;815;794;776;776;769;774;779;786;796;811;823;839","0;0;0;0;0;0;0;0;0;0;0;0;75;157;249;323;397;459;528;600;655;714;773;825","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,759,0.03964923158293582],["MAT","0031 2 PORTLAOISE",6,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2225;4758;7062;9474;12157;14370;16884;19475;21853;24647;27233;29649;29982;30180;30339;30629;30659;30685;30810;30981;31253;31011;31168;31313","57;122;187;251;308;369;435;481;549;605;669;719;725;718;715;714;698;682;670;670;648;648;642;628","0;0;0;0;0;0;0;0;0;0;0;0;57;122;187;251;308;369;435;481;549;605;669;719","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,6,1,6.333333333333333,0.09743589743589744,664,0.03479349798381496],["MAT","0035 3 ENNISCORTHY",6,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2265;4761;7623;10090;13049;15201;17438;20284;22761;25541;27914;30175;30329;30193;29784;29896;29743;30002;30038;29878;29965;29835;30579;31233","64;118;191;260;320;388;447;527;592;656;718;792;791;797;775;784;779;769;763;746;743;735;750;734","0;0;0;0;0;0;0;0;0;0;0;0;64;118;191;260;320;388;447;527;592;656;718;792","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,0.8333333333333334,6.2,0.07948717948717948,656,0.034704605835547304],["MAT","0032 1 RST WICKLOW",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2788;5128;7713;10025;12722;14945;17340;19703;22425;25060;27640;29965;29940;30154;29704;30345;30347;30651;30711;31098;30873;30850;30965;31092","32;63;109;150;185;236;275;319;364;411;457;502;524;529;522;525;540;517;510;495;481;483;473;475","0;0;0;0;0;0;0;0;0;0;0;0;32;63;109;150;185;236;275;319;364;411;457;502","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,746,0.03454793342422555],["MAT","0018 1 DUBLIN 2",7,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2380;4675;7051;9238;11432;13431;16508;21025;24750;27637;30029;32471;32392;32535;32289;32833;33340;33648;33033;31340;30236;30102;30577;30642","42;68;104;133;165;194;218;246;272;296;338;368;354;352;343;339;335;331;344;338;338;343;332;334","0;0;0;0;0;0;0;0;0;0;0;0;42;68;104;133;165;194;218;246;272;296;338;368","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,6,0.8571428571428571,3.3333333333333335,0.05128205128205128,662,0.034047915090219975],["MAT","0032 4 BRAY",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2483;4923;7270;9757;12408;14670;16867;19309;21883;24527;27038;29046;29287;29340;29147;28892;28936;28780;29169;29360;29457;29259;29409;29909","35;78;131;165;198;231;284;313;346;376;412;435;438;426;413;417;426;420;414;440;453;469;475;492","0;0;0;0;0;0;0;0;0;0;0;0;35;78;131;165;198;231;284;313;346;376;412;435","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,676,0.03323344078171755],["MAT","0035 5 GOREY",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1586;3432;5264;7295;9233;11116;13159;15290;17644;19883;22043;24148;24843;25238;25541;25890;26498;26819;27428;27763;27767;28112;28679;28864","22;53;69;81;101;127;143;170;199;218;239;269;271;267;265;275;274;269;280;286;280;294;303;299","0;0;0;0;0;0;0;0;0;0;0;0;22;53;69;81;101;127;143;170;199;218;239;269","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,697,0.03207228709497126],["MAT","0068 1 DUBLIN 4",5,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1975;4434;6477;8861;11326;13164;15599;17936;20197;22628;24874;26865;27193;26998;27202;27349;27196;27671;27706;27517;27911;27958;28061;28379","36;79;108;137;163;194;227;251;275;297;321;335;327;313;301;295;289;286;279;288;293;302;305;314","0;0;0;0;0;0;0;0;0;0;0;0;36;79;108;137;163;194;227;251;275;297;321;335","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,1,2.8,0.035897435897435895,666,0.031533378446098576],["MAT","0029 3 CLONMEL",9,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2415;4635;6899;9117;11277;13388;15473;17895;20263;22618;24937;27062;26836;26992;27007;26954;27191;27407;27688;27649;27799;27766;27880;28047","38;73;121;153;202;225;259;295;331;360;387;424;414;401;373;371;339;341;326;318;310;313;321;302","0;0;0;0;0;0;0;0;0;0;0;0;38;73;121;153;202;225;259;295;331;360;387;424","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,7,0.7777777777777778,6,0.1076923076923077,692,0.031164476030787796],["MAT","0060 1 BLACKROCK",3,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1824;3687;5648;7432;9249;10874;12736;14478;16494;18281;19998;21725;21750;21690;21532;21684;21768;22084;22053;22301;22160;22269;22489;22671","22;35;68;94;114;134;150;167;181;199;219;237;236;236;220;223;225;234;236;242;245;252;252;257","0;0;0;0;0;0;0;0;0;0;0;0;22;35;68;94;114;134;150;167;181;199;219;237","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,6,0.046153846153846156,721,0.02519092366720113],["MAT","0032 3 ARKLOW",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1580;3181;4785;6378;7948;9283;10837;12424;14096;15678;17328;18850;18896;18997;19032;19411;19557;19893;20302;20438;20615;20909;21120;21272","31;83;127;173;215;244;281;315;342;377;421;453;463;464;477;483;485;503;531;551;584;599;599;613","0;0;0;0;0;0;0;0;0;0;0;0;31;83;127;173;215;244;281;315;342;377;421;453","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,640,0.02363642222437045],["MAT","0031 1 REST LAOIS",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1589;3313;4908;6624;8397;9833;11491;13217;15055;16819;18669;20664;20685;20640;20970;20921;20876;21027;21309;21505;21537;21456;21460;21200","31;58;86;123;156;186;221;254;292;322;350;389;389;393;400;393;403;412;418;416;410;412;419;416","0;0;0;0;0;0;0;0;0;0;0;0;31;58;86;123;156;186;221;254;292;322;350;389","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,688,0.023556419290929557],["MAT","0034 1 CARLOW COUNTY",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1587;3533;5208;6958;8665;10097;11793;13595;15366;17225;18860;20402;20471;20289;20360;20288;20376;20562;20570;20371;20445;20365;20611;20760","24;51;87;122;147;166;190;219;248;277;294;329;329;334;335;339;347;364;376;370;382;380;402;405","0;0;0;0;0;0;0;0;0;0;0;0;24;51;87;122;147;166;190;219;248;277;294;329","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,665,0.023067512475457432],["MAT","0030 3 DUNGARVAN",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1783;3310;4793;6112;7767;9024;10519;12253;14013;15950;17444;19224;18931;19139;19121;19333;19500;19704;19844;19701;19454;19213;19843;19731","16;33;48;63;74;91;112;125;144;161;190;201;206;208;206;202;202;195;199;196;184;175;156;156","0;0;0;0;0;0;0;0;0;0;0;0;16;33;48;63;74;91;112;125;144;161;190;201","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,730,0.021924137218364673],["MAT","0032 5 GREYSTONES",4,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","2275;4711;6932;9126;11602;13498;16110;18318;21116;23579;25978;27524;26848;26004;25286;24812;24014;23617;22582;22059;20989;20231;19645;19692","30;46;78;98;124;145;174;195;229;250;283;295;275;269;249;246;234;230;227;223;205;201;184;182","0;0;0;0;0;0;0;0;0;0;0;0;30;46;78;98;124;145;174;195;229;250;283;295","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,1,5,0.05128205128205128,699,0.02188080229608419],["MAT","0070 3 DUNDRUM",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1130;1870;2632;7944;11132;11965;15524;18035;20268;21995;23344;24739;24932;25210;25624;22813;21062;22279;20020;19605;18584;17847;18134;19055","7;18;27;39;46;56;92;100;117;134;156;198;209;211;218;226;238;243;232;245;243;274;276;254","0;0;0;0;0;0;0;0;0;0;0;0;7;18;27;39;46;56;92;100;117;134;156;198","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,660,0.021172998565502955],["MAT","0035 4 NEW ROSS",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1408;2716;4050;5446;6754;7976;9284;10661;12082;13437;14928;16238;16369;16549;16483;16592;16842;16904;17035;17142;17148;17406;17596;17771","19;38;54;69;86;103;119;141;154;168;188;203;201;202;208;206;211;210;217;208;212;215;213;216","0;0;0;0;0;0;0;0;0;0;0;0;19;38;54;69;86;103;119;141;154;168;188;203","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,690,0.019746279585807033],["MAT","0032 2 WICKLOW TWN",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1285;2748;3913;5299;6683;7704;9068;10520;11996;13482;14880;16242;16215;15994;16202;16251;16370;16520;16749;16670;16814;17050;17241;17231","37;68;111;156;204;243;290;339;374;425;460;513;506;516;495;478;461;441;428;402;382;348;341;306","0;0;0;0;0;0;0;0;0;0;0;0;37;68;111;156;204;243;290;339;374;425;460;513","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,647,0.01914625758500034],["MAT","0029 2 TIPP TOWN",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1259;2168;3482;4517;5735;6740;7916;8885;10190;11228;12253;13528;13493;13804;13719;13889;13784;13898;13963;14236;14166;14465;14738;14746","79;137;217;321;420;478;552;619;696;778;833;919;902;916;922;886;860;880;884;892;914;932;973;983","0;0;0;0;0;0;0;0;0;0;0;0;79;137;217;321;420;478;552;619;696;778;833;919","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,745,0.01638504522943619],["MAT","0031 3 PTARLINGTON",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1035;2395;3519;4757;5758;6740;7848;9031;10459;11803;12938;14023;14157;14304;14114;14139;14255;14503;14758;14838;14725;14538;14599;14689","2;6;8;11;17;24;27;31;35;36;39;39;41;37;35;32;26;21;18;16;14;18;19;20","0;0;0;0;0;0;0;0;0;0;0;0;2;6;8;11;17;24;27;31;35;36;39;39","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,626,0.016321709573795484],["MAT","0060 2 STILLORGAN",3,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","1241;2448;3448;4584;5737;6658;7956;9187;10298;11600;12538;13426;13320;13229;13582;13544;13493;13627;13769;13516;13721;13856;14121;14321","25;39;54;71;87;101;125;143;163;176;199;204;195;197;187;183;179;179;161;154;144;143;129;131","0;0;0;0;0;0;0;0;0;0;0;0;25;39;54;71;87;101;125;143;163;176;199;204","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,3.3333333333333335,0.02564102564102564,702,0.015912805691764252],["MAT","0070 1 REST DUB 14",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","791;1779;2565;3494;4377;5035;5929;6753;7850;8854;9802;10610;10859;10756;10917;10959;11107;11381;11349;11494;11330;11252;11342;11442","10;22;29;39;47;61;76;83;92;96;110;117;115;113;116;116;118;115;113;115;115;118;118;119","0;0;0;0;0;0;0;0;0;0;0;0;10;22;29;39;47;61;76;83;92;96;110;117","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,701,0.012713799505981886],["MAT","0029 4 CASHEL",null,"71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967","655;1269;1983;2641;3334;3933;4608;5266;5891;6676;7302;7980;8038;8143;8116;8226;8231;8274;8313;8398;8432;8471;8602;8635","24;33;51;66;83;99;119;130;148;164;189;201;191;196;193;194;192;188;196;200;195;192;187;193","0;0;0;0;0;0;0;0;0;0;0;0;24;33;51;66;83;99;119;130;148;164;189;201","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,743,0.009594796253640412]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MAT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 346\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 346 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MAT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MATSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MATSalesUnitPY SalesUnitPY ,\r\nFsT.MATSalesUnit SalesUnit,\r\nFsT.MATMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 346\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MAT",66,72,7886,"H3",5.803030303030303,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278","1570;2917;4420;5888;7484;8909;10407;11792;13217;14586;16039;17278;17072;17018;16737;16630;16259;16022;15834;15719;15540;15530;15421;15429","71307;142094;212176;286853;362063;425303;499156;575936;654082;732328;804427;872534;873414;875925;875826;877478;881935;887715;887953;888102;886666;884193;892872;899967",0.9166666666666666],["National","MAT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;5943;11614;17739;23370;29665;35039;42252;47774;53421;58807;64577;69607","5943;11614;17739;23370;29665;35039;42252;47774;53421;58807;64577;69607;69282;69087;68242;68431;67548;67456;65730;65571;64978;64930;64665;64676","323015;631379;944762;1264913;1584049;1865014;2185071;2508166;2852058;3212283;3527760;3833619;3839581;3859143;3857763;3882166;3913730;3940968;3958861;3975027;3972541;3954027;3999025;4020653",null]]},"SELECT \r\nCASE WHEN 'YTD' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='346' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'YTD'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.YTDmarketSalesUnit marketSalesUnitT ,\r\nfsB.YTDMarketSalesUnit marketSalesUnitB,\r\nFsb.YTDSalesUnit SalesUnitB  ,\r\nFsb.YTDSalesUnitPY,\r\nFsT.YTDSalesUnit SalesUnitT,\r\n  --Fsb.YTDSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.YTDmarketSalesUnitLastMonth<>0 and fsT.YTDmarketSalesUnitLastMonth is not null then (fsB.YTDMarketSalesUnitLastMonth /fsT.YTDmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 346\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 346\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 346 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","YTDSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["YTD","0061 1 DUN LAOIRE",3,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","5206;5971;11469;17681;23463;28642;34490;40670;46460;53481;59613;64880;70614;6293;12168;18802;25659;31188;37139;43512;49730;55707;62347;68296","53;44;92;143;205;270;337;385;459;517;586;641;703;68;134;217;267;325;389;449;501;560;595;642","0;0;0;0;0;0;0;0;0;0;0;0;53;44;92;143;205;270;337;385;459;517;586;641","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,5.333333333333333,0.0427807486631016,682,0.08250501340935998],["YTD","0030 2 WATERFD CTY",16,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","6213;5505;11190;16406;22296;27338;32794;38639;44983;51140;56759;62402;68324;5688;11402;17444;24447;29407;35073;41280;47155;53136;59617;65864","314;147;300;453;785;999;1204;1374;1547;1739;1937;1987;2191;99;172;243;321;378;450;521;590;672;750;826","0;0;0;0;0;0;0;0;0;0;0;0;314;147;300;453;785;999;1204;1374;1547;1739;1937;1987","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,14,0.875,6.785714285714286,0.2540106951871658,709,0.07956703471936988],["YTD","0029 1 REST S TIPP",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","3388;3545;6752;9910;13507;16659;20150;23693;27165;30805;34553;37945;41490;3493;7023;10700;14759;18127;21536;25244;29423;32824;37058;40639","157;124;250;394;558;706;838;998;1170;1289;1426;1546;1651;135;260;394;523;669;787;914;1046;1165;1283;1412","0;0;0;0;0;0;0;0;0;0;0;0;157;124;250;394;558;706;838;998;1170;1289;1426;1546","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,691,0.049093962163859965],["YTD","0033 2 K/KENNY TWN",14,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","3461;3380;6906;10604;14185;17552;21409;25519;29322;33103;36698;39991;43697;3448;6751;10220;14371;17734;21323;25058;28968;32693;36371;40177","73;77;146;246;321;384;457;531;618;686;760;824;895;59;135;205;258;316;370;427;485;552;631;692","0;0;0;0;0;0;0;0;0;0;0;0;73;77;146;246;321;384;457;531;618;686;760;824","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,12,0.8571428571428571,6.083333333333333,0.19518716577540107,638,0.0485358428567977],["YTD","0034 2 CARLOW TOWN",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","3406;3093;5882;8849;11925;15117;17753;20715;24066;26997;30306;33309;36048;3370;6519;9724;12878;15695;18704;21932;25058;28394;31881;34878","56;54;104;156;199;245;275;312;357;396;436;480;521;44;79;123;169;202;245;290;335;396;456;508","0;0;0;0;0;0;0;0;0;0;0;0;56;54;104;156;199;245;275;312;357;396;436;480","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,742,0.04213438353185629],["YTD","0035 2 WEXFORD TWN",2,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","3583;2761;5815;8720;11407;13721;16526;19265;22273;25559;28425;31293;34310;3078;6083;9165;12419;15454;18609;21473;24751;27947;31226;34128","56;86;196;283;344;429;529;609;664;775;863;948;1028;94;167;270;344;422;489;590;671;767;856;960","0;0;0;0;0;0;0;0;0;0;0;0;56;86;196;283;344;429;529;609;664;775;863;948","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,1,2,0.0106951871657754,713,0.041228345695716255],["YTD","0030 1 RST WATERFD",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2833;2659;5548;8257;11080;13698;16434;19228;22126;25365;27994;30754;33633;2930;5849;8778;12515;15042;17895;21263;24359;27381;30480;33634","50;35;89;136;169;216;257;303;341;385;436;481;506;46;79;130;165;201;243;278;316;344;375;396","0;0;0;0;0;0;0;0;0;0;0;0;50;35;89;136;169;216;257;303;341;385;436;481","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,641,0.04063156877431202],["YTD","0033 1 K/KENNY CO",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2681;2579;5570;8322;11147;13958;17005;20263;23183;26460;29070;31721;34787;3160;5887;8690;11732;14654;17400;20502;23696;26896;30080;33365","53;60;117;167;232;294;354;405;451;491;538;592;660;56;106;168;240;293;356;415;477;540;610;669","0;0;0;0;0;0;0;0;0;0;0;0;53;60;117;167;232;294;354;405;451;491;538;592","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,635,0.04030660320374979],["YTD","0035 1 RST WEXFORD",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2977;2979;6071;9187;12563;15225;17960;20656;23806;26522;29291;31935;34745;2911;5628;8593;11935;14740;17948;20978;23881;26778;30014;32873","75;82;174;248;322;384;453;525;580;639;698;750;815;61;135;209;276;343;417;496;561;635;706;774","0;0;0;0;0;0;0;0;0;0;0;0;75;82;174;248;322;384;453;525;580;639;698;750","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,759,0.039712242383241926],["YTD","0035 3 ENNISCORTHY",6,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2265;2496;5358;7825;10784;12936;15173;18019;20496;23276;25649;27910;30329;2360;4813;7392;10198;12609;14882;17568;20132;22782;25899;28814","64;54;127;196;256;324;383;463;528;592;654;728;791;60;111;189;244;302;355;418;480;536;613;671","0;0;0;0;0;0;0;0;0;0;0;0;64;54;127;196;256;324;383;463;528;592;654;728","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,0.8333333333333334,5.8,0.07754010695187166,656,0.034808765614052044],["YTD","0031 2 PORTLAOISE",6,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2225;2533;4837;7249;9932;12145;14659;17250;19628;22422;25008;27424;29982;2731;5194;7896;10609;12848;15487;18249;20899;23451;26194;28755","57;65;130;194;251;312;378;424;492;548;612;662;725;58;120;183;224;269;323;369;415;471;529;565","0;0;0;0;0;0;0;0;0;0;0;0;57;65;130;194;251;312;378;424;492;548;612;662","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,6,1,5.5,0.08823529411764706,664,0.034737490637609024],["YTD","0018 1 DUBLIN 2",7,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2380;2295;4671;6858;9052;11051;14128;18645;22370;25257;27649;30091;32392;2438;4568;7299;10000;12307;14769;17593;20214;22967;25834;28341","42;26;62;91;123;152;176;204;230;254;296;326;354;24;51;76;104;129;166;188;214;243;274;306","0;0;0;0;0;0;0;0;0;0;0;0;42;26;62;91;123;152;176;204;230;254;296;326","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,6,0.8571428571428571,3.3333333333333335,0.053475935828877004,662,0.03423735775205972],["YTD","0032 1 RST WICKLOW",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2788;2340;4925;7237;9934;12157;14552;16915;19637;22272;24852;27177;29940;2554;4689;7642;10341;12868;15323;18073;20570;23182;25877;28329","32;31;77;118;153;204;243;287;332;379;425;470;524;36;75;119;169;197;229;258;289;338;374;421","0;0;0;0;0;0;0;0;0;0;0;0;32;31;77;118;153;204;243;287;332;379;425;470","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,746,0.03422286114668149],["YTD","0032 4 BRAY",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2483;2440;4787;7274;9925;12187;14384;16826;19400;22044;24555;26563;29287;2493;4647;6879;9574;11680;14266;16899;19570;22016;24677;27185","35;43;96;130;163;196;249;278;311;341;377;400;438;31;71;109;151;178;225;280;326;372;414;454","0;0;0;0;0;0;0;0;0;0;0;0;35;43;96;130;163;196;249;278;311;341;377;400","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,676,0.03284085143395588],["YTD","0035 5 GOREY",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1586;1846;3678;5709;7647;9530;11573;13704;16058;18297;20457;22562;24843;2241;4376;6756;9302;11506;14158;16624;18982;21566;24293;26583","22;31;47;59;79;105;121;148;177;196;217;247;271;27;41;63;82;103;130;163;186;219;249;275","0;0;0;0;0;0;0;0;0;0;0;0;22;31;47;59;79;105;121;148;177;196;217;247","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,697,0.032113605064147475],["YTD","0068 1 DUBLIN 4",5,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1975;2459;4502;6886;9351;11189;13624;15961;18222;20653;22899;24890;27193;2264;4511;7042;9354;11667;14137;16285;18940;21418;23767;26076","36;43;72;101;127;158;191;215;239;261;285;299;327;29;46;69;89;117;143;176;205;236;263;286","0;0;0;0;0;0;0;0;0;0;0;0;36;43;72;101;127;158;191;215;239;261;285;299","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,1,2.8,0.0374331550802139,666,0.03150112348691681],["YTD","0029 3 CLONMEL",9,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2415;2220;4484;6702;8862;10973;13058;15480;17848;20203;22522;24647;26836;2376;4655;6820;9217;11544;13910;16293;18811;21133;23566;25858","38;35;83;115;164;187;221;257;293;322;349;386;414;22;42;72;89;114;133;161;189;221;256;274","0;0;0;0;0;0;0;0;0;0;0;0;38;35;83;115;164;187;221;257;293;322;349;386","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,7,0.7777777777777778,6,0.11229946524064172,692,0.031237768489212107],["YTD","0060 1 BLACKROCK",3,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1824;1863;3824;5608;7425;9050;10912;12654;14670;16457;18174;19901;21750;1803;3606;5542;7443;9384;11215;13205;15080;16976;18913;20822","22;13;46;72;92;112;128;145;159;177;197;215;236;13;30;59;81;110;128;151;168;193;213;236","0;0;0;0;0;0;0;0;0;0;0;0;22;13;46;72;92;112;128;145;159;177;197;215","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,6,0.0481283422459893,721,0.025154026432143806],["YTD","0032 3 ARKLOW",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1580;1601;3205;4798;6368;7703;9257;10844;12516;14098;15748;17270;18896;1702;3341;5313;7029;8700;10663;12386;14235;16111;17972;19646","31;52;96;142;184;213;250;284;311;346;390;422;463;53;110;162;206;253;318;372;432;482;526;572","0;0;0;0;0;0;0;0;0;0;0;0;31;52;96;142;184;213;250;284;311;346;390;422","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,640,0.023733359105076228],["YTD","0031 1 REST LAOIS",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1589;1724;3319;5035;6808;8244;9902;11628;13466;15230;17080;19075;20685;1679;3604;5271;6999;8586;10526;12448;14318;16001;17855;19590","31;27;55;92;125;155;190;223;261;291;319;358;389;31;66;96;139;178;219;250;282;314;349;385","0;0;0;0;0;0;0;0;0;0;0;0;31;27;55;92;125;155;190;223;261;291;319;358","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,688,0.02366570827997777],["YTD","0034 1 CARLOW COUNTY",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1587;1946;3621;5371;7078;8510;10206;12008;13779;15638;17273;18815;20471;1764;3510;5188;6983;8601;10305;11908;13753;15532;17413;19104","24;27;63;98;123;142;166;195;224;253;270;305;329;32;69;108;141;177;213;236;277;304;343;381","0;0;0;0;0;0;0;0;0;0;0;0;24;27;63;98;123;142;166;195;224;253;270;305","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,665,0.023078595762159027],["YTD","0030 3 DUNGARVAN",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1783;1527;3010;4329;5984;7241;8736;10470;12230;14167;15661;17441;18931;1735;3200;4731;6553;8014;9649;11240;12753;14449;16573;18241","16;17;32;47;58;75;96;109;128;145;174;185;206;19;32;43;54;64;89;99;106;114;124;135","0;0;0;0;0;0;0;0;0;0;0;0;16;17;32;47;58;75;96;109;128;145;174;185","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,730,0.022036048225373892],["YTD","0032 5 GREYSTONES",4,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","2275;2436;4657;6851;9327;11223;13835;16043;18841;21304;23703;25249;26848;1592;3095;4815;6493;7992;9569;11254;12982;14687;16500;18093","30;16;48;68;94;115;144;165;199;220;253;265;275;10;22;39;53;70;96;113;129;146;162;172","0;0;0;0;0;0;0;0;0;0;0;0;30;16;48;68;94;115;144;165;199;220;253;265","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,1,5,0.053475935828877004,699,0.021857256759042258],["YTD","0070 3 DUNDRUM",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1130;740;1502;6814;10002;10835;14394;16905;19138;20865;22214;23609;24932;1018;2194;4695;6132;8182;9482;11578;12790;13780;15416;17732","7;11;20;32;39;49;85;93;110;127;149;191;209;13;29;49;68;83;108;129;144;192;216;236","0;0;0;0;0;0;0;0;0;0;0;0;7;11;20;32;39;49;85;93;110;127;149;191","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,660,0.021421150547246852],["YTD","0035 4 NEW ROSS",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1408;1308;2642;4038;5346;6568;7876;9253;10674;12029;13520;14830;16369;1488;2756;4261;5819;7103;8542;10026;11453;13066;14747;16232","19;19;35;50;67;84;100;122;135;149;169;184;201;20;42;55;77;93;116;129;146;163;181;199","0;0;0;0;0;0;0;0;0;0;0;0;19;19;35;50;67;84;100;122;135;149;169;184","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,690,0.019609074874966777],["YTD","0032 2 WICKLOW TWN",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1285;1463;2628;4014;5398;6419;7783;9235;10711;12197;13595;14957;16215;1242;2615;4050;5553;6724;8317;9690;11310;13032;14621;15973","37;31;74;119;167;206;253;302;337;388;423;476;506;41;63;91;122;141;175;198;213;230;258;276","0;0;0;0;0;0;0;0;0;0;0;0;37;31;74;119;167;206;253;302;337;388;423;476","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,647,0.019296189808886418],["YTD","0029 2 TIPP TOWN",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1259;909;2223;3258;4476;5481;6657;7626;8931;9969;10994;12269;13493;1220;2449;3654;4767;5886;7127;8369;9604;10941;12239;13522","79;58;138;242;341;399;473;540;617;699;754;840;902;72;158;226;299;377;455;530;629;729;825;921","0;0;0;0;0;0;0;0;0;0;0;0;79;58;138;242;341;399;473;540;617;699;754;840","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,745,0.016335258160380776],["YTD","0031 3 PTARLINGTON",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1035;1360;2484;3722;4723;5705;6813;7996;9424;10768;11903;12988;14157;1507;2441;3704;4821;6051;7414;8677;9992;11149;12345;13520","2;4;6;9;15;22;25;29;33;34;37;37;41;0;0;0;0;2;2;4;6;11;15;16","0;0;0;0;0;0;0;0;0;0;0;0;2;4;6;9;15;22;25;29;33;34;37;37","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,626,0.016332842059484404],["YTD","0060 2 STILLORGAN",3,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","1241;1207;2207;3343;4496;5417;6715;7946;9057;10359;11297;12185;13320;1116;2469;3567;4669;5724;7164;8142;9458;10895;12098;13186","25;14;29;46;62;76;100;118;138;151;174;179;195;16;21;34;46;60;66;77;87;99;108;115","0;0;0;0;0;0;0;0;0;0;0;0;25;14;29;46;62;76;100;118;138;151;174;179","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,3.3333333333333335,0.026737967914438502,702,0.01592935320979004],["YTD","0070 1 REST DUB 14",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","791;988;1774;2703;3586;4244;5138;5962;7059;8063;9011;9819;10859;885;1832;2803;3834;4766;5628;6597;7530;8456;9494;10402","10;12;19;29;37;51;66;73;82;86;100;107;115;10;20;30;40;51;64;73;82;89;103;111","0;0;0;0;0;0;0;0;0;0;0;0;10;12;19;29;37;51;66;73;82;86;100;107","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,701,0.012566140762038222],["YTD","0029 4 CASHEL",null,"71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780","655;614;1328;1986;2679;3278;3953;4611;5236;6021;6647;7325;8038;719;1406;2174;2872;3514;4228;4971;5630;6454;7211;7922","24;9;27;42;59;75;95;106;124;140;165;177;191;14;29;45;60;72;100;115;128;141;161;179","0;0;0;0;0;0;0;0;0;0;0;0;24;9;27;42;59;75;95;106;124;140;165;177","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,743,0.009570175650535166]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'YTD' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 346\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 346 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.YTDStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'YTD' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.YTDSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.YTDSalesUnitPY SalesUnitPY ,\r\nFsT.YTDSalesUnit SalesUnit,\r\nFsT.YTDMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 346\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","YTD",66,72,7886,"H3",5.5606060606060606,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708","1570;1347;2850;4318;5914;7339;8837;10222;11647;13016;14469;15708;17072;1293;2515;3876;5101;6289;7599;8869;10115;11474;12818;14065","71307;70787;140869;215546;290756;353996;427849;504629;582775;661021;733120;801227;873414;73298;143281;219610;299277;368297;442388;519317;596027;671800;752578;827780",0.9166666666666666],["National","YTD",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;5943;5671;11796;17427;23722;29096;36309;41831;47478;52864;58634;63664","5943;5671;11796;17427;23722;29096;36309;41831;47478;52864;58634;63664;69282;5476;10756;16576;21988;27270;32757;38120;43174;48512;54017;59058","323015;308364;621747;941898;1261034;1541999;1862056;2185151;2529043;2889268;3204745;3510604;3839581;327926;639929;984483;1335183;1643386;1981336;2320597;2662003;3003714;3364189;3691676",null]]},"SELECT \r\nCASE WHEN 'MQT' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='346' ":{"columns":["VALUE"],"data":[[" "]]},"Select DISTINCT \r\n'MQT'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.MQTmarketSalesUnit marketSalesUnitT ,\r\nfsB.MQTMarketSalesUnit marketSalesUnitB,\r\nFsb.MQTSalesUnit SalesUnitB  ,\r\nFsb.MQTSalesUnitPY,\r\nFsT.MQTSalesUnit SalesUnitT,\r\n  --Fsb.MQTSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.MQTmarketSalesUnitLastMonth<>0 and fsT.MQTmarketSalesUnitLastMonth is not null then (fsB.MQTMarketSalesUnitLastMonth /fsT.MQTmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 346\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 346\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 346 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","MQTSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["MQT","0030 2 WATERFD CTY",16,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","6213;11718;17403;16406;16791;16148;16388;16343;17645;18346;18120;17419;17184;17253;17324;17444;18759;18005;17629;16833;17748;18063;18337;18709","314;461;614;453;638;699;751;589;548;535;563;440;452;353;376;243;222;206;207;200;212;222;229;236","0;0;0;0;0;0;0;0;0;0;0;0;314;461;614;453;638;699;751;589;548;535;563;440","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,12,0.75,1.5,0.1487603305785124,709,0.08072818906335624],["MQT","0061 1 DUN LAOIRE",3,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","5206;11177;16675;17681;17492;17173;16809;17207;17818;18991;18943;18420;17133;17294;17902;18802;19366;19020;18337;17853;18542;18568;18835;18566","53;97;145;143;161;178;194;180;189;180;201;182;186;185;196;217;199;191;172;182;176;171;146;141","0;0;0;0;0;0;0;0;0;0;0;0;53;97;145;143;161;178;194;180;189;180;201;182","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,1.3333333333333333,0.03305785123966942,682,0.08011115282218569],["MQT","0029 1 REST S TIPP",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","3388;6933;10140;9910;9962;9907;10240;10186;10506;10655;10860;10780;10685;10430;10568;10700;11266;11104;10836;10485;11296;11288;11814;11216","157;281;407;394;434;456;444;440;464;451;428;376;362;360;365;394;388;409;393;391;377;378;369;366","0;0;0;0;0;0;0;0;0;0;0;0;157;281;407;394;434;456;444;440;464;451;428;376","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,691,0.04839635301376897],["MQT","0033 2 K/KENNY TWN",14,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","3461;6841;10367;10604;10805;10646;10805;11334;11770;11694;11179;10669;10594;10447;10457;10220;10923;10983;11103;10687;11234;11370;11313;11209","73;150;219;246;244;238;211;210;234;229;229;206;209;194;206;205;199;181;165;169;169;182;204;207","0;0;0;0;0;0;0;0;0;0;0;0;73;150;219;246;244;238;211;210;234;229;229;206","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,11,0.7857142857142857,3.272727272727273,0.2975206611570248,638,0.048366148442522856],["MQT","0034 2 CARLOW TOWN",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","3406;6499;9288;8849;8832;9235;8904;8790;8949;9244;9591;9243;9051;9112;9258;9724;9508;9176;8980;9054;9363;9690;9949;9820","56;110;160;156;145;141;119;113;112;121;124;123;125;129;120;123;125;123;122;121;133;151;166;173","0;0;0;0;0;0;0;0;0;0;0;0;56;110;160;156;145;141;119;113;112;121;124;123","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,742,0.04237269851954451],["MQT","0033 1 K/KENNY CO",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2681;5260;8251;8322;8568;8388;8683;9116;9225;9455;8807;8538;8327;8877;8953;8690;8572;8767;8710;8770;9042;9496;9578;9669","53;113;170;167;172;177;187;173;157;137;133;141;169;178;174;168;184;187;188;175;184;184;195;192","0;0;0;0;0;0;0;0;0;0;0;0;53;113;170;167;172;177;187;173;157;137;133;141","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,635,0.041721142768378405],["MQT","0035 2 WEXFORD TWN",2,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","3583;6344;9398;8720;8646;7906;7806;7858;8552;9033;9160;9020;8751;8963;9100;9165;9341;9371;9444;9054;9297;9338;9753;9377","56;142;252;283;258;233;246;265;235;246;254;284;253;259;247;270;250;255;219;246;249;278;266;289","0;0;0;0;0;0;0;0;0;0;0;0;56;142;252;283;258;233;246;265;235;246;254;284","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,1,0.5,2,0.01652892561983471,713,0.040461180653540624],["MQT","0030 1 RST WATERFD",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2833;5492;8381;8257;8421;8150;8177;8148;8428;8931;8766;8628;8268;8569;8728;8778;9585;9193;9117;8748;9317;9486;9217;9275","50;85;139;136;134;127;121;134;125;128;133;140;121;116;104;130;119;122;113;113;115;101;97;80","0;0;0;0;0;0;0;0;0;0;0;0;50;85;139;136;134;127;121;134;125;128;133;140","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,641,0.040021056901097286],["MQT","0035 1 RST WEXFORD",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2977;5956;9048;9187;9584;9154;8773;8093;8581;8562;8635;8129;8223;8365;8438;8593;9024;9112;9355;9043;9141;8830;9036;8992","75;157;249;248;240;210;205;203;196;186;173;170;176;178;200;209;215;208;208;220;218;218;210;213","0;0;0;0;0;0;0;0;0;0;0;0;75;157;249;248;240;210;205;203;196;186;173;170","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,759,0.038799929235004506],["MQT","0035 3 ENNISCORTHY",6,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2265;4761;7623;7825;8288;7578;7348;7235;7560;8103;7630;7414;7053;7040;7232;7392;7838;7796;7490;7370;7523;7900;8331;8682","64;118;191;196;202;197;187;207;204;209;191;200;199;197;174;189;184;191;166;174;178;181;195;191","0;0;0;0;0;0;0;0;0;0;0;0;64;118;191;196;202;197;187;207;204;209;191;200","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,0.8333333333333334,2,0.08264462809917356,656,0.03746229822267673],["MQT","0018 1 DUBLIN 2",7,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2380;4675;7051;6858;6757;6380;7270;9593;11319;11129;9004;7721;7135;7181;6869;7299;7562;7739;7470;7593;7907;8198;8241;8127","42;68;104;91;97;90;85;81;78;78;92;96;100;82;79;76;80;78;90;84;85;77;86;92","0;0;0;0;0;0;0;0;0;0;0;0;42;68;104;91;97;90;85;81;78;78;92;96","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.2857142857142857,2.5,0.04132231404958678,662,0.03506750721673506],["MQT","0031 2 PORTLAOISE",6,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2225;4758;7062;7249;7399;7308;7410;7318;7483;7763;7758;7796;7560;7705;7752;7896;7878;7654;7591;7640;8051;7964;7945;7856","57;122;187;194;186;182;184;173;180;170;188;170;177;171;183;183;166;149;140;145;146;148;160;150","0;0;0;0;0;0;0;0;0;0;0;0;57;122;187;194;186;182;184;173;180;170;188;170","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,0.8333333333333334,1.6,0.06611570247933884,664,0.03389815881563561],["MQT","0032 1 RST WICKLOW",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2788;5128;7713;7237;7594;7232;7315;6981;7480;7720;7937;7540;7668;7642;7452;7642;7787;8179;7681;7732;7702;7859;7804;7759","32;63;109;118;122;127;125;134;128;136;138;138;145;135;129;119;133;122;110;89;92;109;116;132","0;0;0;0;0;0;0;0;0;0;0;0;32;63;109;118;122;127;125;134;128;136;138;138","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,746,0.0334796097569395],["MQT","0032 4 BRAY",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2483;4923;7270;7274;7485;7400;7110;6901;7213;7660;7729;7163;7243;7225;7371;6879;7081;7033;7387;7325;7890;7750;7778;7615","35;78;131;130;120;100;119;115;115;92;99;89;97;92;109;109;120;107;116;129;148;147;134;128","0;0;0;0;0;0;0;0;0;0;0;0;35;78;131;130;120;100;119;115;115;92;99;89","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,676,0.032858258577019496],["MQT","0035 5 GOREY",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1586;3432;5264;5709;5801;5852;5864;6057;6528;6724;6753;6504;6546;6627;6657;6756;7061;7130;7402;7322;7476;7408;7669;7601","22;53;69;59;48;58;62;69;72;75;69;70;75;81;65;63;55;62;67;81;83;89;86;89","0;0;0;0;0;0;0;0;0;0;0;0;22;53;69;59;48;58;62;69;72;75;69;70","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,697,0.03279784943452728],["MQT","0068 1 DUBLIN 4",5,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1975;4434;6477;6886;6892;6687;6738;6610;7033;7029;6938;6668;6540;6558;6814;7042;7090;7156;7095;6931;7273;7281;7482;7136","36;79;108;101;84;86;90;88;81;70;70;60;66;71;74;69;60;71;74;87;88;93;87;81","0;0;0;0;0;0;0;0;0;0;0;0;36;79;108;101;84;86;90;88;81;70;70;60","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,1,1.4,0.05785123966942149,666,0.030791402916035607],["MQT","0029 3 CLONMEL",9,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2415;4635;6899;6702;6642;6489;6356;6618;6875;7145;7042;6799;6633;6690;6844;6820;6841;6889;7090;7076;7267;7223;7273;7047","38;73;121;115;129;104;106;93;106;101;92;93;92;87;70;72;67;72;61;72;75;88;95;85","0;0;0;0;0;0;0;0;0;0;0;0;38;73;121;115;129;104;106;93;106;101;92;93","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,7,0.7777777777777778,1.8571428571428572,0.10743801652892562,692,0.03040737336733505],["MQT","0060 1 BLACKROCK",3,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1824;3687;5648;5608;5562;5226;5304;5229;5620;5545;5520;5231;5293;5379;5455;5542;5640;5778;5673;5762;5696;5761;5708;5742","22;35;68;72;79;66;56;53;47;49;52;56;59;52;51;59;68;80;69;70;58;65;62;68","0;0;0;0;0;0;0;0;0;0;0;0;22;35;68;72;79;66;56;53;47;49;52;56","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,2.3333333333333335,0.05785123966942149,721,0.02477637829931004],["MQT","0030 3 DUNGARVAN",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1783;3310;4793;4329;4457;4231;4407;4486;4989;5431;5191;5211;4764;5005;4690;4731;4818;4814;4918;4687;4739;4800;5333;5488","16;33;48;47;41;43;49;51;53;49;65;57;61;51;53;43;35;32;46;45;42;25;25;29","0;0;0;0;0;0;0;0;0;0;0;0;16;33;48;47;41;43;49;51;53;49;65;57","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,730,0.02368038385695115],["MQT","0032 3 ARKLOW",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1580;3181;4785;4798;4767;4498;4459;4476;4813;4841;4904;4754;4798;4850;4967;5313;5327;5359;5350;5357;5535;5448;5586;5411","31;83;127;142;132;117;108;100;98;96;106;111;117;126;151;162;153;143;156;166;179;164;154;140","0;0;0;0;0;0;0;0;0;0;0;0;31;83;127;142;132;117;108;100;98;96;106;111","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,640,0.023348133573243928],["MQT","0034 1 CARLOW COUNTY",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1587;3533;5208;5371;5132;4889;4835;4930;5269;5432;5265;5036;4833;4962;5166;5188;5219;5091;5117;4925;5152;5227;5505;5351","24;51;87;98;96;79;68;72;82;87;75;81;76;91;93;108;109;108;105;95;100;91;107;104","0;0;0;0;0;0;0;0;0;0;0;0;24;51;87;98;96;79;68;72;82;87;75;81","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,665,0.02308923724827726],["MQT","0031 1 REST LAOIS",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1589;3313;4908;5035;5084;4925;4867;4820;5222;5328;5452;5609;5455;5284;5214;5271;5320;4982;5255;5449;5732;5475;5407;5272","31;58;86;92;98;100;98;98;106;101;96;97;98;101;97;96;108;112;123;111;104;95;99;103","0;0;0;0;0;0;0;0;0;0;0;0;31;58;86;92;98;100;98;98;106;101;96;97","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,688,0.02274835708707115],["MQT","0032 5 GREYSTONES",4,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","2275;4711;6932;6851;6891;6566;6984;6716;7618;7469;7660;6408;5544;4737;4694;4815;4901;4897;4754;4761;4990;5118;5246;5111","30;46;78;68;78;67;76;71;84;76;88;66;55;32;32;39;43;48;57;60;59;50;49;43","0;0;0;0;0;0;0;0;0;0;0;0;30;46;78;68;78;67;76;71;84;76;88;66","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,1,2,0.06611570247933884,699,0.022053651948410594],["MQT","0070 3 DUNDRUM",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1130;1870;2632;6814;9262;9333;7580;6903;8303;6471;5309;4471;4067;3736;3517;4695;5114;5988;4787;5446;4608;4298;3838;4942","7;18;27;32;28;29;53;54;61;42;56;81;82;73;47;49;55;54;59;61;61;84;87;92","0;0;0;0;0;0;0;0;0;0;0;0;7;18;27;32;28;29;53;54;61;42;56;81","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,660,0.021324427299754478],["MQT","0035 4 NEW ROSS",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1408;2716;4050;4038;4038;3926;3838;3907;4106;4153;4267;4156;4340;4337;4295;4261;4331;4347;4281;4207;4350;4524;4721;4779","19;38;54;50;48;49;50;55;51;49;47;49;52;52;59;55;57;51;61;52;53;47;52;53","0;0;0;0;0;0;0;0;0;0;0;0;19;38;54;50;48;49;50;55;51;49;47;49","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,690,0.020621092283595033],["MQT","0032 2 WICKLOW TWN",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1285;2748;3913;4014;3935;3791;3769;3837;4292;4414;4360;4246;4018;3862;3873;4050;4311;4109;4267;4137;4586;4715;4931;4663","37;68;111;119;136;132;134;135;131;135;121;139;118;124;93;91;81;78;84;76;72;55;60;63","0;0;0;0;0;0;0;0;0;0;0;0;37;68;111;119;136;132;134;135;131;135;121;139","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,647,0.020120559388659476],["MQT","0029 2 TIPP TOWN",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1259;2168;3482;3258;3567;3258;3399;3150;3450;3312;3368;3338;3524;3719;3673;3654;3547;3437;3473;3602;3718;3814;3870;3918","79;137;217;242;283;261;231;199;218;226;214;223;203;220;220;226;227;219;229;231;252;274;295;292","0;0;0;0;0;0;0;0;0;0;0;0;79;137;217;242;283;261;231;199;218;226;214;223","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,745,0.01690593002032336],["MQT","0060 2 STILLORGAN",3,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1241;2448;3448;3343;3289;3210;3372;3450;3640;3644;3351;3128;2961;3139;3604;3567;3553;3255;3597;3473;3734;3731;3956;3728","25;39;54;46;48;47;54;56;62;51;56;41;44;37;37;34;30;39;32;31;27;33;31;28","0;0;0;0;0;0;0;0;0;0;0;0;25;39;54;46;48;47;54;56;62;51;56;41","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.6666666666666666,1.5,0.024793388429752067,702,0.016086091657928916],["MQT","0031 3 PTARLINGTON",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","1035;2395;3519;3722;3363;3221;3091;3273;3719;3955;3907;3564;3389;3761;3610;3704;3314;3610;3710;3856;3941;3735;3668;3528","2;6;8;9;11;16;16;14;11;9;8;4;7;4;4;0;0;2;2;4;4;9;11;10","0;0;0;0;0;0;0;0;0;0;0;0;2;6;8;9;11;16;16;14;11;9;8;4","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,626,0.015223103908040025],["MQT","0070 1 REST DUB 14",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","791;1779;2565;2703;2598;2470;2435;2376;2815;2925;3049;2760;2796;2733;2872;2803;2949;2934;2825;2763;2764;2828;2897;2872","10;22;29;29;25;32;37;36;31;20;27;25;29;25;28;30;30;31;34;33;31;25;30;29","0;0;0;0;0;0;0;0;0;0;0;0;10;22;29;29;25;32;37;36;31;20;27;25","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,701,0.012392504088404465],["MQT","0029 4 CASHEL",null,"71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753","655;1269;1983;1986;2065;1950;1967;1932;1958;2068;2036;2089;2017;2110;2119;2174;2153;2108;2054;2099;2116;2226;2240;2292","24;33;51;42;50;48;53;47;49;45;59;53;51;40;43;45;46;43;55;55;56;41;46;51","0;0;0;0;0;0;0;0;0;0;0;0;24;33;51;42;50;48;53;47;49;45;59;53","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,743,0.009889839613726683]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'MQT' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 346\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 346 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.MQTStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'MQT' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.MQTSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.MQTSalesUnitPY SalesUnitPY ,\r\nFsT.MQTSalesUnit SalesUnit,\r\nFsT.MQTMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 346\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","MQT",57,72,7886,"H3",2.0701754385964914,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061","1570;2917;4420;4318;4567;4489;4519;4308;4308;4179;4247;4061;4056;3896;3879;3876;3808;3774;3723;3768;3826;3875;3949;3950","71307;142094;212176;215546;219969;213127;212303;213873;228779;233172;228491;218452;212393;213592;215468;219610;225979;225016;222778;220040;227730;229412;233261;231753",0.7916666666666666],["National","MQT",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;5943;11614;17739;17427;18051;17300;18882;18109;18382;16555;16803;16186","5943;11614;17739;17427;18051;17300;18882;18109;18382;16555;16803;16186;16418;16124;16374;16576;16512;16514;16181;16132;15904;15755;15897;15884","323015;631379;944762;941898;952670;920252;920158;924117;987044;1027212;1019594;981561;950313;962762;968906;984483;1007257;1003457;996853;985414;1018617;1022378;1043592;1029673",null]]},"SELECT \r\nCASE WHEN 'Srv. QTR' ='Srv. QTR' \r\nTHEN  cast (round(1.0*(FqT .QTRQuotaUnit/Fqt.QTRSalesUnit )*100,2) as varchar) \r\n ELSE ' '\r\nEND\r\n as value\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P \r\nINNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT ON FqT.productId=P.ProductId \r\nAND FqT.DateId =20150801\r\nINNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on   Fqt.TerritoryId=T.TerritoryId\r\nWhere P.ProductId='346' ":{"columns":["VALUE"],"data":[["103.72"]]},"Select DISTINCT \r\n'QTR'  as Period,\r\n   B.BrickName as Minibrick,\r\n   FPOA.NBMedecins as [No of Target Drs (A)],\r\n fsT.QTRmarketSalesUnit marketSalesUnitT ,\r\nfsB.QTRMarketSalesUnit marketSalesUnitB,\r\nFsb.QTRSalesUnit SalesUnitB  ,\r\nFsb.QTRSalesUnitPY,\r\nFsT.QTRSalesUnit SalesUnitT,\r\n  --Fsb.QTRSalesUnit UnitSales,\r\nFst.QTRSalesUnit QTRSalesUnitT,\r\nFqT.QTRQuotaUnit,\r\n   FEvent.NbDocSeen as [No of Target Drs Seen],\r\n   case when FPOA.NBMedecins<>0 and FPOA.NBMedecins is not null then cast(FEvent.NbDocSeen as float)/cast(FPOA.NBMedecins as float) else null end Coverage,\r\n  case when FEvent.NbDocSeen<>0 and FEvent.NbDocSeen is not null then cast( FEvent.NbPres as float)/ cast(FEvent.NbDocSeen as float) else null end Frequency,\r\n   case when FEvent.NbTotal <>0 and FEvent.NbTotal is not null then cast(FEvent.NbPres as float)/cast(FEvent.NbTotal as float) else null end  QLPres,\r\nB.BrickID,\r\n  case when fsT.QTRmarketSalesUnitLastMonth<>0 and fsT.QTRmarketSalesUnitLastMonth is not null then (fsB.QTRMarketSalesUnitLastMonth /fsT.QTRmarketSalesUnitLastMonth) else null end\r\nas QLMarket \r\n\r\n  FROM \r\n  (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FsB \r\n  LEFT OUTER JOIN  \r\n  (\r\n  SELECT \r\n  POA.BrickId,\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins ,TotalDocs.NbTotal as NbMedcTotal\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n       INNER JOIN (\r\n\t           SELECT \r\n \r\n                             POA.TerritoryId, \r\n                             count(CustomerId) as NbTotal \r\n                             From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\twhere 1=1  and ProductId= 346\r\n                             GROUP BY  POA.TerritoryId\r\n\t            ) TotalDocs\r\n    ON  TotalDocs.TerritoryId=POA.TerritoryId\r\n\twhere 1=1  and ProductId= 346\r\n  GROUP BY  POA.BrickId,POA.TerritoryId,TotalDocs.NbTotal \r\n  ) \r\n  AS FPOA\r\n    ON FPOA.BrickId=Fsb.BrickId --AND FsB.DateId = 20150801\r\n  INNER JOIN (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT on 1=1  and FsT.TerritoryId= 7886 /*AND  FsT.DateId =20150801*/ and FsT.ProductId=FsB.ProductId\r\n  INNER JOIN (SELECT FactQuotasTerritory.* FROM FactQuotasTerritory inner join DimProduct as P on P.ProductId=FactQuotasTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactQuotasTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n) FqT on Fst.TerritoryId=FqT.TerritoryId AND  FqT.DateId =20150801\r\n\r\nLEFT OUTER JOIN \r\n  (\r\n   SELECT \r\n   count(distinct EventId)NbPres ,count(distinct E.[CustomerId])NbDocSeen ,Total.NbTotal, POA.BrickId,POA.TerritoryId,\r\n case when Total.NbTotalDocSeen<>0 and Total.NbTotalDocSeen is not null then cast(Total.NbTotal as float)/cast(Total.NbTotalDocSeen as float) else null end as TotalFrequency From\r\n  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n INNER JOIN DimDate D on 1=1\r\n \r\n\r\n  INNER JOIN(\r\n\t\t\t  select \r\n\t\t\t  count(distinct EventId)NbTotal ,count(distinct E.[CustomerId])NbTotalDocSeen,POA.TerritoryId From\r\n\t\t\t  (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E\r\n\t\t\t  INNER JOIN (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA\r\n\t\t\t  ON E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\t\t  INNER JOIN DimDate D on 1=1\r\n\t\t\t  where E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n\t\t\t  Group by  POA.TerritoryId\r\n\t\t\t  )Total\r\n  ON Total.TerritoryId=POA.TerritoryId\r\nwhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  Group by  POA.BrickId,POA.TerritoryId ,Total.NbTotal,Total.NbTotalDocSeen\r\n  )\r\n  AS FEvent \r\n  ON FEvent.BrickId=FPOA.BrickId AnD FEvent.TerritoryId=FPOA.TerritoryId\r\n     INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B ON FsB.BrickId=B.BrickId\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId\t\r\n     AND  Fqt.TerritoryId=T.TerritoryId\r\n   INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P ON P.ProductId=FsB.ProductId AND P.ProductId=FsT.ProductId AND P.ProductId=FqT.ProductId\r\n   WHERE  1=1 and FsB.ProductId= 346 --and FsB.DateId=20150801 \r\n  ORDER BY QLMarket desc ":{"columns":["PERIOD","MINIBRICK","NO OF TARGET DRS (A)","MARKETSALESUNITT","MARKETSALESUNITB","SALESUNITB","QTRSALESUNITPY","SALESUNITT","QTRSALESUNITT","QTRQUOTAUNIT","NO OF TARGET DRS SEEN","COVERAGE","FREQUENCY","QLPRES","BRICKID","QLMARKET"],"data":[["QTR","0030 2 WATERFD CTY",16,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","6213;5505;11190;16406;5890;10932;16388;5845;12189;18346;5619;11262;17184;5688;11402;17444;7003;11963;17629;6207;12082;18063;6481;12728","314;147;300;453;332;546;751;170;343;535;198;248;452;99;172;243;78;135;207;71;140;222;78;154","0;0;0;0;0;0;0;0;0;0;0;0;314;147;300;453;332;546;751;170;343;535;198;248","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,9,0.5625,1.1111111111111112,0.13513513513513514,709,0.08160020515450699],["QTR","0061 1 DUN LAOIRE",3,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","5206;5971;11469;17681;5782;10961;16809;6180;11970;18991;6132;11399;17133;6293;12168;18802;6857;12386;18337;6373;12591;18568;6640;12589","53;44;92;143;62;127;194;48;122;180;69;124;186;68;134;217;50;108;172;60;112;171;35;82","0;0;0;0;0;0;0;0;0;0;0;0;53;44;92;143;62;127;194;48;122;180;69;124","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,3,1,1,0.04054054054054054,682,0.08070906526477753],["QTR","0029 1 REST S TIPP",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","3388;3545;6752;9910;3597;6749;10240;3543;7015;10655;3748;7140;10685;3493;7023;10700;4059;7427;10836;3708;7887;11288;4234;7815","157;124;250;394;164;312;444;160;332;451;137;257;362;135;260;394;129;275;393;127;259;378;118;247","0;0;0;0;0;0;0;0;0;0;0;0;157;124;250;394;164;312;444;160;332;451;137;257","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,691,0.050102577253494034],["QTR","0033 2 K/KENNY TWN",14,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","3461;3380;6906;10604;3581;6948;10805;4110;7913;11694;3595;6888;10594;3448;6751;10220;4151;7514;11103;3735;7645;11370;3678;7484","73;77;146;246;75;138;211;74;161;229;74;138;209;59;135;205;53;111;165;57;115;182;79;140","0;0;0;0;0;0;0;0;0;0;0;0;73;77;146;246;75;138;211;74;161;229;74;138","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,11,0.7857142857142857,1.9090909090909092,0.28378378378378377,638,0.04798051032183613],["QTR","0034 2 CARLOW TOWN",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","3406;3093;5882;8849;3076;6268;8904;2962;6313;9244;3309;6312;9051;3370;6519;9724;3154;5971;8980;3228;6354;9690;3487;6484","56;54;104;156;43;89;119;37;82;121;40;84;125;44;79;123;46;79;122;45;90;151;60;112","0;0;0;0;0;0;0;0;0;0;0;0;56;54;104;156;43;89;119;37;82;121;40;84","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,742,0.041569431978458776],["QTR","0033 1 K/KENNY CO",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2681;2579;5570;8322;2825;5636;8683;3258;6178;9455;2610;5261;8327;3160;5887;8690;3042;5964;8710;3102;6296;9496;3184;6469","53;60;117;167;65;127;187;51;97;137;47;101;169;56;106;168;72;125;188;59;121;184;70;129","0;0;0;0;0;0;0;0;0;0;0;0;53;60;117;167;65;127;187;51;97;137;47;101","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,635,0.04147326580330812],["QTR","0030 1 RST WATERFD",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2833;2659;5548;8257;2823;5441;8177;2794;5692;8931;2629;5389;8268;2930;5849;8778;3737;6264;9117;3368;6464;9486;3099;6253","50;35;89;136;33;80;121;46;84;128;51;96;121;46;79;130;35;71;113;35;73;101;31;52","0;0;0;0;0;0;0;0;0;0;0;0;50;35;89;136;33;80;121;46;84;128;51;96","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,641,0.040088472881138607],["QTR","0035 2 WEXFORD TWN",2,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","3583;2761;5815;8720;2687;5001;7806;2739;5747;9033;2866;5734;8751;3078;6083;9165;3254;6289;9444;2864;6142;9338;3279;6181","56;86;196;283;61;146;246;80;135;246;88;173;253;94;167;270;74;152;219;101;182;278;89;193","0;0;0;0;0;0;0;0;0;0;0;0;56;86;196;283;61;146;246;80;135;246;88;173","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,1,0.5,1,0.013513513513513514,713,0.039626875240415436],["QTR","0035 1 RST WEXFORD",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2977;2979;6071;9187;3376;6038;8773;2696;5846;8562;2769;5413;8223;2911;5628;8593;3342;6147;9355;3030;5933;8830;3236;6095","75;82;174;248;74;136;205;72;127;186;59;111;176;61;135;209;67;134;208;79;144;218;71;139","0;0;0;0;0;0;0;0;0;0;0;0;75;82;174;248;74;136;205;72;127;186;59;111","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,759,0.039075522502884985],["QTR","0035 3 ENNISCORTHY",6,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2265;2496;5358;7825;2959;5111;7348;2846;5323;8103;2373;4634;7053;2360;4813;7392;2806;5217;7490;2686;5250;7900;3117;6032","64;54;127;196;60;128;187;80;145;209;62;136;199;60;111;189;55;113;166;63;125;181;77;135","0;0;0;0;0;0;0;0;0;0;0;0;64;54;127;196;60;128;187;80;145;209;62;136","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,0.6666666666666666,1.75,0.0945945945945946,656,0.03867162456725221],["QTR","0018 1 DUBLIN 2",7,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2380;2295;4671;6858;2194;4193;7270;4517;8242;11129;2392;4834;7135;2438;4568;7299;2701;5008;7470;2824;5445;8198;2867;5374","42;26;62;91;32;61;85;28;54;78;42;72;100;24;51;76;28;53;90;22;48;77;31;63","0;0;0;0;0;0;0;0;0;0;0;0;42;26;62;91;32;61;85;28;54;78;42;72","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.2857142857142857,2,0.05405405405405406,662,0.03445313501730991],["QTR","0031 2 PORTLAOISE",6,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2225;2533;4837;7249;2683;4896;7410;2591;4969;7763;2586;5002;7560;2731;5194;7896;2713;4952;7591;2762;5412;7964;2743;5304","57;65;130;194;57;118;184;46;114;170;64;114;177;58;120;183;41;86;140;46;92;148;58;94","0;0;0;0;0;0;0;0;0;0;0;0;57;65;130;194;57;118;184;46;114;170;64;114","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,5,0.8333333333333334,1.6,0.10810810810810811,664,0.03400435953327349],["QTR","0032 4 BRAY",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2483;2440;4787;7274;2651;4913;7110;2442;5016;7660;2511;4519;7243;2493;4647;6879;2695;4801;7387;2633;5304;7750;2661;5169","35;43;96;130;33;66;119;29;62;92;36;59;97;31;71;109;42;69;116;55;101;147;42;82","0;0;0;0;0;0;0;0;0;0;0;0;35;43;96;130;33;66;119;29;62;92;36;59","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,676,0.03313886395691755],["QTR","0032 1 RST WICKLOW",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2788;2340;4925;7237;2697;4920;7315;2363;5085;7720;2580;4905;7668;2554;4689;7642;2699;5226;7681;2750;5247;7859;2695;5147","32;31;77;118;35;86;125;44;89;136;46;91;145;36;75;119;50;78;110;29;60;109;36;83","0;0;0;0;0;0;0;0;0;0;0;0;32;31;77;118;35;86;125;44;89;136;46;91","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,746,0.03299782023336325],["QTR","0035 5 GOREY",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1586;1846;3678;5709;1938;3821;5864;2131;4485;6724;2160;4265;6546;2241;4376;6756;2546;4750;7402;2466;4824;7408;2727;5017","22;31;47;59;20;46;62;27;56;75;21;51;75;27;41;63;19;40;67;33;56;89;30;56","0;0;0;0;0;0;0;0;0;0;0;0;22;31;47;59;20;46;62;27;56;75;21;51","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,697,0.0321643800487242],["QTR","0029 3 CLONMEL",9,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2415;2220;4484;6702;2160;4271;6356;2422;4790;7145;2319;4444;6633;2376;4655;6820;2397;4724;7090;2383;4901;7223;2433;4725","38;35;83;115;49;72;106;36;72;101;27;64;92;22;42;72;17;42;61;28;56;88;35;53","0;0;0;0;0;0;0;0;0;0;0;0;38;35;83;115;49;72;106;36;72;101;27;64","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,6,0.6666666666666666,1.3333333333333333,0.10810810810810811,692,0.030292345172458008],["QTR","0068 1 DUBLIN 4",5,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1975;2459;4502;6886;2465;4303;6738;2337;4598;7029;2246;4237;6540;2264;4511;7042;2312;4625;7095;2148;4803;7281;2349;4658","36;43;72;101;26;57;90;24;48;70;24;38;66;29;46;69;20;48;74;33;62;93;27;50","0;0;0;0;0;0;0;0;0;0;0;0;36;43;72;101;26;57;90;24;48;70;24;38","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,1,0.2,1,0.013513513513513514,666,0.029862802923451726],["QTR","0070 3 DUNDRUM",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1130;740;1502;6814;3188;4021;7580;2511;4744;6471;1349;2744;4067;1018;2194;4695;1437;3487;4787;2096;3308;4298;1636;3952","7;11;20;32;7;17;53;8;25;42;22;64;82;13;29;49;19;34;59;21;36;84;24;44","0;0;0;0;0;0;0;0;0;0;0;0;7;11;20;32;7;17;53;8;25;42;22;64","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,660,0.02533658161302731],["QTR","0060 1 BLACKROCK",3,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1824;1863;3824;5608;1817;3442;5304;1742;3758;5545;1717;3444;5293;1803;3606;5542;1901;3842;5673;1990;3865;5761;1937;3846","22;13;46;72;20;40;56;17;31;49;20;38;59;13;30;59;22;51;69;23;40;65;20;43","0;0;0;0;0;0;0;0;0;0;0;0;22;13;46;72;20;40;56;17;31;49;20;38","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.6666666666666666,1.5,0.04054054054054054,721,0.02465700730862931],["QTR","0030 3 DUNGARVAN",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1783;1527;3010;4329;1655;2912;4407;1734;3494;5431;1494;3274;4764;1735;3200;4731;1822;3283;4918;1591;3104;4800;2124;3792","16;17;32;47;11;28;49;13;32;49;29;40;61;19;32;43;11;21;46;10;17;25;10;21","0;0;0;0;0;0;0;0;0;0;0;0;16;17;32;47;11;28;49;13;32;49;29;40","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,730,0.024310809078086935],["QTR","0031 1 REST LAOIS",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1589;1724;3319;5035;1773;3209;4867;1726;3564;5328;1850;3845;5455;1679;3604;5271;1728;3315;5255;1922;3792;5475;1854;3589","31;27;55;92;33;63;98;33;71;101;28;67;98;31;66;96;43;82;123;31;63;95;35;71","0;0;0;0;0;0;0;0;0;0;0;0;31;27;55;92;33;63;98;33;71;101;28;67","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,688,0.02300936017438133],["QTR","0034 1 CARLOW COUNTY",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1587;1946;3621;5371;1707;3139;4835;1802;3573;5432;1635;3177;4833;1764;3510;5188;1795;3413;5117;1603;3448;5227;1881;3572","24;27;63;98;25;44;68;29;58;87;17;52;76;32;69;108;33;69;105;23;64;91;39;77","0;0;0;0;0;0;0;0;0;0;0;0;24;27;63;98;25;44;68;29;58;87;17;52","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,665,0.022900371842543916],["QTR","0032 3 ARKLOW",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1580;1601;3205;4798;1570;2905;4459;1587;3259;4841;1650;3172;4798;1702;3341;5313;1716;3387;5350;1723;3572;5448;1861;3535","31;52;96;142;42;71;108;34;61;96;44;76;117;53;110;162;44;91;156;54;114;164;44;90","0;0;0;0;0;0;0;0;0;0;0;0;31;52;96;142;42;71;108;34;61;96;44;76","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,640,0.022663161943838953],["QTR","0032 5 GREYSTONES",4,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","2275;2436;4657;6851;2476;4372;6984;2208;5006;7469;2399;3945;5544;1592;3095;4815;1678;3177;4754;1685;3413;5118;1813;3406","30;16;48;68;26;47;76;21;55;76;33;45;55;10;22;39;14;31;57;17;33;50;16;26","0;0;0;0;0;0;0;0;0;0;0;0;30;16;48;68;26;47;76;21;55;76;33;45","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,4,1,1.5,0.08108108108108109,699,0.021836132837543275],["QTR","0035 4 NEW ROSS",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1408;1308;2642;4038;1308;2530;3838;1377;2798;4153;1491;2801;4340;1488;2756;4261;1558;2842;4281;1484;2911;4524;1681;3166","19;19;35;50;17;34;50;22;35;49;20;35;52;20;42;55;22;38;61;13;30;47;18;36","0;0;0;0;0;0;0;0;0;0;0;0;19;19;35;50;17;34;50;22;35;49;20;35","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,690,0.02029747403513271],["QTR","0032 2 WICKLOW TWN",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1285;1463;2628;4014;1384;2405;3769;1452;2928;4414;1398;2760;4018;1242;2615;4050;1503;2674;4267;1373;2993;4715;1589;2941","37;31;74;119;48;87;134;49;84;135;35;88;118;41;63;91;31;50;84;23;38;55;28;46","0;0;0;0;0;0;0;0;0;0;0;0;37;31;74;119;48;87;134;49;84;135;35;88","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,647,0.018854981407872805],["QTR","0029 2 TIPP TOWN",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1259;909;2223;3258;1218;2223;3399;969;2274;3312;1025;2300;3524;1220;2449;3654;1113;2232;3473;1242;2477;3814;1298;2581","79;58;138;242;99;157;231;67;144;226;55;141;203;72;158;226;73;151;229;75;174;274;96;192","0;0;0;0;0;0;0;0;0;0;0;0;79;58;138;242;99;157;231;67;144;226;55;141","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,745,0.016546993204256955],["QTR","0031 3 PTARLINGTON",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1035;1360;2484;3722;1001;1983;3091;1183;2611;3955;1135;2220;3389;1507;2441;3704;1117;2347;3710;1263;2578;3735;1196;2371","2;4;6;9;6;13;16;4;8;9;3;3;7;0;0;0;0;2;2;2;4;9;4;5","0;0;0;0;0;0;0;0;0;0;0;0;2;4;6;9;6;13;16;4;8;9;3;3","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,626,0.01520066675214771],["QTR","0060 2 STILLORGAN",3,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","1241;1207;2207;3343;1153;2074;3372;1231;2342;3644;938;1826;2961;1116;2469;3567;1102;2157;3597;978;2294;3731;1203;2291","25;14;29;46;16;30;54;18;38;51;23;28;44;16;21;34;12;26;32;11;21;33;9;16","0;0;0;0;0;0;0;0;0;0;0;0;25;14;29;46;16;30;54;18;38;51;23;28","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,2,0.6666666666666666,1,0.02702702702702703,702,0.014687780484677521],["QTR","0070 1 REST DUB 14",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","791;988;1774;2703;883;1541;2435;824;1921;2925;948;1756;2796;885;1832;2803;1031;1963;2825;969;1902;2828;1038;1946","10;12;19;29;8;22;37;7;16;20;14;21;29;10;20;30;10;21;34;9;18;25;14;22","0;0;0;0;0;0;0;0;0;0;0;0;10;12;19;29;8;22;37;7;16;20;14;21","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,701,0.012475958456212334],["QTR","0029 4 CASHEL",null,"71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980","655;614;1328;1986;693;1292;1967;658;1283;2068;626;1304;2017;719;1406;2174;698;1340;2054;743;1402;2226;757;1468","24;9;27;42;17;33;53;11;29;45;25;37;51;14;29;45;15;27;55;15;28;41;20;38","0;0;0;0;0;0;0;0;0;0;0;0;24;9;27;42;17;33;53;11;29;45;25;37","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591",2687.33334,null,null,null,null,743,0.009411463008077959]]},"select * from (\r\nselect \r\n'Territory' as TypTerr,\r\n'QTR' as Period,\r\nFEvents.NbTotalDocSeen as TotalMedVus,\r\nFPOA.NbMedecins as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.TerritoryId,\r\nT.TerritoryName,\r\nFEvents.TotalFrequency, \r\n1 as TotalQlMarket, \r\n1 as TotalQlPres,\r\n1 as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\ncase when FPOA.NbMedecins is not null and FPOA.NbMedecins <>0 then cast(FEvents.NbTotalDocSeen as float)/cast(FPOA.NbMedecins as float) else NULL end as TotalCoverage\r\n\r\nfrom (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) FsT\r\n    INNER JOIN (SELECT DimTerritory.* FROM DimTerritory inner join VisTerritory on VisTerritory.TerritoryId=DimTerritory.TerritoryId and VisTerritory.UserLogin='admin') T on Fst.TerritoryId=T.TerritoryId  and FsT.ProductId= 346\r\n    \r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(CustomerId) as NbMedecins\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\nwhere 1=1   and ProductId= 346 \r\n  GROUP BY  POA.TerritoryId\r\n) FPOA on FPOA.TerritoryId=FST.TerritoryId\r\nleft outer join \r\n(SELECT DISTINCT\r\n  POA.TerritoryId, \r\n  count(distinct E.EventId) as NbTotal,\r\n  count(distinct E.CustomerId) as NbTotalDocSeen,\r\n  case when count(distinct E.[CustomerId])<>0 then cast(count(distinct EventId) as float)/cast(count(distinct E.[CustomerId]) as float) else NULL end as TotalFrequency\r\n  From (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) POA \r\n\t\tinner join (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) E on E.TerritoryId=POA.TerritoryId AND E.CustomerId=POA.CustomerId and E.ProductId=POA.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n  INNER JOIN DimTarget tar on  POA.TargetId=tar.TargetId and tar.TargetName='A'\r\n\twhere E.DateId between D.QTRStartDateId and D.QTREndDateId and D.DateId= 20150801  and E.ProductId= 346\r\n  GROUP BY  POA.TerritoryId\r\n) FEvents on FEvents.TerritoryId=FST.TerritoryId\r\n\r\n\r\nUNION\r\n\r\n\r\nselect \r\n'National' as TypTerr,\r\n'QTR' as Period,\r\nNULL  as TotalMedVus,\r\nNULL  as TotalMedPOA,\r\n--Fst.QTRSalesUnit as TotalSalesTerr,\r\nT.NationalId,\r\nT.NationalName,\r\n NULL TotalFrequency, \r\nNULL as TotalQlMarket, \r\nNULL as TotalQlPres,\r\nNULL as TotalQlProduct, \r\nFsT.QTRSalesUnitPY SalesUnitPY ,\r\nFsT.QTRSalesUnit SalesUnit,\r\nFsT.QTRMarketSalesUnit MarketSalesUnit,\r\nNULL TotalCoverage\r\n\r\nfrom (SELECT FactSalesNational.* FROM FactSalesNational inner join VisNational on VisNational.NationalId=FactSalesNational.NationalId and VisNational.UserLogin='admin') FsT\r\n    INNER JOIN (SELECT DimNational.* FROM DimNational inner join VisNational on VisNational.NationalId=DimNational.NationalId and VisNational.UserLogin='admin') T on Fst.NationalId=T.NationalId  and FsT.ProductId= 346\r\n) REQ order by TypTerr desc\r\n     ":{"columns":["TYPTERR","PERIOD","TOTALMEDVUS","TOTALMEDPOA","TERRITORYID","TERRITORYNAME","TOTALFREQUENCY","TOTALQLMARKET","TOTALQLPRES","TOTALQLPRODUCT","SALESUNITPY","SALESUNIT","MARKETSALESUNIT","TOTALCOVERAGE"],"data":[["Territory","QTR",49,72,7886,"H3",1.489795918367347,1,1,1,"0;0;0;0;0;0;0;0;0;0;0;0;1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692","1570;1347;2850;4318;1596;3021;4519;1385;2810;4179;1453;2692;4056;1293;2515;3876;1225;2413;3723;1270;2516;3875;1344;2591","71307;70787;140869;215546;75210;138450;212303;76780;154926;233172;72099;140206;212393;73298;143281;219610;79667;148687;222778;76929;153639;229412;80778;155980",0.6805555555555556],["National","QTR",null,null,7852,"HOSPITAL Team",null,null,null,null,"0;0;0;0;0;0;0;0;0;0;0;0;5943;5671;11796;17427;6295;11669;18882;5522;11169;16555;5770;10800","5943;5671;11796;17427;6295;11669;18882;5522;11169;16555;5770;10800;16418;5476;10756;16576;5412;10694;16181;5363;10417;15755;5505;10546","323015;308364;621747;941898;319136;600101;920158;323095;666987;1027212;315477;621336;950313;327926;639929;984483;350700;658903;996853;339261;680667;1022378;360475;687962",null]]},"SELECT  \r\nMonthLabel.value MonthChar--  D.MonthChar\r\n, MonthCode.value DateID--  D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,fs.MarketSalesUnit \r\n   --  ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n where 1=1    and P.ProductId= 355\r\n Group by \r\n\t MonthLabel.value --  D.DATEID\r\n\t ,MonthCode.value -- D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n     ,Fs.MarketSalesUnit\r\n    ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n\r\n   ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,355,"ACERYCAL","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","AAAAA"]]},"SELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 355 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 355\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 355 then 'AAAAA' ELSE P.ProductName end  ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,247,"OMESAR PLUS","OMESAR PLUS","1350;1422;1373;1402;1475;1238;1388;1387;1406;1397;1376;1361;1374;1422;1344;1500;1406;1272;1424;1348;1356;1393;1530;1451","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,276,"ALL OTHER C9B","ALL OTHER C9B","4961;4980;5071;4971;5076;4606;5078;5068;5367;4895;5143;4861;5173;5338;4989;5477;5253;4877;6048;5394;5251;5608;5816;5439","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,290,"TOTAL PERINDOPRIL","TOTAL PERINDOPRIL","1124;1040;1107;1020;1134;1124;1056;1202;1084;1017;1234;971;1137;1179;1162;1225;1298;1084;1209;1277;1177;1031;1173;1043","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,291,"CO DIOVAN","CO DIOVAN","1951;1896;1811;1866;1715;1626;1653;1607;1580;1520;1496;1411;1274;1367;1175;959;688;621;668;577;558;553;548;525","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,298,"EXFORGE HTC","EXFORGE HTC","612;668;620;628;746;623;638;686;645;690;712;674;746;749;605;744;660;628;752;771;734;704;816;680","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,302,"MICARDIS PLUS","MICARDIS PLUS","4899;4647;5381;5093;4608;4067;4342;4246;3962;3587;3513;3247;2918;2931;2513;2642;2625;1964;1949;1777;1750;1601;1715;1593","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,303,"AMLODIPINE","AMLODIPINE","23042;25918;22616;21494;27337;20311;22979;23682;23896;22302;25432;23182;25358;22174;21224;23347;24218;20626;24421;22889;23393;23596;24568;23805","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,304,"COVERSYL ARGI PLUS","COVERSYL ARGI PLUS","3688;3443;3430;3469;3605;3026;3386;3424;3352;3205;3304;2945;3081;2926;2674;2831;2567;2455;2715;2558;2580;2695;2674;2577","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,319,"COZAAR COMP","COZAAR COMP","1389;1353;1498;1236;1173;1030;1097;949;1075;960;884;890;834;850;776;802;750;649;835;725;770;789;780;682","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,333,"RASILEZ","RASILEZ","473;504;507;483;535;425;515;480;469;448;469;431;452;453;443;449;414;373;405;405;406;395;435;431","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,335,"KONVERGE","KONVERGE","1719;1825;1787;1832;1939;1669;1868;1856;2013;1889;1988;1887;1983;1998;1924;2267;1995;1894;2119;2141;2153;2136;2211;2156","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,337,"KONVERGE PLUS","KONVERGE PLUS","537;590;593;637;626;639;731;687;779;759;742;706;831;803;860;902;858;806;930;898;912;965;1046;984","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,353,"EXFORGE","EXFORGE","1832;1892;1907;2007;1929;1711;1907;1999;2052;1953;2009;1925;1916;2063;1850;2071;1934;1772;2149;2026;2032;1991;2234;1905","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,355,"ACERYCAL","AAAAA","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,364,"COVERDINE","COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"]]},"SELECT  \r\nMonthLabel.value MonthChar--  D.MonthChar\r\n, MonthCode.value DateID--  D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,fs.MarketSalesUnit \r\n   --  ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n where 1=1    and P.ProductId= 364\r\n Group by \r\n\t MonthLabel.value --  D.DATEID\r\n\t ,MonthCode.value -- D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n     ,Fs.MarketSalesUnit\r\n    ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n\r\n   ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626","AAAAA"]]},"SELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 364 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 364\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 364 then 'AAAAA' ELSE P.ProductName end  ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,247,"OMESAR PLUS","OMESAR PLUS","1350;1422;1373;1402;1475;1238;1388;1387;1406;1397;1376;1361;1374;1422;1344;1500;1406;1272;1424;1348;1356;1393;1530;1451","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,276,"ALL OTHER C9B","ALL OTHER C9B","4961;4980;5071;4971;5076;4606;5078;5068;5367;4895;5143;4861;5173;5338;4989;5477;5253;4877;6048;5394;5251;5608;5816;5439","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,290,"TOTAL PERINDOPRIL","TOTAL PERINDOPRIL","1124;1040;1107;1020;1134;1124;1056;1202;1084;1017;1234;971;1137;1179;1162;1225;1298;1084;1209;1277;1177;1031;1173;1043","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,291,"CO DIOVAN","CO DIOVAN","1951;1896;1811;1866;1715;1626;1653;1607;1580;1520;1496;1411;1274;1367;1175;959;688;621;668;577;558;553;548;525","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,298,"EXFORGE HTC","EXFORGE HTC","612;668;620;628;746;623;638;686;645;690;712;674;746;749;605;744;660;628;752;771;734;704;816;680","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,302,"MICARDIS PLUS","MICARDIS PLUS","4899;4647;5381;5093;4608;4067;4342;4246;3962;3587;3513;3247;2918;2931;2513;2642;2625;1964;1949;1777;1750;1601;1715;1593","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,303,"AMLODIPINE","AMLODIPINE","23042;25918;22616;21494;27337;20311;22979;23682;23896;22302;25432;23182;25358;22174;21224;23347;24218;20626;24421;22889;23393;23596;24568;23805","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,304,"COVERSYL ARGI PLUS","COVERSYL ARGI PLUS","3688;3443;3430;3469;3605;3026;3386;3424;3352;3205;3304;2945;3081;2926;2674;2831;2567;2455;2715;2558;2580;2695;2674;2577","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,319,"COZAAR COMP","COZAAR COMP","1389;1353;1498;1236;1173;1030;1097;949;1075;960;884;890;834;850;776;802;750;649;835;725;770;789;780;682","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,333,"RASILEZ","RASILEZ","473;504;507;483;535;425;515;480;469;448;469;431;452;453;443;449;414;373;405;405;406;395;435;431","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,335,"KONVERGE","KONVERGE","1719;1825;1787;1832;1939;1669;1868;1856;2013;1889;1988;1887;1983;1998;1924;2267;1995;1894;2119;2141;2153;2136;2211;2156","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,337,"KONVERGE PLUS","KONVERGE PLUS","537;590;593;637;626;639;731;687;779;759;742;706;831;803;860;902;858;806;930;898;912;965;1046;984","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,353,"EXFORGE","EXFORGE","1832;1892;1907;2007;1929;1711;1907;1999;2052;1953;2009;1925;1916;2063;1850;2071;1934;1772;2149;2026;2032;1991;2234;1905","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,355,"ACERYCAL","ACERYCAL","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,364,"COVERDINE","AAAAA","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"]]},"SELECT  \r\nMonthLabel.value MonthChar--  D.MonthChar\r\n, MonthCode.value DateID--  D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,fs.MarketSalesUnit \r\n   --  ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n where 1=1    and P.ProductId= 265\r\n Group by \r\n\t MonthLabel.value --  D.DATEID\r\n\t ,MonthCode.value -- D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n     ,Fs.MarketSalesUnit\r\n    ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n\r\n   ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,265,"PROCORALAN","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573","AAAAA"]]},"SELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 265 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 265\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 265 then 'AAAAA' ELSE P.ProductName end  ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,260,"VASTAREL","VASTAREL","189;159;174;167;142;145;161;148;151;132;133;164;136;137;117;156;128;105;103;130;89;135;122;108","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,265,"PROCORALAN","AAAAA","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,326,"RANEXA","RANEXA","480;517;507;543;541;521;504;579;608;581;603;593;619;660;633;721;675;615;698;700;704;743;858;887","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,350,"IKOREL","IKOREL","521;513;486;507;524;475;500;476;467;452;472;438;451;491;425;453;471;388;441;440;425;473;439;397","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,351,"INSPRA","INSPRA","635;647;640;679;676;591;675;612;616;751;728;657;719;1018;655;649;618;533;663;688;565;696;533;466","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"]]},"SELECT  \r\nMonthLabel.value MonthChar--  D.MonthChar\r\n, MonthCode.value DateID--  D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,fs.MarketSalesUnit \r\n   --  ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n     ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n where 1=1    and P.ProductId= 346\r\n Group by \r\n\t MonthLabel.value --  D.DATEID\r\n\t ,MonthCode.value -- D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n     ,Fs.MarketSalesUnit\r\n    ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end  \r\n\r\n   ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,346,"VALDOXAN","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202","AAAAA"]]},"SELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 346 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 346\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 346 then 'AAAAA' ELSE P.ProductName end  ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,243,"TOTAL VENLAFAXINE","TOTAL VENLAFAXINE","15670;13716;13905;13623;14822;12902;14290;14468;15522;13993;14786;13284;14798;14287;14503;15137;15602;14108;14273;15150;16310;14248;15819;14447","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,249,"TOTAL FLUOXETINE","TOTAL FLUOXETINE","6440;6671;6831;6823;7007;6146;6683;6662;7370;6818;7594;6681;7006;7006;6707;7703;7492;6903;7787;7416;7816;7869;7885;7310","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,267,"CYMBALTA","CYMBALTA","4378;4873;4650;4371;5049;4172;4831;4639;4754;4686;4495;4367;4613;4835;4454;5044;4741;4322;4758;4682;4251;3734;3287;2857","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,306,"TOTAL PAROXATINE","TOTAL PAROXATINE","3179;2976;2956;3026;3124;2618;2812;2925;3045;2723;2983;2754;2902;3004;2594;2954;2840;2571;2752;2854;2773;2976;2968;2644","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,316,"TOTAL SERTRALINE","TOTAL SERTRALINE","6110;6500;6677;6662;7331;6145;6869;7460;7278;6969;7416;7010;7480;7820;7125;7972;9457;8199;7073;9178;7585;7778;9026;8721","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,346,"VALDOXAN","AAAAA","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"]]},"SELECT\r\n BrickId AS value\r\n,BrickName AS caption\r\nFROM\r\n(SELECT\r\n B.BrickId\r\n,B.BrickName\r\n,FSB.MATMarketSalesUnitLastMonth\r\nFROM\r\n           (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin')       B\r\nINNER JOIN (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FSB ON B.BrickId=FSB.BrickId\r\n--INNER JOIN DimDate        D   ON D.DateId =FSB.DateId\r\nWHERE\r\n   -- D.MATStartDateId=(SELECT MAX(MATStartDateId) FROM DimDate)\r\n FSB.ProductId='355'\r\n) T\r\nORDER BY\r\nMATMarketSalesUnitLastMonth DESC ":{"columns":["VALUE","CAPTION"],"data":[[682,"0061 1 DUN LAOIRE"],[709,"0030 2 WATERFD CTY"],[635,"0033 1 K/KENNY CO"],[691,"0029 1 REST S TIPP"],[641,"0030 1 RST WATERFD"],[759,"0035 1 RST WEXFORD"],[746,"0032 1 RST WICKLOW"],[638,"0033 2 K/KENNY TWN"],[665,"0034 1 CARLOW COUNTY"],[713,"0035 2 WEXFORD TWN"],[676,"0032 4 BRAY"],[656,"0035 3 ENNISCORTHY"],[664,"0031 2 PORTLAOISE"],[742,"0034 2 CARLOW TOWN"],[692,"0029 3 CLONMEL"],[721,"0060 1 BLACKROCK"],[688,"0031 1 REST LAOIS"],[666,"0068 1 DUBLIN 4"],[697,"0035 5 GOREY"],[662,"0018 1 DUBLIN 2"],[640,"0032 3 ARKLOW"],[699,"0032 5 GREYSTONES"],[690,"0035 4 NEW ROSS"],[730,"0030 3 DUNGARVAN"],[647,"0032 2 WICKLOW TWN"],[702,"0060 2 STILLORGAN"],[660,"0070 3 DUNDRUM"],[626,"0031 3 PTARLINGTON"],[745,"0029 2 TIPP TOWN"],[701,"0070 1 REST DUB 14"],[743,"0029 4 CASHEL"]]},"SELECT\r\n T.*\r\n,B.BrickName\r\nFROM (\r\nSELECT  \r\n     MonthLabel.Value MonthChar ,\r\n     MonthCode.value DateId\r\n      ,Fs.[BrickId]  \r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\nFROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\nINNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\nwhere 1=1  and P.ProductId= 355 and BrickId in (682)\r\n Group by [BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n,MonthLabel.value, MonthCode.value\r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end \r\n) AS T\r\nLEFT OUTER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') AS B on B.BrickId=T.BrickId ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","SALESUNIT","SRT","BRICKNAME"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,355,"ACERYCAL","120;131;139;157;154;136;154;190;128;181;155;164;159;139;159;150;153;157;172;174;171;176;187;153","AAAAA","0061 1 DUN LAOIRE"]]},"SELECT  \r\n      MonthLabel.value MonthChar --   D.MonthChar\r\n    -- ,D.DATEID\r\n      ,MonthCode.value DateId\t\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] as MarketUnitSales\r\n     ,case when P.ProductId = 355 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n INNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n INNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\n--  INNER JOIN DImDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and brickid in (682)  and HP.ProductId= 355\r\n\r\n Group by MonthLabel.value ,-- D.monthChar,\r\n      MonthCode.value,\r\n      Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.SalesUnit\r\n      ,case when P.ProductId = 355 then 'AAAAA' ELSE P.ProductName end \r\n ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","MARKETUNITSALES","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,247,"OMESAR PLUS","191;219;164;180;207;148;189;198;184;186;167;192;170;174;177;184;203;137;193;168;189;175;219;175","OMESAR PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,276,"ALL OTHER C9B","284;324;335;288;317;287;295;303;309;302;301;326;326;326;313;355;322;291;389;342;320;362;353;351","ALL OTHER C9B"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,290,"TOTAL PERINDOPRIL","140;233;197;282;217;187;147;252;189;148;240;126;187;283;146;183;220;195;163;217;211;182;169;168","TOTAL PERINDOPRIL"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,291,"CO DIOVAN","126;115;128;140;108;133;149;149;126;116;86;88;87;92;85;93;52;47;46;70;34;54;37;43","CO DIOVAN"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,298,"EXFORGE HTC","45;57;52;44;56;53;42;62;42;41;60;47;42;56;38;52;44;32;39;49;48;47;39;49","EXFORGE HTC"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,302,"MICARDIS PLUS","495;509;485;464;472;406;422;493;406;398;372;305;279;272;232;294;211;159;203;163;180;133;153;162","MICARDIS PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,303,"AMLODIPINE","2091;1865;2003;2104;2386;1795;1881;2200;2085;1888;2148;1993;1960;2239;1929;2245;2058;1798;2100;2310;2137;2025;2236;1923","AMLODIPINE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,304,"COVERSYL ARGI PLUS","412;423;455;419;419;400;407;421;406;416;409;383;361;354;340;377;318;286;347;314;349;369;358;300","COVERSYL ARGI PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,319,"COZAAR COMP","248;239;201;220;202;192;205;161;196;151;153;179;154;118;142;129;139;83;146;121;130;127;114;111","COZAAR COMP"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,333,"RASILEZ","31;35;24;21;30;21;30;36;20;18;25;15;16;26;27;22;22;22;23;20;28;16;21;18","RASILEZ"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,335,"KONVERGE","152;185;163;164;163;138;154;159;181;156;176;146;167;185;182;197;178;156;207;179;201;200;197;198","KONVERGE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,337,"KONVERGE PLUS","59;45;43;46;39;40;60;54;77;69;62;54;91;60;86;77;78;67;94;69;74;79;88;76","KONVERGE PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,353,"EXFORGE","133;161;149;151;170;140;177;154;179;143;196;164;146;162;124;152;154;128;184;154;167;176;209;157","EXFORGE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,355,"ACERYCAL","120;131;139;157;154;136;154;190;128;181;155;164;159;139;159;150;153;157;172;174;171;176;187;153","AAAAA"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;8;19;19;19;19;29;18;19;28","COVERDINE"]]},"SELECT  \r\n       Fs.[BrickId]\r\n      ,B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,Fs.MarketSalesUnit\r\n     --,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      --,FS.dateId\r\n,MonthCode.value dateId\r\n     -- ,Fs.MATMarketSalesUnit\r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n  INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B on B.brickId=Fs.brickId\r\n\r\n  WHERE 1=1  and P.ProductId= 355   Group by  Fs.[BrickId],B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.MarketSalesUnit\r\n    --  ,Fs.DateId\r\n,MonthCode.value \r\n      ,Fs.MATMarketSalesUnitLastMonth\r\n ORDER BY Fs.MATMarketSalesUnitLastMonth DESC ":{"columns":["BRICKID","BRICKNAME","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","DATEID"],"data":[[682,"0061 1 DUN LAOIRE",355,"ACERYCAL","120;131;139;157;154;136;154;190;128;181;155;164;159;139;159;150;153;157;172;174;171;176;187;153","4527;4541;4538;4680;4940;4076;4312;4832;4528;4213;4550;4182;4145;4491;3986;4518;4171;3577;4325;4369;4268;4139;4399;3912","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[709,"0030 2 WATERFD CTY",355,"ACERYCAL","1100;216;172;167;1209;329;286;360;345;342;361;122;328;110;144;116;107;126;94;107;112;105;124;107","5571;4036;4072;3310;6027;3706;4134;4628;4255;3865;4530;3710;4422;3380;3601;3374;4493;3335;3922;3468;3871;3563;3958;3712","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[635,"0033 1 K/KENNY CO",355,"ACERYCAL","35;42;42;46;34;46;45;36;61;45;44;50;60;50;52;70;59;44;51;49;75;42;65;48","2499;2081;2232;2116;2861;1773;2492;2332;2334;2306;2777;2405;2576;2144;2130;2188;2602;2089;2221;2414;2195;2503;2456;2424","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[691,"0029 1 REST S TIPP",355,"ACERYCAL","119;141;120;126;131;125;121;129;111;121;128;119;122;124;129;138;151;106;138;139;117;134;127;127","2285;3634;2312;2224;2500;2008;2227;2348;2153;2203;2381;2052;2242;2276;2150;2169;2287;1835;2433;2054;2270;2155;2399;2058","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[641,"0030 1 RST WATERFD",355,"ACERYCAL","45;63;50;58;64;56;72;59;65;70;80;51;61;82;62;65;83;63;70;61;79;60;93;67","2107;2089;2095;2105;2502;1856;1898;1989;2272;2250;2004;1809;2491;1861;1921;1938;2105;1595;2335;1752;1754;2055;1983;2003","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[759,"0035 1 RST WEXFORD",355,"ACERYCAL","95;121;112;124;107;122;113;120;128;116;135;125;144;142;121;137;132;128;130;128;125;134;141;125","2526;2245;2310;2580;2558;2101;2112;2021;2180;1943;2118;2064;2358;2013;1907;2184;1836;1688;2142;1868;1960;1907;2062;1818","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[746,"0032 1 RST WICKLOW",355,"ACERYCAL","95;149;123;174;144;134;149;166;151;169;134;150;175;133;148;144;162;130;152;167;138;165;149;142","1888;3898;1850;1634;1869;1745;1701;2009;1778;1826;1989;1765;1895;1986;1824;1860;1927;1832;2160;1848;1932;2199;2084;1765","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[638,"0033 2 K/KENNY TWN",355,"ACERYCAL","36;42;49;54;47;47;40;45;30;60;54;45;50;56;52;48;55;73;62;72;75;79;69;60","1954;1783;2064;1940;2584;1709;2306;1915;2200;1770;2216;1892;1875;1878;1933;1907;1717;1628;1894;1795;1815;1790;2055;1717","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[665,"0034 1 CARLOW COUNTY",355,"ACERYCAL","47;66;70;63;55;51;57;59;71;51;55;59;109;65;64;66;59;77;69;49;60;55;52;54","1674;1810;1894;1666;1841;1353;1926;1641;1750;1643;1782;1936;1754;1739;1517;1874;1683;1671;1863;1539;1710;1816;1758;1806","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[713,"0035 2 WEXFORD TWN",355,"ACERYCAL","143;116;126;128;126;111;129;129;130;130;145;138;132;166;133;151;150;143;151;157;164;136;146;148","1928;2079;1992;1988;1933;1639;1931;1857;1985;1685;1776;1708;1734;1862;1597;1778;1739;1548;1756;1674;1724;1581;1715;1683","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[676,"0032 4 BRAY",355,"ACERYCAL","69;58;72;89;80;64;80;91;70;83;75;83;96;94;80;86;120;92;87;98;89;95;79;105","1617;1573;1951;1725;1856;1806;1751;1736;1855;1773;1709;1367;1678;1561;1550;1588;1610;1453;1610;1485;1500;1632;1591;1517","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[656,"0035 3 ENNISCORTHY",355,"ACERYCAL","97;99;100;103;124;87;118;120;152;136;117;129;161;136;137;150;127;149;126;144;142;155;148;131","1416;1546;1605;1526;1745;1540;1570;1613;1739;1429;1704;1792;1523;1540;1371;1485;1529;1466;1422;1533;1521;1492;1607;1672","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[664,"0031 2 PORTLAOISE",355,"ACERYCAL","23;23;26;25;28;25;32;30;37;28;31;28;30;31;30;31;31;37;30;30;25;26;27;26","1528;1512;1465;1333;1696;1240;1465;1493;1391;1557;1502;1412;1780;1520;1341;1482;1457;1323;1532;1475;1429;1349;1444;1403","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[742,"0034 2 CARLOW TOWN",355,"ACERYCAL","23;22;15;26;26;29;22;24;27;29;23;21;30;31;56;24;31;28;30;40;36;25;36;34","1822;1658;1948;1608;1724;1826;1579;1479;1732;1525;1557;1710;1479;1626;1580;1533;1272;1369;1349;1468;1396;1395;1507;1361","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[692,"0029 3 CLONMEL",355,"ACERYCAL","81;77;85;75;79;78;83;80;78;80;84;79;90;92;77;94;111;67;85;84;91;82;97;66","1540;1556;1633;1509;1709;1511;1484;1472;1589;1520;1773;1449;1400;1622;1432;1538;1412;1273;1520;1379;1414;1457;1497;1298","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[721,"0060 1 BLACKROCK",355,"ACERYCAL","72;88;76;96;83;76;87;80;78;74;67;82;89;80;85;84;85;86;77;75;81;97;88;73","1479;1661;1591;1628;1618;1408;1669;1388;1602;1390;1577;1395;1545;1450;1410;1521;1373;1208;1370;1331;1415;1305;1352;1286","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[688,"0031 1 REST LAOIS",355,"ACERYCAL","45;41;47;45;40;46;54;48;43;48;39;56;47;49;44;47;55;48;49;49;47;41;59;52","1333;1459;1386;1368;1477;1147;1487;1484;1217;1439;1357;1399;1244;1348;1218;1362;1432;1001;1346;1347;1300;1351;1395;1451","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[666,"0068 1 DUBLIN 4",355,"ACERYCAL","95;74;75;104;87;72;86;79;80;81;82;73;99;86;81;94;62;75;57;73;67;84;73;71","1355;1409;1377;1444;1391;1283;1262;1371;1414;1359;1499;1083;1413;1303;1213;1406;1249;1205;1229;1264;1187;1280;1244;1185","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[697,"0035 5 GOREY",355,"ACERYCAL","22;19;34;37;27;21;16;29;30;23;31;32;42;20;23;24;25;30;25;35;29;41;38;42","1017;1159;1190;1113;1091;1304;1151;1272;1268;1100;1307;1449;1299;1183;1024;1156;1291;1109;1305;1226;1214;1273;1383;1128","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[662,"0018 1 DUBLIN 2",355,"ACERYCAL","54;50;52;55;46;42;47;51;35;54;50;59;49;58;60;73;54;61;57;58;56;61;68;60","1045;1147;972;1122;982;973;957;989;1114;1036;945;967;1109;969;825;1131;1437;1075;1076;1039;995;988;1158;946","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[640,"0032 3 ARKLOW",355,"ACERYCAL","61;53;49;63;57;43;46;53;54;48;61;48;44;66;63;77;57;57;68;70;66;79;68;77","971;1041;992;1039;979;939;1026;1041;1057;961;1064;1014;1016;1067;989;1158;985;960;1113;1127;1065;1018;1128;1069","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[699,"0032 5 GREYSTONES",355,"ACERYCAL","37;28;44;47;42;52;36;46;63;35;50;39;39;31;36;55;51;38;70;48;50;52;52;60","1216;1312;1193;1327;1246;1095;1322;1193;1300;1244;1244;985;1038;1025;944;1104;986;942;1090;1060;1030;1044;1093;1114","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[690,"0035 4 NEW ROSS",355,"ACERYCAL","41;48;41;37;38;38;32;42;39;43;44;42;45;52;40;39;45;44;43;46;58;57;58;72","1071;1236;1213;1255;1341;921;1110;1293;1129;1154;1208;1017;1326;1040;1003;1152;1090;868;1134;923;1050;964;899;1015","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[730,"0030 3 DUNGARVAN",355,"ACERYCAL","24;24;24;30;26;18;30;26;20;30;23;31;24;24;19;31;25;24;25;21;29;24;31;18","891;967;946;888;834;719;811;1081;719;784;752;1102;1005;878;882;897;745;809;816;799;807;893;862;853","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[647,"0032 2 WICKLOW TWN",355,"ACERYCAL","25;30;29;27;30;37;41;49;54;45;60;54;54;52;40;33;41;46;40;36;44;45;44;42","908;845;889;688;1099;672;764;823;843;881;843;767;823;711;835;845;877;853;909;827;891;891;896;829","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[702,"0060 2 STILLORGAN",355,"ACERYCAL","25;32;18;33;41;26;50;17;26;36;27;28;26;35;27;33;32;37;29;41;43;32;36;47","857;878;840;1019;1058;693;950;844;904;825;896;764;903;812;778;881;697;710;866;790;877;841;887;693","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[660,"0070 3 DUNDRUM",355,"ACERYCAL","26;22;33;21;37;15;29;27;25;24;22;26;32;33;22;48;104;74;118;72;92;95;111;70","642;632;628;692;888;796;882;970;890;887;1121;922;785;803;647;943;703;587;661;594;637;685;840;1660","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[626,"0031 3 PTARLINGTON",355,"ACERYCAL","20;14;15;16;20;9;11;13;12;8;16;16;14;16;15;18;12;12;23;13;19;14;11;15","738;643;763;859;786;679;865;650;976;685;681;694;912;750;487;841;722;763;867;971;567;657;688;646","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[745,"0029 2 TIPP TOWN",355,"ACERYCAL","40;36;36;37;37;29;37;40;37;31;41;44;34;32;37;53;52;30;43;36;45;39;44;35","640;730;693;755;745;543;659;697;696;638;670;742;680;677;600;707;618;595;697;673;682;699;700;634","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[701,"0070 1 REST DUB 14",355,"ACERYCAL","27;30;35;31;38;38;40;30;43;29;41;29;35;31;41;23;38;26;24;33;34;28;30;26","718;607;656;725;678;709;650;701;676;558;665;639;687;524;580;577;607;543;630;633;648;578;595;578","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[743,"0029 4 CASHEL",355,"ACERYCAL","16;8;15;14;8;12;15;16;23;31;31;24;23;20;24;23;34;18;29;19;24;19;22;23","572;374;335;380;405;339;343;395;380;454;411;345;383;377;387;405;389;337;378;400;391;371;447;390","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"]]},"SELECT\r\n BrickId AS value\r\n,BrickName AS caption\r\nFROM\r\n(SELECT\r\n B.BrickId\r\n,B.BrickName\r\n,FSB.MATMarketSalesUnitLastMonth\r\nFROM\r\n           (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin')       B\r\nINNER JOIN (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FSB ON B.BrickId=FSB.BrickId\r\n--INNER JOIN DimDate        D   ON D.DateId =FSB.DateId\r\nWHERE\r\n   -- D.MATStartDateId=(SELECT MAX(MATStartDateId) FROM DimDate)\r\n FSB.ProductId='364'\r\n) T\r\nORDER BY\r\nMATMarketSalesUnitLastMonth DESC ":{"columns":["VALUE","CAPTION"],"data":[[682,"0061 1 DUN LAOIRE"],[709,"0030 2 WATERFD CTY"],[635,"0033 1 K/KENNY CO"],[691,"0029 1 REST S TIPP"],[641,"0030 1 RST WATERFD"],[759,"0035 1 RST WEXFORD"],[746,"0032 1 RST WICKLOW"],[638,"0033 2 K/KENNY TWN"],[665,"0034 1 CARLOW COUNTY"],[713,"0035 2 WEXFORD TWN"],[676,"0032 4 BRAY"],[656,"0035 3 ENNISCORTHY"],[664,"0031 2 PORTLAOISE"],[742,"0034 2 CARLOW TOWN"],[692,"0029 3 CLONMEL"],[721,"0060 1 BLACKROCK"],[688,"0031 1 REST LAOIS"],[666,"0068 1 DUBLIN 4"],[697,"0035 5 GOREY"],[662,"0018 1 DUBLIN 2"],[640,"0032 3 ARKLOW"],[699,"0032 5 GREYSTONES"],[690,"0035 4 NEW ROSS"],[730,"0030 3 DUNGARVAN"],[647,"0032 2 WICKLOW TWN"],[702,"0060 2 STILLORGAN"],[660,"0070 3 DUNDRUM"],[626,"0031 3 PTARLINGTON"],[745,"0029 2 TIPP TOWN"],[701,"0070 1 REST DUB 14"],[743,"0029 4 CASHEL"]]},"SELECT\r\n T.*\r\n,B.BrickName\r\nFROM (\r\nSELECT  \r\n     MonthLabel.Value MonthChar ,\r\n     MonthCode.value DateId\r\n      ,Fs.[BrickId]  \r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\nFROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\nINNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\nwhere 1=1  and P.ProductId= 364 and BrickId in (682)\r\n Group by [BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n,MonthLabel.value, MonthCode.value\r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end \r\n) AS T\r\nLEFT OUTER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') AS B on B.BrickId=T.BrickId ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","SALESUNIT","SRT","BRICKNAME"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;8;19;19;19;19;29;18;19;28","AAAAA","0061 1 DUN LAOIRE"]]},"SELECT  \r\n      MonthLabel.value MonthChar --   D.MonthChar\r\n    -- ,D.DATEID\r\n      ,MonthCode.value DateId\t\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] as MarketUnitSales\r\n     ,case when P.ProductId = 364 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n INNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n INNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\n--  INNER JOIN DImDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and brickid in (682)  and HP.ProductId= 364\r\n\r\n Group by MonthLabel.value ,-- D.monthChar,\r\n      MonthCode.value,\r\n      Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.SalesUnit\r\n      ,case when P.ProductId = 364 then 'AAAAA' ELSE P.ProductName end \r\n ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","MARKETUNITSALES","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,247,"OMESAR PLUS","191;219;164;180;207;148;189;198;184;186;167;192;170;174;177;184;203;137;193;168;189;175;219;175","OMESAR PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,276,"ALL OTHER C9B","284;324;335;288;317;287;295;303;309;302;301;326;326;326;313;355;322;291;389;342;320;362;353;351","ALL OTHER C9B"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,290,"TOTAL PERINDOPRIL","140;233;197;282;217;187;147;252;189;148;240;126;187;283;146;183;220;195;163;217;211;182;169;168","TOTAL PERINDOPRIL"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,291,"CO DIOVAN","126;115;128;140;108;133;149;149;126;116;86;88;87;92;85;93;52;47;46;70;34;54;37;43","CO DIOVAN"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,298,"EXFORGE HTC","45;57;52;44;56;53;42;62;42;41;60;47;42;56;38;52;44;32;39;49;48;47;39;49","EXFORGE HTC"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,302,"MICARDIS PLUS","495;509;485;464;472;406;422;493;406;398;372;305;279;272;232;294;211;159;203;163;180;133;153;162","MICARDIS PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,303,"AMLODIPINE","2091;1865;2003;2104;2386;1795;1881;2200;2085;1888;2148;1993;1960;2239;1929;2245;2058;1798;2100;2310;2137;2025;2236;1923","AMLODIPINE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,304,"COVERSYL ARGI PLUS","412;423;455;419;419;400;407;421;406;416;409;383;361;354;340;377;318;286;347;314;349;369;358;300","COVERSYL ARGI PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,319,"COZAAR COMP","248;239;201;220;202;192;205;161;196;151;153;179;154;118;142;129;139;83;146;121;130;127;114;111","COZAAR COMP"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,333,"RASILEZ","31;35;24;21;30;21;30;36;20;18;25;15;16;26;27;22;22;22;23;20;28;16;21;18","RASILEZ"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,335,"KONVERGE","152;185;163;164;163;138;154;159;181;156;176;146;167;185;182;197;178;156;207;179;201;200;197;198","KONVERGE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,337,"KONVERGE PLUS","59;45;43;46;39;40;60;54;77;69;62;54;91;60;86;77;78;67;94;69;74;79;88;76","KONVERGE PLUS"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,353,"EXFORGE","133;161;149;151;170;140;177;154;179;143;196;164;146;162;124;152;154;128;184;154;167;176;209;157","EXFORGE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,355,"ACERYCAL","120;131;139;157;154;136;154;190;128;181;155;164;159;139;159;150;153;157;172;174;171;176;187;153","ACERYCAL"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;8;19;19;19;19;29;18;19;28","AAAAA"]]},"SELECT  \r\n       Fs.[BrickId]\r\n      ,B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,Fs.MarketSalesUnit\r\n     --,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      --,FS.dateId\r\n,MonthCode.value dateId\r\n     -- ,Fs.MATMarketSalesUnit\r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n  INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B on B.brickId=Fs.brickId\r\n\r\n  WHERE 1=1  and P.ProductId= 364   Group by  Fs.[BrickId],B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.MarketSalesUnit\r\n    --  ,Fs.DateId\r\n,MonthCode.value \r\n      ,Fs.MATMarketSalesUnitLastMonth\r\n ORDER BY Fs.MATMarketSalesUnitLastMonth DESC ":{"columns":["BRICKID","BRICKNAME","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","DATEID"],"data":[[682,"0061 1 DUN LAOIRE",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;5;6;8;19;19;19;19;29;18;19;28","4527;4541;4538;4680;4940;4076;4312;4832;4528;4213;4550;4182;4145;4491;3986;4518;4171;3577;4325;4369;4268;4139;4399;3912","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[709,"0030 2 WATERFD CTY",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;0;2;5;9;3;14;13;7;15","5571;4036;4072;3310;6027;3706;4134;4628;4255;3865;4530;3710;4422;3380;3601;3374;4493;3335;3922;3468;3871;3563;3958;3712","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[635,"0033 1 K/KENNY CO",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;4;3;3;1;2;6;6;12;13;16;19","2499;2081;2232;2116;2861;1773;2492;2332;2334;2306;2777;2405;2576;2144;2130;2188;2602;2089;2221;2414;2195;2503;2456;2424","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[691,"0029 1 REST S TIPP",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;3;1;7;4;2;3","2285;3634;2312;2224;2500;2008;2227;2348;2153;2203;2381;2052;2242;2276;2150;2169;2287;1835;2433;2054;2270;2155;2399;2058","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[641,"0030 1 RST WATERFD",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;2;1;2;3","2107;2089;2095;2105;2502;1856;1898;1989;2272;2250;2004;1809;2491;1861;1921;1938;2105;1595;2335;1752;1754;2055;1983;2003","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[759,"0035 1 RST WEXFORD",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;3;3;12;9;13;12;9;11;11","2526;2245;2310;2580;2558;2101;2112;2021;2180;1943;2118;2064;2358;2013;1907;2184;1836;1688;2142;1868;1960;1907;2062;1818","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[746,"0032 1 RST WICKLOW",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;2;4;1;6;2;11;4;4;6;14;5","1888;3898;1850;1634;1869;1745;1701;2009;1778;1826;1989;1765;1895;1986;1824;1860;1927;1832;2160;1848;1932;2199;2084;1765","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[638,"0033 2 K/KENNY TWN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;4;9;7;9;6;8;9","1954;1783;2064;1940;2584;1709;2306;1915;2200;1770;2216;1892;1875;1878;1933;1907;1717;1628;1894;1795;1815;1790;2055;1717","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[665,"0034 1 CARLOW COUNTY",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","1674;1810;1894;1666;1841;1353;1926;1641;1750;1643;1782;1936;1754;1739;1517;1874;1683;1671;1863;1539;1710;1816;1758;1806","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[713,"0035 2 WEXFORD TWN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;3;5;3;3;1;2;2;3","1928;2079;1992;1988;1933;1639;1931;1857;1985;1685;1776;1708;1734;1862;1597;1778;1739;1548;1756;1674;1724;1581;1715;1683","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[676,"0032 4 BRAY",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;6;2;5;3;3;7;8;9;9","1617;1573;1951;1725;1856;1806;1751;1736;1855;1773;1709;1367;1678;1561;1550;1588;1610;1453;1610;1485;1500;1632;1591;1517","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[656,"0035 3 ENNISCORTHY",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;5;1;14;9;12;15;14;21;11;16;16","1416;1546;1605;1526;1745;1540;1570;1613;1739;1429;1704;1792;1523;1540;1371;1485;1529;1466;1422;1533;1521;1492;1607;1672","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[664,"0031 2 PORTLAOISE",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","1528;1512;1465;1333;1696;1240;1465;1493;1391;1557;1502;1412;1780;1520;1341;1482;1457;1323;1532;1475;1429;1349;1444;1403","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[742,"0034 2 CARLOW TOWN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;3;3;1;2;0;5;2;3;6","1822;1658;1948;1608;1724;1826;1579;1479;1732;1525;1557;1710;1479;1626;1580;1533;1272;1369;1349;1468;1396;1395;1507;1361","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[692,"0029 3 CLONMEL",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;2;0;2;1;3;2;2","1540;1556;1633;1509;1709;1511;1484;1472;1589;1520;1773;1449;1400;1622;1432;1538;1412;1273;1520;1379;1414;1457;1497;1298","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[721,"0060 1 BLACKROCK",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;1;2;4;4;2;2;7;4;0","1479;1661;1591;1628;1618;1408;1669;1388;1602;1390;1577;1395;1545;1450;1410;1521;1373;1208;1370;1331;1415;1305;1352;1286","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[688,"0031 1 REST LAOIS",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;1;4;5;4","1333;1459;1386;1368;1477;1147;1487;1484;1217;1439;1357;1399;1244;1348;1218;1362;1432;1001;1346;1347;1300;1351;1395;1451","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[666,"0068 1 DUBLIN 4",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;6;3;10;4;13;5;11;6;5","1355;1409;1377;1444;1391;1283;1262;1371;1414;1359;1499;1083;1413;1303;1213;1406;1249;1205;1229;1264;1187;1280;1244;1185","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[697,"0035 5 GOREY",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;9;5;8;6;11;7;16;16","1017;1159;1190;1113;1091;1304;1151;1272;1268;1100;1307;1449;1299;1183;1024;1156;1291;1109;1305;1226;1214;1273;1383;1128","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[662,"0018 1 DUBLIN 2",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;1;1;2;2;2;5;1;2;3","1045;1147;972;1122;982;973;957;989;1114;1036;945;967;1109;969;825;1131;1437;1075;1076;1039;995;988;1158;946","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[640,"0032 3 ARKLOW",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;3;1;1;2;1;1;1;3;2","971;1041;992;1039;979;939;1026;1041;1057;961;1064;1014;1016;1067;989;1158;985;960;1113;1127;1065;1018;1128;1069","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[699,"0032 5 GREYSTONES",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;4;1;4;5","1216;1312;1193;1327;1246;1095;1322;1193;1300;1244;1244;985;1038;1025;944;1104;986;942;1090;1060;1030;1044;1093;1114","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[690,"0035 4 NEW ROSS",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;1;0;0;0;3;6;1;1;2;3;2","1071;1236;1213;1255;1341;921;1110;1293;1129;1154;1208;1017;1326;1040;1003;1152;1090;868;1134;923;1050;964;899;1015","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[730,"0030 3 DUNGARVAN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;0;1;1;0;0;0","891;967;946;888;834;719;811;1081;719;784;752;1102;1005;878;882;897;745;809;816;799;807;893;862;853","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[647,"0032 2 WICKLOW TWN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;8;0;1;2;0","908;845;889;688;1099;672;764;823;843;881;843;767;823;711;835;845;877;853;909;827;891;891;896;829","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[702,"0060 2 STILLORGAN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;4;0;1;2;1;1;1;3;4","857;878;840;1019;1058;693;950;844;904;825;896;764;903;812;778;881;697;710;866;790;877;841;887;693","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[660,"0070 3 DUNDRUM",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;2;0;2;4;4;3;9","642;632;628;692;888;796;882;970;890;887;1121;922;785;803;647;943;703;587;661;594;637;685;840;1660","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[626,"0031 3 PTARLINGTON",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","738;643;763;859;786;679;865;650;976;685;681;694;912;750;487;841;722;763;867;971;567;657;688;646","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[745,"0029 2 TIPP TOWN",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","640;730;693;755;745;543;659;697;696;638;670;742;680;677;600;707;618;595;697;673;682;699;700;634","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[701,"0070 1 REST DUB 14",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0","718;607;656;725;678;709;650;701;676;558;665;639;687;524;580;577;607;543;630;633;648;578;595;578","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[743,"0029 4 CASHEL",364,"COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1;2;0;0;1;1;0","572;374;335;380;405;339;343;395;380;454;411;345;383;377;387;405;389;337;378;400;391;371;447;390","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"]]},"SELECT\r\n BrickId AS value\r\n,BrickName AS caption\r\nFROM\r\n(SELECT\r\n B.BrickId\r\n,B.BrickName\r\n,FSB.MATMarketSalesUnitLastMonth\r\nFROM\r\n           (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin')       B\r\nINNER JOIN (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FSB ON B.BrickId=FSB.BrickId\r\n--INNER JOIN DimDate        D   ON D.DateId =FSB.DateId\r\nWHERE\r\n   -- D.MATStartDateId=(SELECT MAX(MATStartDateId) FROM DimDate)\r\n FSB.ProductId='265'\r\n) T\r\nORDER BY\r\nMATMarketSalesUnitLastMonth DESC ":{"columns":["VALUE","CAPTION"],"data":[[682,"0061 1 DUN LAOIRE"],[713,"0035 2 WEXFORD TWN"],[709,"0030 2 WATERFD CTY"],[691,"0029 1 REST S TIPP"],[759,"0035 1 RST WEXFORD"],[746,"0032 1 RST WICKLOW"],[635,"0033 1 K/KENNY CO"],[721,"0060 1 BLACKROCK"],[697,"0035 5 GOREY"],[692,"0029 3 CLONMEL"],[656,"0035 3 ENNISCORTHY"],[676,"0032 4 BRAY"],[641,"0030 1 RST WATERFD"],[638,"0033 2 K/KENNY TWN"],[666,"0068 1 DUBLIN 4"],[665,"0034 1 CARLOW COUNTY"],[662,"0018 1 DUBLIN 2"],[640,"0032 3 ARKLOW"],[742,"0034 2 CARLOW TOWN"],[660,"0070 3 DUNDRUM"],[745,"0029 2 TIPP TOWN"],[702,"0060 2 STILLORGAN"],[699,"0032 5 GREYSTONES"],[688,"0031 1 REST LAOIS"],[664,"0031 2 PORTLAOISE"],[730,"0030 3 DUNGARVAN"],[690,"0035 4 NEW ROSS"],[647,"0032 2 WICKLOW TWN"],[743,"0029 4 CASHEL"],[701,"0070 1 REST DUB 14"],[626,"0031 3 PTARLINGTON"]]},"SELECT  \r\n       Fs.[BrickId]\r\n      ,B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,Fs.MarketSalesUnit\r\n     --,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      --,FS.dateId\r\n,MonthCode.value dateId\r\n     -- ,Fs.MATMarketSalesUnit\r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n  INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B on B.brickId=Fs.brickId\r\n\r\n  WHERE 1=1  and P.ProductId= 265   Group by  Fs.[BrickId],B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.MarketSalesUnit\r\n    --  ,Fs.DateId\r\n,MonthCode.value \r\n      ,Fs.MATMarketSalesUnitLastMonth\r\n ORDER BY Fs.MATMarketSalesUnitLastMonth DESC ":{"columns":["BRICKID","BRICKNAME","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","DATEID"],"data":[[682,"0061 1 DUN LAOIRE",265,"PROCORALAN","79;106;87;110;113;81;108;101;91;88;109;101;76;116;80;96;95;78;107;80;82;82;99;94","326;373;314;378;371;345;415;355;345;334;386;358;330;399;327;378;365;299;362;336;307;335;348;310","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[713,"0035 2 WEXFORD TWN",265,"PROCORALAN","79;83;75;84;69;69;67;55;72;76;72;82;81;75;77;74;70;64;82;71;76;69;72;74","153;144;132;148;142;132;132;114;133;155;141;154;151;164;147;155;160;119;168;167;150;176;136;156","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[709,"0030 2 WATERFD CTY",265,"PROCORALAN","287;70;102;65;202;98;101;100;114;92;94;56;78;61;58;45;46;43;55;54;35;40;45;47","369;150;181;163;289;180;167;161;189;159;179;132;146;219;140;128;130;128;147;147;100;113;142;165","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[691,"0029 1 REST S TIPP",265,"PROCORALAN","30;32;37;37;42;41;41;53;44;47;29;46;34;43;37;37;41;38;34;34;36;33;37;35","125;130;115;132;126;126;125;147;123;155;108;141;131;173;139;139;152;137;133;138;130;151;136;132","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[759,"0035 1 RST WEXFORD",265,"PROCORALAN","46;58;54;58;56;49;61;66;57;60;60;59;56;59;64;57;53;48;57;61;58;47;64;59","134;134;126;137;131;120;140;149;114;128;129;133;123;124;134;117;124;109;120;125;127;113;134;122","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[746,"0032 1 RST WICKLOW",265,"PROCORALAN","21;23;34;30;32;25;25;18;37;17;32;26;22;30;18;34;27;21;24;26;25;19;33;31","135;101;127;126;118;106;111;101;131;108;119;108;124;122;102;128;124;80;104;104;90;117;131;109","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[635,"0033 1 K/KENNY CO",265,"PROCORALAN","15;14;12;15;15;20;21;16;19;18;22;19;18;22;24;17;20;16;20;22;17;20;19;20","74;54;65;66;84;70;80;74;84;82;93;93;97;96;99;106;103;91;103;144;94;134;134;100","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[721,"0060 1 BLACKROCK",265,"PROCORALAN","26;24;20;37;21;31;28;29;29;25;35;24;36;29;23;45;27;27;27;27;26;25;29;23","86;104;82;119;90;99;98;104;102;96;97;92;133;93;102;113;99;90;105;98;101;104;101;93","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[697,"0035 5 GOREY",265,"PROCORALAN","19;26;24;33;15;24;34;22;25;38;27;35;23;31;43;29;40;20;32;33;22;26;30;32","78;95;102;92;79;82;94;85;92;98;88;104;98;89;112;110;98;74;122;122;93;118;90;86","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[692,"0029 3 CLONMEL",265,"PROCORALAN","19;19;16;13;20;19;25;17;21;21;17;19;19;19;18;15;19;21;16;18;18;17;17;19","80;111;97;89;115;101;96;103;97;90;84;97;98;103;104;94;106;105;96;103;96;101;102;96","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[656,"0035 3 ENNISCORTHY",265,"PROCORALAN","37;34;33;34;30;21;35;42;44;41;41;39;36;39;51;46;38;23;43;39;40;53;43;46","64;68;78;71;80;57;83;89;94;84;93;86;83;86;93;88;78;59;97;75;87;104;99;82","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[676,"0032 4 BRAY",265,"PROCORALAN","16;17;12;20;14;15;22;21;19;18;16;20;15;18;17;12;18;15;12;17;13;17;21;17","93;76;77;94;77;73;77;73;87;71;69;79;66;81;71;77;90;70;73;90;76;87;98;86","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[641,"0030 1 RST WATERFD",265,"PROCORALAN","19;16;24;29;15;26;23;21;27;23;24;20;34;31;18;18;34;29;19;33;21;21;30;33","76;69;78;95;75;79;70;76;76;76;76;58;86;86;61;73;80;68;69;92;88;76;87;86","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[638,"0033 2 K/KENNY TWN",265,"PROCORALAN","9;12;7;13;8;6;7;10;8;14;8;7;11;4;4;9;5;3;7;4;8;10;14;4","74;74;75;87;101;65;86;73;86;80;69;90;76;77;62;88;82;62;74;104;70;112;77;65","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[666,"0068 1 DUBLIN 4",265,"PROCORALAN","20;21;27;19;31;19;18;23;37;12;27;23;23;18;30;24;18;20;24;23;30;23;17;28","81;95;82;88;112;74;91;95;100;79;95;75;86;75;83;91;68;66;75;82;83;71;64;82","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[665,"0034 1 CARLOW COUNTY",265,"PROCORALAN","14;14;16;15;16;12;20;12;15;17;21;12;11;20;15;15;18;10;16;17;15;10;16;7","62;71;72;57;64;59;67;72;66;72;72;51;69;75;66;84;76;71;79;76;79;85;92;64","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[662,"0018 1 DUBLIN 2",265,"PROCORALAN","10;16;19;15;18;15;17;11;15;3;15;18;6;20;10;12;6;5;16;9;13;18;18;13","60;50;43;53;55;36;44;40;52;23;43;45;45;212;48;48;47;39;64;48;57;93;63;134","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[640,"0032 3 ARKLOW",265,"PROCORALAN","13;15;13;21;20;18;20;24;20;14;15;13;17;21;20;19;23;12;16;23;17;21;23;17","72;67;75;94;75;61;67;82;82;60;77;53;82;87;74;79;68;48;64;79;66;70;64;63","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[742,"0034 2 CARLOW TOWN",265,"PROCORALAN","7;11;7;10;6;9;10;8;10;13;7;10;10;10;7;7;3;9;4;9;7;8;8;5","70;74;73;69;65;75;68;74;68;76;70;67;72;68;61;80;52;74;66;63;73;70;65;71","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[660,"0070 3 DUNDRUM",265,"PROCORALAN","11;10;10;12;9;14;23;8;12;12;13;15;22;6;22;19;9;17;13;18;19;15;12;8","61;62;65;67;56;51;66;54;59;55;59;52;76;50;62;60;61;55;45;61;56;52;51;59","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[745,"0029 2 TIPP TOWN",265,"PROCORALAN","6;12;9;20;15;11;13;15;17;7;14;16;9;9;8;14;11;8;9;10;14;9;16;10","34;49;49;57;56;34;55;49;69;41;50;71;48;54;43;53;49;53;59;52;52;54;63;51","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[702,"0060 2 STILLORGAN",265,"PROCORALAN","15;6;14;15;12;19;12;22;15;11;14;12;12;17;15;15;13;19;16;16;16;12;12;17","62;43;59;52;67;63;54;71;46;58;39;36;51;60;55;59;41;44;56;41;50;37;52;38","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[699,"0032 5 GREYSTONES",265,"PROCORALAN","24;6;18;5;16;16;18;19;9;16;22;9;7;9;7;8;8;7;5;7;4;6;4;2","73;79;83;58;65;90;107;70;79;70;85;42;53;45;51;53;49;44;47;53;54;43;52;31","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[688,"0031 1 REST LAOIS",265,"PROCORALAN","7;14;11;10;8;74;11;11;7;9;11;13;12;8;10;10;11;11;17;15;13;12;18;13","35;40;35;31;29;97;39;34;35;40;47;46;55;42;59;38;42;44;45;45;43;44;67;50","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[664,"0031 2 PORTLAOISE",265,"PROCORALAN","3;6;5;6;3;4;4;2;5;2;3;2;5;4;3;3;2;2;4;2;5;3;4;3","27;46;46;53;39;52;35;45;36;33;33;37;43;38;39;38;38;31;44;43;43;56;59;49","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[730,"0030 3 DUNGARVAN",265,"PROCORALAN","8;11;11;13;10;7;8;7;11;16;9;12;14;8;9;14;20;10;11;15;10;16;8;10","24;24;31;31;28;30;23;27;33;157;152;112;60;123;35;39;36;28;34;31;32;31;29;28","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[690,"0035 4 NEW ROSS",265,"PROCORALAN","21;20;18;14;16;18;13;18;14;16;19;22;15;24;21;14;17;19;19;21;18;14;21;20","42;35;41;30;35;35;33;34;38;31;37;43;33;53;40;36;35;37;42;46;36;32;44;43","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[647,"0032 2 WICKLOW TWN",265,"PROCORALAN","6;15;8;7;14;11;14;11;18;12;13;9;5;6;5;10;9;11;13;8;11;10;8;6","39;42;34;45;42;40;41;47;50;52;55;37;40;46;45;43;49;45;42;28;30;37;30;23","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[743,"0029 4 CASHEL",265,"PROCORALAN","11;8;10;13;9;8;12;6;8;14;11;8;10;13;8;10;10;6;10;12;8;10;10;9","37;34;32;36;24;25;26;29;33;32;33;31;35;37;33;35;38;33;35;39;44;41;42;35","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[701,"0070 1 REST DUB 14",265,"PROCORALAN","12;13;11;13;15;7;4;4;6;4;5;9;5;8;5;11;4;5;7;3;10;3;7;11","47;47;49;40;38;42;30;31;40;48;31;55;25;69;48;49;31;21;42;20;36;28;29;34","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[626,"0031 3 PTARLINGTON",265,"PROCORALAN","0;2;0;0;0;4;2;0;1;1;0;1;1;1;2;3;4;1;1;2;3;1;3;2","22;29;33;24;25;24;37;29;30;30;32;31;33;39;24;42;40;35;29;35;30;32;29;30","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"]]},"SELECT\r\n T.*\r\n,B.BrickName\r\nFROM (\r\nSELECT  \r\n     MonthLabel.Value MonthChar ,\r\n     MonthCode.value DateId\r\n      ,Fs.[BrickId]  \r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\nFROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\nINNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\nwhere 1=1  and P.ProductId= 265 and BrickId in (682)\r\n Group by [BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n,MonthLabel.value, MonthCode.value\r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end \r\n) AS T\r\nLEFT OUTER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') AS B on B.BrickId=T.BrickId ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","SALESUNIT","SRT","BRICKNAME"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,265,"PROCORALAN","79;106;87;110;113;81;108;101;91;88;109;101;76;116;80;96;95;78;107;80;82;82;99;94","AAAAA","0061 1 DUN LAOIRE"]]},"SELECT  \r\n      MonthLabel.value MonthChar --   D.MonthChar\r\n    -- ,D.DATEID\r\n      ,MonthCode.value DateId\t\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] as MarketUnitSales\r\n     ,case when P.ProductId = 265 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n INNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n INNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\n--  INNER JOIN DImDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and brickid in (682)  and HP.ProductId= 265\r\n\r\n Group by MonthLabel.value ,-- D.monthChar,\r\n      MonthCode.value,\r\n      Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.SalesUnit\r\n      ,case when P.ProductId = 265 then 'AAAAA' ELSE P.ProductName end \r\n ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","MARKETUNITSALES","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,260,"VASTAREL","22;11;14;21;15;22;19;19;9;14;9;18;14;18;4;15;17;6;8;4;7;13;12;5","VASTAREL"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,265,"PROCORALAN","79;106;87;110;113;81;108;101;91;88;109;101;76;116;80;96;95;78;107;80;82;82;99;94","AAAAA"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,326,"RANEXA","66;49;49;67;52;55;48;63;58;59;68;65;61;63;62;77;62;61;61;75;64;72;90;73","RANEXA"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,350,"IKOREL","57;67;53;57;58;52;85;51;63;54;58;45;55;62;60;58;70;51;62;58;57;56;47;49","IKOREL"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,351,"INSPRA","102;140;111;123;133;135;155;121;124;119;142;129;124;140;121;132;121;103;124;119;97;112;100;89","INSPRA"]]},"SELECT\r\n BrickId AS value\r\n,BrickName AS caption\r\nFROM\r\n(SELECT\r\n B.BrickId\r\n,B.BrickName\r\n,FSB.MATMarketSalesUnitLastMonth\r\nFROM\r\n           (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin')       B\r\nINNER JOIN (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) FSB ON B.BrickId=FSB.BrickId\r\n--INNER JOIN DimDate        D   ON D.DateId =FSB.DateId\r\nWHERE\r\n   -- D.MATStartDateId=(SELECT MAX(MATStartDateId) FROM DimDate)\r\n FSB.ProductId='346'\r\n) T\r\nORDER BY\r\nMATMarketSalesUnitLastMonth DESC ":{"columns":["VALUE","CAPTION"],"data":[[682,"0061 1 DUN LAOIRE"],[709,"0030 2 WATERFD CTY"],[691,"0029 1 REST S TIPP"],[638,"0033 2 K/KENNY TWN"],[742,"0034 2 CARLOW TOWN"],[713,"0035 2 WEXFORD TWN"],[641,"0030 1 RST WATERFD"],[635,"0033 1 K/KENNY CO"],[759,"0035 1 RST WEXFORD"],[664,"0031 2 PORTLAOISE"],[656,"0035 3 ENNISCORTHY"],[746,"0032 1 RST WICKLOW"],[662,"0018 1 DUBLIN 2"],[676,"0032 4 BRAY"],[697,"0035 5 GOREY"],[666,"0068 1 DUBLIN 4"],[692,"0029 3 CLONMEL"],[721,"0060 1 BLACKROCK"],[640,"0032 3 ARKLOW"],[688,"0031 1 REST LAOIS"],[665,"0034 1 CARLOW COUNTY"],[730,"0030 3 DUNGARVAN"],[699,"0032 5 GREYSTONES"],[660,"0070 3 DUNDRUM"],[690,"0035 4 NEW ROSS"],[647,"0032 2 WICKLOW TWN"],[745,"0029 2 TIPP TOWN"],[626,"0031 3 PTARLINGTON"],[702,"0060 2 STILLORGAN"],[701,"0070 1 REST DUB 14"],[743,"0029 4 CASHEL"]]},"SELECT  \r\n       Fs.[BrickId]\r\n      ,B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] ,Fs.MarketSalesUnit\r\n     --,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      --,FS.dateId\r\n,MonthCode.value dateId\r\n     -- ,Fs.MATMarketSalesUnit\r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n  --INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n  INNER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') B on B.brickId=Fs.brickId\r\n\r\n  WHERE 1=1  and P.ProductId= 346   Group by  Fs.[BrickId],B.BrickName\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.MarketSalesUnit\r\n    --  ,Fs.DateId\r\n,MonthCode.value \r\n      ,Fs.MATMarketSalesUnitLastMonth\r\n ORDER BY Fs.MATMarketSalesUnitLastMonth DESC ":{"columns":["BRICKID","BRICKNAME","PRODUCTID","PRODUCTNAME","SALESUNIT","MARKETSALESUNIT","DATEID"],"data":[[682,"0061 1 DUN LAOIRE",346,"VALDOXAN","53;44;48;51;62;65;67;48;74;58;69;55;62;68;66;83;50;58;64;60;52;59;35;47","5206;5971;5498;6212;5782;5179;5848;6180;5790;7021;6132;5267;5734;6293;5875;6634;6857;5529;5951;6373;6218;5977;6640;5949","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[709,"0030 2 WATERFD CTY",346,"VALDOXAN","314;147;153;153;332;214;205;170;173;192;198;50;204;99;73;71;78;57;72;71;69;82;78;76","6213;5505;5685;5216;5890;5042;5456;5845;6344;6157;5619;5643;5922;5688;5714;6042;7003;4960;5666;6207;5875;5981;6481;6247","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[691,"0029 1 REST S TIPP",346,"VALDOXAN","157;124;126;144;164;148;132;160;172;119;137;120;105;135;125;134;129;146;118;127;132;119;118;129","3388;3545;3207;3158;3597;3152;3491;3543;3472;3640;3748;3392;3545;3493;3530;3677;4059;3368;3409;3708;4179;3401;4234;3581","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[638,"0033 2 K/KENNY TWN",346,"VALDOXAN","73;77;69;100;75;63;73;74;87;68;74;64;71;59;76;70;53;58;54;57;58;67;79;61","3461;3380;3526;3698;3581;3367;3857;4110;3803;3781;3595;3293;3706;3448;3303;3469;4151;3363;3589;3735;3910;3725;3678;3806","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[742,"0034 2 CARLOW TOWN",346,"VALDOXAN","56;54;50;52;43;46;30;37;45;39;40;44;41;44;35;44;46;33;43;45;45;61;60;52","3406;3093;2789;2967;3076;3192;2636;2962;3351;2931;3309;3003;2739;3370;3149;3205;3154;2817;3009;3228;3126;3336;3487;2997","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[713,"0035 2 WEXFORD TWN",346,"VALDOXAN","56;86;110;87;61;85;100;80;55;111;88;85;80;94;73;103;74;78;67;101;81;96;89;104","3583;2761;3054;2905;2687;2314;2805;2739;3008;3286;2866;2868;3017;3078;3005;3082;3254;3035;3155;2864;3278;3196;3279;2902","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[641,"0030 1 RST WATERFD",346,"VALDOXAN","50;35;54;47;33;47;41;46;38;44;51;45;25;46;33;51;35;36;42;35;38;28;31;21","2833;2659;2889;2709;2823;2618;2736;2794;2898;3239;2629;2760;2879;2930;2919;2929;3737;2527;2853;3368;3096;3022;3099;3154","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[635,"0033 1 K/KENNY CO",346,"VALDOXAN","53;60;57;50;65;62;60;51;46;40;47;54;68;56;50;62;72;53;63;59;62;63;70;59","2681;2579;2991;2752;2825;2811;3047;3258;2920;3277;2610;2651;3066;3160;2727;2803;3042;2922;2746;3102;3194;3200;3184;3285","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[759,"0035 1 RST WEXFORD",346,"VALDOXAN","75;82;92;74;74;62;69;72;55;59;59;52;65;61;74;74;67;67;74;79;65;74;71;68","2977;2979;3092;3116;3376;2662;2735;2696;3150;2716;2769;2644;2810;2911;2717;2965;3342;2805;3208;3030;2903;2897;3236;2859","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[664,"0031 2 PORTLAOISE",346,"VALDOXAN","57;65;65;64;57;61;66;46;68;56;64;50;63;58;62;63;41;45;54;46;46;56;58;36","2225;2533;2304;2412;2683;2213;2514;2591;2378;2794;2586;2416;2558;2731;2463;2702;2713;2239;2639;2762;2650;2552;2743;2561","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[656,"0035 3 ENNISCORTHY",346,"VALDOXAN","64;54;73;69;60;68;59;80;65;64;62;74;63;60;51;78;55;58;53;63;62;56;77;58","2265;2496;2862;2467;2959;2152;2237;2846;2477;2780;2373;2261;2419;2360;2453;2579;2806;2411;2273;2686;2564;2650;3117;2915","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[746,"0032 1 RST WICKLOW",346,"VALDOXAN","32;31;46;41;35;51;39;44;45;47;46;45;54;36;39;44;50;28;32;29;31;49;36;47","2788;2340;2585;2312;2697;2223;2395;2363;2722;2635;2580;2325;2763;2554;2135;2953;2699;2527;2455;2750;2497;2612;2695;2452","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[662,"0018 1 DUBLIN 2",346,"VALDOXAN","42;26;36;29;32;29;24;28;26;24;42;30;28;24;27;25;28;25;37;22;26;29;31;32","2380;2295;2376;2187;2194;1999;3077;4517;3725;2887;2392;2442;2301;2438;2130;2731;2701;2307;2462;2824;2621;2753;2867;2507","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[676,"0032 4 BRAY",346,"VALDOXAN","35;43;53;34;33;33;53;29;33;30;36;23;38;31;40;38;42;27;47;55;46;46;42;40","2483;2440;2347;2487;2651;2262;2197;2442;2574;2644;2511;2008;2724;2493;2154;2232;2695;2106;2586;2633;2671;2446;2661;2508","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[697,"0035 5 GOREY",346,"VALDOXAN","22;31;16;12;20;26;16;27;29;19;21;30;24;27;14;22;19;21;27;33;23;33;30;26","1586;1846;1832;2031;1938;1883;2043;2131;2354;2239;2160;2105;2281;2241;2135;2380;2546;2204;2652;2466;2358;2584;2727;2290","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[666,"0068 1 DUBLIN 4",346,"VALDOXAN","36;43;29;29;26;31;33;24;24;22;24;14;28;29;17;23;20;28;26;33;29;31;27;23","1975;2459;2043;2384;2465;1838;2435;2337;2261;2431;2246;1991;2303;2264;2247;2531;2312;2313;2470;2148;2655;2478;2349;2309","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[692,"0029 3 CLONMEL",346,"VALDOXAN","38;35;48;32;49;23;34;36;36;29;27;37;28;22;20;30;17;25;19;28;28;32;35;18","2415;2220;2264;2218;2160;2111;2085;2422;2368;2355;2319;2125;2189;2376;2279;2165;2397;2327;2366;2383;2518;2322;2433;2292","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[721,"0060 1 BLACKROCK",346,"VALDOXAN","22;13;33;26;20;20;16;17;14;18;20;18;21;13;17;29;22;29;18;23;17;25;20;23","1824;1863;1961;1784;1817;1625;1862;1742;2016;1787;1717;1727;1849;1803;1803;1936;1901;1941;1831;1990;1875;1896;1937;1909","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[640,"0032 3 ARKLOW",346,"VALDOXAN","31;52;44;46;42;29;37;34;27;35;44;32;41;53;57;52;44;47;65;54;60;50;44;46","1580;1601;1604;1593;1570;1335;1554;1587;1672;1582;1650;1522;1626;1702;1639;1972;1716;1671;1963;1723;1849;1876;1861;1674","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[688,"0031 1 REST LAOIS",346,"VALDOXAN","31;27;28;37;33;30;35;33;38;30;28;39;31;31;35;30;43;39;41;31;32;32;35;36","1589;1724;1595;1716;1773;1436;1658;1726;1838;1764;1850;1995;1610;1679;1925;1667;1728;1587;1940;1922;1870;1683;1854;1735","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[665,"0034 1 CARLOW COUNTY",346,"VALDOXAN","24;27;36;35;25;19;24;29;29;29;17;35;24;32;37;39;33;36;36;23;41;27;39;38","1587;1946;1675;1750;1707;1432;1696;1802;1771;1859;1635;1542;1656;1764;1746;1678;1795;1618;1704;1603;1845;1779;1881;1691","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[730,"0030 3 DUNGARVAN",346,"VALDOXAN","16;17;15;15;11;17;21;13;19;17;29;11;21;19;13;11;11;10;25;10;7;8;10;11","1783;1527;1483;1319;1655;1257;1495;1734;1760;1937;1494;1780;1490;1735;1465;1531;1822;1461;1635;1591;1513;1696;2124;1668","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[699,"0032 5 GREYSTONES",346,"VALDOXAN","30;16;32;20;26;21;29;21;34;21;33;12;10;10;12;17;14;17;26;17;16;17;16;10","2275;2436;2221;2194;2476;1896;2612;2208;2798;2463;2399;1546;1599;1592;1503;1720;1678;1499;1577;1685;1728;1705;1813;1593","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[660,"0070 3 DUNDRUM",346,"VALDOXAN","7;11;9;12;7;10;36;8;17;17;22;42;18;13;16;20;19;15;25;21;15;48;24;20","1130;740;762;5312;3188;833;3559;2511;2233;1727;1349;1395;1323;1018;1176;2501;1437;2050;1300;2096;1212;990;1636;2316","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[690,"0035 4 NEW ROSS",346,"VALDOXAN","19;19;16;15;17;17;16;22;13;14;20;15;17;20;22;13;22;16;23;13;17;17;18;18","1408;1308;1334;1396;1308;1222;1308;1377;1421;1355;1491;1310;1539;1488;1268;1505;1558;1284;1439;1484;1427;1613;1681;1485","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[647,"0032 2 WICKLOW TWN",346,"VALDOXAN","37;31;43;45;48;39;47;49;35;51;35;53;30;41;22;28;31;19;34;23;15;17;28;18","1285;1463;1165;1386;1384;1021;1364;1452;1476;1486;1398;1362;1258;1242;1373;1435;1503;1171;1593;1373;1620;1722;1589;1352","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[745,"0029 2 TIPP TOWN",346,"VALDOXAN","79;58;80;104;99;58;74;67;77;82;55;86;62;72;86;68;73;78;78;75;99;100;96;96","1259;909;1314;1035;1218;1005;1176;969;1305;1038;1025;1275;1224;1220;1229;1205;1113;1119;1241;1242;1235;1337;1298;1283","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[626,"0031 3 PTARLINGTON",346,"VALDOXAN","2;4;2;3;6;7;3;4;4;1;3;0;4;0;0;0;0;2;0;2;2;5;4;1","1035;1360;1124;1238;1001;982;1108;1183;1428;1344;1135;1085;1169;1507;934;1263;1117;1230;1363;1263;1315;1157;1196;1175","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[702,"0060 2 STILLORGAN",346,"VALDOXAN","25;14;15;17;16;14;24;18;20;13;23;5;16;16;5;13;12;14;6;11;10;12;9;7","1241;1207;1000;1136;1153;921;1298;1231;1111;1302;938;888;1135;1116;1353;1098;1102;1055;1440;978;1316;1437;1203;1088","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[701,"0070 1 REST DUB 14",346,"VALDOXAN","10;12;7;10;8;14;15;7;9;4;14;7;8;10;10;10;10;11;13;9;9;7;14;8","791;988;786;929;883;658;894;824;1097;1004;948;808;1040;885;947;971;1031;932;862;969;933;926;1038;908","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"],[743,"0029 4 CASHEL",346,"VALDOXAN","24;9;18;15;17;16;20;11;18;16;25;12;14;14;15;16;15;12;28;15;13;13;20;18","655;614;714;658;693;599;675;658;625;785;626;678;713;719;687;768;698;642;714;743;659;824;757;711","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801"]]},"SELECT\r\n T.*\r\n,B.BrickName\r\nFROM (\r\nSELECT  \r\n     MonthLabel.Value MonthChar ,\r\n     MonthCode.value DateId\r\n      ,Fs.[BrickId]  \r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end SRT\r\nFROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\nINNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\nwhere 1=1  and P.ProductId= 346 and BrickId in (682)\r\n Group by [BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n,MonthLabel.value, MonthCode.value\r\n,case when P.HomeProductFlag=1 then 'AAAAA' ELSE P.ProductName end \r\n) AS T\r\nLEFT OUTER JOIN (SELECT DimBrick.* FROM DimBrick inner join VisBrick on VisBrick .BrickId=DimBrick.BrickId and VisBrick.UserLogin='admin') AS B on B.BrickId=T.BrickId ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","SALESUNIT","SRT","BRICKNAME"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,346,"VALDOXAN","53;44;48;51;62;65;67;48;74;58;69;55;62;68;66;83;50;58;64;60;52;59;35;47","AAAAA","0061 1 DUN LAOIRE"]]},"SELECT  \r\n      MonthLabel.value MonthChar --   D.MonthChar\r\n    -- ,D.DATEID\r\n      ,MonthCode.value DateId\t\r\n      ,Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit] as MarketUnitSales\r\n     ,case when P.ProductId = 346 then 'AAAAA' ELSE P.ProductName end SRT\r\n      \r\n  FROM (SELECT FactSalesBrick.* FROM FactSalesBrick inner join DimProduct as P on P.ProductId=FactSalesBrick.ProductId\r\ninner join DimBrick as B on B.BrickId=FactSalesBrick.BrickId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\n ) Fs\r\n INNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\n INNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\n--  INNER JOIN DImDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and brickid in (682)  and HP.ProductId= 346\r\n\r\n Group by MonthLabel.value ,-- D.monthChar,\r\n      MonthCode.value,\r\n      Fs.[BrickId]\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.SalesUnit\r\n      ,case when P.ProductId = 346 then 'AAAAA' ELSE P.ProductName end \r\n ":{"columns":["MONTHCHAR","DATEID","BRICKID","PRODUCTID","PRODUCTNAME","MARKETUNITSALES","SRT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,243,"TOTAL VENLAFAXINE","1051;1023;1045;1101;1051;911;991;1036;1048;999;1134;899;920;1042;1125;1080;1140;987;1020;1205;1326;943;1337;1078","TOTAL VENLAFAXINE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,249,"TOTAL FLUOXETINE","386;473;475;494;426;401;461;424;401;518;496;416;514;479;485;586;435;492;499;595;456;532;550;447","TOTAL FLUOXETINE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,267,"CYMBALTA","229;347;273;242;373;288;368;320;338;353;334;267;307;352;278;387;349;300;359;327;362;289;313;246","CYMBALTA"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,306,"TOTAL PAROXATINE","153;248;214;221;222;195;249;226;208;196;242;216;173;258;222;257;213;235;213;256;194;266;196;201","TOTAL PAROXATINE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,316,"TOTAL SERTRALINE","503;497;446;636;503;442;598;627;554;557;604;515;569;703;595;761;1442;430;432;545;470;713;669;710","TOTAL SERTRALINE"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",682,346,"VALDOXAN","53;44;48;51;62;65;67;48;74;58;69;55;62;68;66;83;50;58;64;60;52;59;35;47","AAAAA"]]},"select \r\n\tP.ProductId as value,\r\n\tP.ProductName as caption\t\r\nFROM (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P\r\nwhere \r\n\tP.HomeProductFlag=1 \r\n\tAND P.VisHomeProductFlag=0\r\nOrder by case P.ProductName when 'PROCORALAN' then 'AAAAAA' else P.ProductName end ":{"columns":["VALUE","CAPTION"],"data":[[265,"PROCORALAN"],[355,"ACERYCAL"],[364,"COVERDINE"],[346,"VALDOXAN"]]},"select  * from\r\n(\r\nSELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 265 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 265\r\nand P.ProductName in ('PROCORALAN','IKOREL','INSPRA','RANEXA','VASTAREL','ACERYCAL','ALL OTHER C9B','AMLODIPINE','CO DIOVAN','COVERDINE','COVERSYL', 'COVERSYL ARGI PLUS', 'VALDOXAN','CYMBALTA', 'TOTAL FLUOXETINE', 'TOTAL PAROXATINE','TOTAL SERTRALINE','TOTAL VENLAFAXINE' )\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 265 then 'AAAAA' ELSE P.ProductName end \r\n) t\r\norder by SRT ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,265,"PROCORALAN","AAAAA","890;734;744;786;870;791;817;772;827;757;805;757;723;779;729;742;719;618;736;729;690;670;758;715","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,350,"IKOREL","IKOREL","521;513;486;507;524;475;500;476;467;452;472;438;451;491;425;453;471;388;441;440;425;473;439;397","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,351,"INSPRA","INSPRA","635;647;640;679;676;591;675;612;616;751;728;657;719;1018;655;649;618;533;663;688;565;696;533;466","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,326,"RANEXA","RANEXA","480;517;507;543;541;521;504;579;608;581;603;593;619;660;633;721;675;615;698;700;704;743;858;887","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,260,"VASTAREL","VASTAREL","189;159;174;167;142;145;161;148;151;132;133;164;136;137;117;156;128;105;103;130;89;135;122;108","2715;2570;2551;2682;2753;2523;2657;2587;2669;2673;2741;2609;2648;3085;2559;2721;2611;2259;2641;2687;2473;2717;2710;2573"]]},"select  * from\r\n(\r\nSELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 355 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 355\r\nand P.ProductName in ('PROCORALAN','IKOREL','INSPRA','RANEXA','VASTAREL','ACERYCAL','ALL OTHER C9B','AMLODIPINE','CO DIOVAN','COVERDINE','COVERSYL', 'COVERSYL ARGI PLUS', 'VALDOXAN','CYMBALTA', 'TOTAL FLUOXETINE', 'TOTAL PAROXATINE','TOTAL SERTRALINE','TOTAL VENLAFAXINE' )\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 355 then 'AAAAA' ELSE P.ProductName end \r\n) t\r\norder by SRT ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,355,"ACERYCAL","AAAAA","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,276,"ALL OTHER C9B","ALL OTHER C9B","4961;4980;5071;4971;5076;4606;5078;5068;5367;4895;5143;4861;5173;5338;4989;5477;5253;4877;6048;5394;5251;5608;5816;5439","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,303,"AMLODIPINE","AMLODIPINE","23042;25918;22616;21494;27337;20311;22979;23682;23896;22302;25432;23182;25358;22174;21224;23347;24218;20626;24421;22889;23393;23596;24568;23805","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,291,"CO DIOVAN","CO DIOVAN","1951;1896;1811;1866;1715;1626;1653;1607;1580;1520;1496;1411;1274;1367;1175;959;688;621;668;577;558;553;548;525","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,364,"COVERDINE","COVERDINE","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,304,"COVERSYL ARGI PLUS","COVERSYL ARGI PLUS","3688;3443;3430;3469;3605;3026;3386;3424;3352;3205;3304;2945;3081;2926;2674;2831;2567;2455;2715;2558;2580;2695;2674;2577","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"]]},"select  * from\r\n(\r\nSELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 364 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 364\r\nand P.ProductName in ('PROCORALAN','IKOREL','INSPRA','RANEXA','VASTAREL','ACERYCAL','ALL OTHER C9B','AMLODIPINE','CO DIOVAN','COVERDINE','COVERSYL', 'COVERSYL ARGI PLUS', 'VALDOXAN','CYMBALTA', 'TOTAL FLUOXETINE', 'TOTAL PAROXATINE','TOTAL SERTRALINE','TOTAL VENLAFAXINE' )\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 364 then 'AAAAA' ELSE P.ProductName end \r\n) t\r\norder by SRT ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,364,"COVERDINE","AAAAA","0;0;0;0;0;0;0;0;0;0;0;0;0;27;22;61;72;100;123;115;160;137;163;179","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,355,"ACERYCAL","ACERYCAL","2758;1963;1924;2108;3065;2014;2158;2284;2246;2281;2306;2046;2443;2136;2101;2225;2303;2126;2224;2224;2283;2277;2373;2176","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,276,"ALL OTHER C9B","ALL OTHER C9B","4961;4980;5071;4971;5076;4606;5078;5068;5367;4895;5143;4861;5173;5338;4989;5477;5253;4877;6048;5394;5251;5608;5816;5439","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,303,"AMLODIPINE","AMLODIPINE","23042;25918;22616;21494;27337;20311;22979;23682;23896;22302;25432;23182;25358;22174;21224;23347;24218;20626;24421;22889;23393;23596;24568;23805","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,291,"CO DIOVAN","CO DIOVAN","1951;1896;1811;1866;1715;1626;1653;1607;1580;1520;1496;1411;1274;1367;1175;959;688;621;668;577;558;553;548;525","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,304,"COVERSYL ARGI PLUS","COVERSYL ARGI PLUS","3688;3443;3430;3469;3605;3026;3386;3424;3352;3205;3304;2945;3081;2926;2674;2831;2567;2455;2715;2558;2580;2695;2674;2577","50335;52141;49625;48246;54963;44109;48796;49557;49926;46903;50608;46537;49520;46416;43662;47502;47041;41247;47971;45125;45515;45871;48082;45626"]]},"select  * from\r\n(\r\nSELECT  \r\n     MonthLabel.value MonthChar--  D.MonthChar\r\n     , MonthCode.value DATEID  --D.DATEID\r\n      ,Fs.TerritoryId\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n ,case when P.ProductId = 346 then 'AAAAA' ELSE P.ProductName end SRT\r\n      , Fs.[SalesUnit] as MarketSales\r\n\t,Fs.MarketSalesUnit \r\n     --   ,Fs.SalesUnit/fs.MarketSalesUnit as MarketShare\r\n      \r\n  FROM (SELECT FactSalesTerritory.* FROM FactSalesTerritory inner join DimProduct as P on P.ProductId=FactSalesTerritory.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactSalesTerritory.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory .TerritoryId=T.TerritoryId and VisTerritory .UserLogin='admin'\r\n\r\n) Fs\r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') P on Fs.productId=P.ProductId \r\n  INNER JOIN (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') HP on P.Marketname=HP.Marketname\r\nINNER JOIN BIInfo MonthCode on 1=1 and MonthCode.Info='24 Months Date Code'\r\nINNER JOIN BIInfo MonthLabel on 1=1 and MonthLabel.Info='24 Months YearMonth labels'\r\n\r\n -- INNER JOIN DimDate D on D.DateId=Fs.dateid\r\n\r\n where 1=1 and HP.productId= 346\r\nand P.ProductName in ('PROCORALAN','IKOREL','INSPRA','RANEXA','VASTAREL','ACERYCAL','ALL OTHER C9B','AMLODIPINE','CO DIOVAN','COVERDINE','COVERSYL', 'COVERSYL ARGI PLUS', 'VALDOXAN','CYMBALTA', 'TOTAL FLUOXETINE', 'TOTAL PAROXATINE','TOTAL SERTRALINE','TOTAL VENLAFAXINE' )\r\nGroup by \r\n\t MonthCode.value --  D.DATEID\r\n\t , MonthLabel.value --  D.MonthChar\r\n      ,P.[ProductId]\r\n      ,P.ProductName\r\n      ,Fs.[SalesUnit]\r\n      ,Fs.TerritoryId\r\n      ,Fs.MarketSalesUnit \r\n,case when P.ProductId = 346 then 'AAAAA' ELSE P.ProductName end \r\n) t\r\norder by SRT ":{"columns":["MONTHCHAR","DATEID","TERRITORYID","PRODUCTID","PRODUCTNAME","SRT","MARKETSALES","MARKETSALESUNIT"],"data":[["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,346,"VALDOXAN","AAAAA","1570;1347;1503;1468;1596;1425;1498;1385;1425;1369;1453;1239;1364;1293;1222;1361;1225;1188;1310;1270;1246;1359;1344;1247","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,267,"CYMBALTA","CYMBALTA","4378;4873;4650;4371;5049;4172;4831;4639;4754;4686;4495;4367;4613;4835;4454;5044;4741;4322;4758;4682;4251;3734;3287;2857","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,249,"TOTAL FLUOXETINE","TOTAL FLUOXETINE","6440;6671;6831;6823;7007;6146;6683;6662;7370;6818;7594;6681;7006;7006;6707;7703;7492;6903;7787;7416;7816;7869;7885;7310","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,306,"TOTAL PAROXATINE","TOTAL PAROXATINE","3179;2976;2956;3026;3124;2618;2812;2925;3045;2723;2983;2754;2902;3004;2594;2954;2840;2571;2752;2854;2773;2976;2968;2644","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,316,"TOTAL SERTRALINE","TOTAL SERTRALINE","6110;6500;6677;6662;7331;6145;6869;7460;7278;6969;7416;7010;7480;7820;7125;7972;9457;8199;7073;9178;7585;7778;9026;8721","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"],["2013-09;2013-10;2013-11;2013-12;2014-01;2014-02;2014-03;2014-04;2014-05;2014-06;2014-07;2014-08;2014-09;2014-10;2014-11;2014-12;2015-01;2015-02;2015-03;2015-04;2015-05;2015-06;2015-07;2015-08","20130901;20131001;20131101;20131201;20140101;20140201;20140301;20140401;20140501;20140601;20140701;20140801;20140901;20141001;20141101;20141201;20150101;20150201;20150301;20150401;20150501;20150601;20150701;20150801",7886,243,"TOTAL VENLAFAXINE","TOTAL VENLAFAXINE","15670;13716;13905;13623;14822;12902;14290;14468;15522;13993;14786;13284;14798;14287;14503;15137;15602;14108;14273;15150;16310;14248;15819;14447","71307;70787;70082;74677;75210;63240;73853;76780;78146;78246;72099;68107;72187;73298;69983;76329;79667;69020;74091;76929;76710;75773;80778;75202"]]},"select \r\n\tpop.TargetName,\r\n\tpop.ProductName, \r\n\t--pop.Segmentation, \r\n\tpop.NbDoctors,\r\n\tcase when seen.ProductName is null then 0 else seen.NbDocSeen end NbSeen\r\nfrom\r\n(\r\n\tselect \r\n\t\ttar.TargetName ,\r\n\t\tprd.ProductName, \r\n\t\t--prd.ProductName + '-'+  tar.TargetName Segmentation,\r\n\t\tCOUNT(distinct CustomerId) NbDoctors\r\n\tfrom \r\n\t (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) poa\r\n\t\tinner join DimTarget tar on tar.TargetId=poa.TargetId\r\n\t\tinner join (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') prd on prd.ProductId=poa.ProductId\r\n\tgroup by\r\n\t\tprd.ProductName,\r\n\t\ttar.TargetName\r\n) pop\r\nleft outer join \r\n(\r\n\tselect\r\n\t\t--prd.ProductName + '-'+  tar.TargetName Segmentation,\r\n\t\tprd.ProductName ,\r\n\t\ttar.TargetName ,\r\n\t\tCOUNT(distinct ev.CustomerId)  NbDocSeen\r\n\tfrom \r\n\t (SELECT FactEvents.* FROM FactEvents inner join DimProduct as P on P.ProductId=FactEvents.ProductId\r\ninner join DimTerritory as T on T.TerritoryId=FactEvents.TerritoryId\r\ninner join VisProduct on VisProduct .productId=P.ProductId and VisProduct.UserLogin='admin'\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\n\r\n\r\n) ev\r\n\t\tinner join (SELECT FactPOA.* FROM FactPOA inner join DimBrick as B on B.BrickId=FactPOA.BrickId\r\ninner join VisBrick on VisBrick .BrickId=B.BrickId and VisBrick.UserLogin='admin'\r\ninner join DimTerritory as T on T.TerritoryId=FactPOA.TerritoryId\r\ninner join VisTerritory on VisTerritory.TerritoryId=T.TerritoryId and VisTerritory.UserLogin='admin'\r\ninner join VisCustomer on VisCustomer.CustomerId=FactPOA.CustomerId and VisCustomer.UserLogin='admin'\r\n\r\n) poa on poa.ProductId=ev.ProductId and poa.TerritoryId=ev.TerritoryId and poa.CustomerId=ev.CustomerId\r\n\t\tinner join DimTarget tar on tar.TargetId=poa.TargetId\r\n\t\tinner join (SELECT DimProduct.* FROM DimProduct inner join VisProduct on VisProduct .productId=DimProduct.ProductId and VisProduct.UserLogin='admin') prd on prd.ProductId=poa.ProductId\r\n\t\tINNER JOIN DimDate D on 1=1\r\n\twhere ev.DateId between D.MATStartDateId and D.QTREndDateId and D.DateId= 20150801 \r\n\tgroup by\r\n\t\tprd.ProductName,\r\n\t\ttar.TargetName\r\n) seen on seen.ProductName=pop.ProductName and seen.TargetName=pop.TargetName\r\norder by \r\n\tpop.ProductName, pop.TargetName ":{"columns":["TARGETNAME","PRODUCTNAME","NBDOCTORS","NBSEEN"],"data":[["A","COVERDINE",1,1],["A","PROCORALAN",61,52],["A","VALDOXAN",72,66],["B","VALDOXAN",6,4]]}}}};